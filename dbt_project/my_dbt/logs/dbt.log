[0m14:18:27.650723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027812EDA810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027812EDA3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027812EDBB10>]}


============================== 14:18:27.657843 | b68ea500-2396-4dd6-907c-f6855fd3620b ==============================
[0m14:18:27.657843 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:18:27.658836 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m14:18:27.685518 [info ] [MainThread]: dbt version: 1.11.2
[0m14:18:27.686515 [info ] [MainThread]: python version: 3.11.9
[0m14:18:27.687518 [info ] [MainThread]: python path: C:\Users\jkimd\AppData\Local\Programs\Python\Python311\python.exe
[0m14:18:27.688520 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:18:27.751166 [info ] [MainThread]: Using profiles dir at C:\Users\jkimd\.dbt
[0m14:18:27.752167 [info ] [MainThread]: Using profiles.yml file at C:\Users\jkimd\.dbt\profiles.yml
[0m14:18:27.752167 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\dbt_project.yml
[0m14:18:27.754778 [info ] [MainThread]: adapter type: postgres
[0m14:18:27.755828 [info ] [MainThread]: adapter version: 1.10.0
[0m14:18:27.864911 [info ] [MainThread]: Configuration:
[0m14:18:27.865921 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:18:27.866915 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:18:27.866915 [info ] [MainThread]: Required dependencies:
[0m14:18:27.867915 [debug] [MainThread]: Executing "git --help"
[0m14:18:27.891103 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:18:27.891103 [debug] [MainThread]: STDERR: "b''"
[0m14:18:27.892075 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:18:27.892075 [info ] [MainThread]: Connection:
[0m14:18:27.893101 [info ] [MainThread]:   host: 127.0.0.1
[0m14:18:27.893101 [info ] [MainThread]:   port: 6543
[0m14:18:27.894072 [info ] [MainThread]:   user: de_user
[0m14:18:27.895072 [info ] [MainThread]:   database: de_db
[0m14:18:27.895072 [info ] [MainThread]:   schema: public
[0m14:18:27.896078 [info ] [MainThread]:   connect_timeout: 10
[0m14:18:27.896078 [info ] [MainThread]:   role: None
[0m14:18:27.897078 [info ] [MainThread]:   search_path: None
[0m14:18:27.897078 [info ] [MainThread]:   keepalives_idle: 0
[0m14:18:27.898103 [info ] [MainThread]:   sslmode: None
[0m14:18:27.898103 [info ] [MainThread]:   sslcert: None
[0m14:18:27.899106 [info ] [MainThread]:   sslkey: None
[0m14:18:27.900078 [info ] [MainThread]:   sslrootcert: None
[0m14:18:27.900078 [info ] [MainThread]:   application_name: dbt
[0m14:18:27.901082 [info ] [MainThread]:   retries: 1
[0m14:18:27.902173 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:18:28.297250 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:18:32.991269 [debug] [MainThread]: Using postgres connection "debug"
[0m14:18:32.992237 [debug] [MainThread]: On debug: select 1 as id
[0m14:18:32.992237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:33.014444 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m14:18:33.015484 [debug] [MainThread]: On debug: Close
[0m14:18:33.016002 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:18:33.017044 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:18:33.018699 [debug] [MainThread]: Command `dbt debug` succeeded at 14:18:33.018699 after 5.48 seconds
[0m14:18:33.019242 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:18:33.019962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780C068C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002780C123590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027812F05510>]}
[0m14:18:33.021011 [debug] [MainThread]: Flushing usage events
[0m14:18:33.390078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:57.028766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C09CAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C0A1A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C09F9E90>]}


============================== 14:58:57.033766 | f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e ==============================
[0m14:58:57.033766 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:58:57.034766 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m14:58:57.249307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C09C8810>]}
[0m14:58:57.314659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BD228290>]}
[0m14:58:57.315747 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:58:57.596322 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:58:57.597320 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:58:57.598325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C1C64A50>]}
[0m14:58:59.910689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C1C65B10>]}
[0m14:58:59.979947 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m14:58:59.981948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m14:59:00.035794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C2276450>]}
[0m14:59:00.035794 [info ] [MainThread]: Found 3 models, 4 data tests, 464 macros
[0m14:59:00.036824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C212AC90>]}
[0m14:59:00.038821 [info ] [MainThread]: 
[0m14:59:00.038821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:59:00.039787 [info ] [MainThread]: 
[0m14:59:00.039787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:59:00.044823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m14:59:00.114446 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m14:59:00.114446 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m14:59:00.114446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:00.134413 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m14:59:00.135755 [debug] [ThreadPool]: On list_de_db: Close
[0m14:59:00.136453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m14:59:00.143093 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m14:59:00.144127 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:59:00.144688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:00.182783 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.038 seconds
[0m14:59:00.184969 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m14:59:00.186285 [debug] [ThreadPool]: On list_de_db_public: Close
[0m14:59:00.197107 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:00.198332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:59:00.199267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:00.245363 [debug] [MainThread]: SQL status: SELECT 0 in 0.046 seconds
[0m14:59:00.246875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C1FC5D50>]}
[0m14:59:00.247431 [debug] [MainThread]: On master: ROLLBACK
[0m14:59:00.248698 [debug] [MainThread]: On master: COMMIT
[0m14:59:00.249463 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:00.249941 [debug] [MainThread]: On master: COMMIT
[0m14:59:00.252070 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:59:00.252657 [debug] [MainThread]: On master: Close
[0m14:59:00.283682 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m14:59:00.283682 [debug] [Thread-2 (]: Began running node model.my_dbt.my_first_dbt_model
[0m14:59:00.284714 [info ] [Thread-1 (]: 1 of 3 START sql view model public.hello ....................................... [RUN]
[0m14:59:00.285688 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m14:59:00.284714 [info ] [Thread-2 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:59:00.286713 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m14:59:00.286713 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.my_first_dbt_model'
[0m14:59:00.293260 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m14:59:00.293260 [debug] [Thread-2 (]: Began compiling node model.my_dbt.my_first_dbt_model
[0m14:59:00.297417 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.my_first_dbt_model"
[0m14:59:00.298975 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m14:59:00.299969 [debug] [Thread-2 (]: Began executing node model.my_dbt.my_first_dbt_model
[0m14:59:00.329522 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m14:59:00.350436 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.my_first_dbt_model"
[0m14:59:00.352408 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m14:59:00.353405 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  create view "de_db"."public"."hello__dbt_tmp"
    
    
  as (
    select
  1 as id,
  current_timestamp as created_at
  );
[0m14:59:00.353405 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m14:59:00.353405 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:00.354399 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */

  
    

  create  table "de_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:59:00.355705 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:59:00.386082 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.030 seconds
[0m14:59:00.395322 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m14:59:00.395919 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m14:59:00.396463 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:59:00.399726 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m14:59:00.400580 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m14:59:00.401854 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:59:00.402394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:59:00.414816 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m14:59:00.415816 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m14:59:00.416815 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m14:59:00.416815 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m14:59:00.417814 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m14:59:00.417814 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m14:59:00.422553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:59:00.422553 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:59:00.428364 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m14:59:00.432122 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."my_first_dbt_model__dbt_backup"
[0m14:59:00.436205 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m14:59:00.439206 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m14:59:00.439206 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop view if exists "de_db"."public"."hello__dbt_backup" cascade
[0m14:59:00.440209 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
drop table if exists "de_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:59:00.444063 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:59:00.444612 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:59:00.446936 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m14:59:00.448068 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: Close
[0m14:59:00.450774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C1E1FE50>]}
[0m14:59:00.451416 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C1FFD9D0>]}
[0m14:59:00.452692 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.hello .................................. [[32mCREATE VIEW[0m in 0.16s]
[0m14:59:00.454084 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.16s]
[0m14:59:00.455334 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m14:59:00.456511 [debug] [Thread-2 (]: Finished running node model.my_dbt.my_first_dbt_model
[0m14:59:00.457578 [debug] [Thread-4 (]: Began running node model.my_dbt.my_second_dbt_model
[0m14:59:00.458750 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:59:00.459156 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.my_second_dbt_model'
[0m14:59:00.459787 [debug] [Thread-4 (]: Began compiling node model.my_dbt.my_second_dbt_model
[0m14:59:00.462814 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.my_second_dbt_model"
[0m14:59:00.463918 [debug] [Thread-4 (]: Began executing node model.my_dbt.my_second_dbt_model
[0m14:59:00.469131 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.my_second_dbt_model"
[0m14:59:00.470342 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m14:59:00.470865 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */

  create view "de_db"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "de_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:59:00.471954 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:59:00.514615 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m14:59:00.518344 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m14:59:00.518975 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:59:00.521254 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:59:00.523018 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m14:59:00.524113 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m14:59:00.524694 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m14:59:00.528952 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m14:59:00.532838 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."my_second_dbt_model__dbt_backup"
[0m14:59:00.533837 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m14:59:00.534841 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
drop view if exists "de_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:59:00.536839 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:59:00.538839 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: Close
[0m14:59:00.538839 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4728b9c-f7c4-4ecb-90f4-12d2d8584f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C28091D0>]}
[0m14:59:00.539840 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:59:00.541839 [debug] [Thread-4 (]: Finished running node model.my_dbt.my_second_dbt_model
[0m14:59:00.543839 [debug] [MainThread]: On master: COMMIT
[0m14:59:00.544838 [debug] [MainThread]: Using postgres connection "master"
[0m14:59:00.544838 [debug] [MainThread]: On master: COMMIT
[0m14:59:00.544838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:59:00.560323 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m14:59:00.560865 [debug] [MainThread]: On master: Close
[0m14:59:00.561428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:00.561965 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m14:59:00.562481 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m14:59:00.562550 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m14:59:00.563115 [debug] [MainThread]: Connection 'model.my_dbt.my_first_dbt_model' was properly closed.
[0m14:59:00.563671 [debug] [MainThread]: Connection 'model.my_dbt.my_second_dbt_model' was properly closed.
[0m14:59:00.564242 [info ] [MainThread]: 
[0m14:59:00.564768 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m14:59:00.566367 [debug] [MainThread]: Command end result
[0m14:59:00.673135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m14:59:00.675134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m14:59:00.681133 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m14:59:00.681133 [info ] [MainThread]: 
[0m14:59:00.682134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:59:00.683134 [info ] [MainThread]: 
[0m14:59:00.683647 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:59:00.684643 [debug] [MainThread]: Command `dbt run` succeeded at 14:59:00.684643 after 3.73 seconds
[0m14:59:00.684643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B9EF9B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B9EA38D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B9E708D0>]}
[0m14:59:00.685644 [debug] [MainThread]: Flushing usage events
[0m14:59:01.051976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:24.164248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019225A1B490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019225A6A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019225A1B4D0>]}


============================== 15:11:24.169247 | 7eb16ca3-9135-401a-a2a3-ecdab3ada1a0 ==============================
[0m15:11:24.169247 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:11:24.170247 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:11:24.364212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019225A12E10>]}
[0m15:11:24.432711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001922226AD50>]}
[0m15:11:24.434711 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:11:24.668211 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:11:24.759988 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:11:24.760987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019224A64990>]}
[0m15:11:25.811587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019226EA6E50>]}
[0m15:11:25.877424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:11:25.879422 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:11:25.906426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192272D82D0>]}
[0m15:11:25.907424 [info ] [MainThread]: Found 3 models, 4 data tests, 464 macros
[0m15:11:25.907424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192251BABD0>]}
[0m15:11:25.910430 [info ] [MainThread]: 
[0m15:11:25.911428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:25.912426 [info ] [MainThread]: 
[0m15:11:25.913424 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:25.917423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m15:11:25.988995 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m15:11:25.989994 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m15:11:25.989994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:26.008446 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m15:11:26.010445 [debug] [ThreadPool]: On list_de_db: Close
[0m15:11:26.012444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m15:11:26.018458 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m15:11:26.018458 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:11:26.019456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:26.058239 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.038 seconds
[0m15:11:26.060243 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m15:11:26.062414 [debug] [ThreadPool]: On list_de_db_public: Close
[0m15:11:26.074328 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:26.075386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:11:26.075896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:26.102183 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m15:11:26.104185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001922722F650>]}
[0m15:11:26.105187 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:26.106800 [debug] [MainThread]: On master: COMMIT
[0m15:11:26.107312 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:26.107312 [debug] [MainThread]: On master: COMMIT
[0m15:11:26.110403 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:11:26.110970 [debug] [MainThread]: On master: Close
[0m15:11:26.115845 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m15:11:26.116388 [debug] [Thread-2 (]: Began running node model.my_dbt.my_first_dbt_model
[0m15:11:26.116955 [info ] [Thread-1 (]: 1 of 3 START sql table model public.hello ...................................... [RUN]
[0m15:11:26.117505 [info ] [Thread-2 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m15:11:26.118597 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m15:11:26.119158 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.my_first_dbt_model'
[0m15:11:26.119704 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m15:11:26.120246 [debug] [Thread-2 (]: Began compiling node model.my_dbt.my_first_dbt_model
[0m15:11:26.126672 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m15:11:26.129180 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.my_first_dbt_model"
[0m15:11:26.131181 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m15:11:26.131181 [debug] [Thread-2 (]: Began executing node model.my_dbt.my_first_dbt_model
[0m15:11:26.166717 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m15:11:26.170716 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.my_first_dbt_model"
[0m15:11:26.171719 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:11:26.172717 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m15:11:26.172717 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m15:11:26.173718 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:26.173718 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */

  
    

  create  table "de_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:11:26.174718 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:11:26.192036 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.017 seconds
[0m15:11:26.203610 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m15:11:26.204728 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:11:26.206951 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:26.211658 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m15:11:26.212212 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:11:26.213850 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:26.226636 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.053 seconds
[0m15:11:26.230338 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m15:11:26.236014 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:11:26.236535 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m15:11:26.237100 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m15:11:26.238182 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m15:11:26.240278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:11:26.244866 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:11:26.245425 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m15:11:26.245935 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m15:11:26.252968 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."my_first_dbt_model__dbt_backup"
[0m15:11:26.258423 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m15:11:26.258423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:11:26.259423 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
drop table if exists "de_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m15:11:26.261423 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m15:11:26.262425 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:11:26.262425 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m15:11:26.267424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:11:26.269424 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m15:11:26.273425 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:11:26.274423 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:11:26.274423 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop view if exists "de_db"."public"."hello__dbt_backup" cascade
[0m15:11:26.277426 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: Close
[0m15:11:26.280424 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192270E7D50>]}
[0m15:11:26.282424 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:11:26.281423 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.16s]
[0m15:11:26.284425 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m15:11:26.284425 [debug] [Thread-2 (]: Finished running node model.my_dbt.my_first_dbt_model
[0m15:11:26.285423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019227C53A90>]}
[0m15:11:26.287425 [debug] [Thread-4 (]: Began running node model.my_dbt.my_second_dbt_model
[0m15:11:26.286427 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.17s]
[0m15:11:26.289424 [info ] [Thread-4 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m15:11:26.290426 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m15:11:26.291424 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.my_second_dbt_model'
[0m15:11:26.292423 [debug] [Thread-4 (]: Began compiling node model.my_dbt.my_second_dbt_model
[0m15:11:26.295423 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.my_second_dbt_model"
[0m15:11:26.297425 [debug] [Thread-4 (]: Began executing node model.my_dbt.my_second_dbt_model
[0m15:11:26.303425 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.my_second_dbt_model"
[0m15:11:26.305430 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m15:11:26.306425 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */

  
    

  create  table "de_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "de_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m15:11:26.306425 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:11:26.323431 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m15:11:26.327425 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m15:11:26.328423 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:11:26.330423 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:26.331423 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m15:11:26.332424 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m15:11:26.332424 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m15:11:26.336424 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:11:26.338424 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."my_second_dbt_model__dbt_backup"
[0m15:11:26.339424 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m15:11:26.340424 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
drop table if exists "de_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m15:11:26.341424 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:11:26.343426 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: Close
[0m15:11:26.344426 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eb16ca3-9135-401a-a2a3-ecdab3ada1a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001922784D390>]}
[0m15:11:26.345426 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.05s]
[0m15:11:26.346426 [debug] [Thread-4 (]: Finished running node model.my_dbt.my_second_dbt_model
[0m15:11:26.348423 [debug] [MainThread]: On master: COMMIT
[0m15:11:26.348423 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:26.349423 [debug] [MainThread]: On master: COMMIT
[0m15:11:26.349423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:26.364056 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:11:26.364576 [debug] [MainThread]: On master: Close
[0m15:11:26.365637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:26.366341 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m15:11:26.366894 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m15:11:26.367231 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m15:11:26.367745 [debug] [MainThread]: Connection 'model.my_dbt.my_first_dbt_model' was properly closed.
[0m15:11:26.368257 [debug] [MainThread]: Connection 'model.my_dbt.my_second_dbt_model' was properly closed.
[0m15:11:26.368770 [info ] [MainThread]: 
[0m15:11:26.369289 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:11:26.370343 [debug] [MainThread]: Command end result
[0m15:11:26.467908 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:11:26.469908 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:11:26.477626 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:11:26.477626 [info ] [MainThread]: 
[0m15:11:26.478624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:26.479624 [info ] [MainThread]: 
[0m15:11:26.479624 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:11:26.480624 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:26.480624 after 2.45 seconds
[0m15:11:26.481623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192256FB210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001921EF138D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001921EF69B10>]}
[0m15:11:26.481623 [debug] [MainThread]: Flushing usage events
[0m15:11:26.776125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:39:14.773790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424698da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424895b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794246812420>]}


============================== 22:39:14.785735 | 268ba817-fb28-46cd-ab48-10eee2648f15 ==============================
[0m22:39:14.785735 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:39:14.790074 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'write_json': 'True'}
[0m22:39:14.809412 [info ] [MainThread]: dbt version: 1.11.2
[0m22:39:14.812016 [info ] [MainThread]: python version: 3.12.4
[0m22:39:14.813994 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m22:39:14.816379 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m22:39:14.920682 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m22:39:14.923094 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m22:39:14.924717 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m22:39:14.926381 [info ] [MainThread]: adapter type: postgres
[0m22:39:14.928059 [info ] [MainThread]: adapter version: 1.10.0
[0m22:39:15.081687 [info ] [MainThread]: Configuration:
[0m22:39:15.084650 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:39:15.087286 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:39:15.089068 [info ] [MainThread]: Required dependencies:
[0m22:39:15.090864 [debug] [MainThread]: Executing "git --help"
[0m22:39:15.093657 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m22:39:15.095861 [info ] [MainThread]: Connection:
[0m22:39:15.097980 [info ] [MainThread]:   host: host.docker.internal
[0m22:39:15.099512 [info ] [MainThread]:   port: 6543
[0m22:39:15.101022 [info ] [MainThread]:   user: de_user
[0m22:39:15.102935 [info ] [MainThread]:   database: de_db
[0m22:39:15.104364 [info ] [MainThread]:   schema: public
[0m22:39:15.106492 [info ] [MainThread]:   connect_timeout: 10
[0m22:39:15.108197 [info ] [MainThread]:   role: None
[0m22:39:15.109887 [info ] [MainThread]:   search_path: None
[0m22:39:15.111036 [info ] [MainThread]:   keepalives_idle: 0
[0m22:39:15.112524 [info ] [MainThread]:   sslmode: None
[0m22:39:15.114404 [info ] [MainThread]:   sslcert: None
[0m22:39:15.116418 [info ] [MainThread]:   sslkey: None
[0m22:39:15.119336 [info ] [MainThread]:   sslrootcert: None
[0m22:39:15.121095 [info ] [MainThread]:   application_name: dbt
[0m22:39:15.123386 [info ] [MainThread]:   retries: 1
[0m22:39:15.125673 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:39:15.224468 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:39:15.296950 [debug] [MainThread]: Using postgres connection "debug"
[0m22:39:15.299120 [debug] [MainThread]: On debug: select 1 as id
[0m22:39:15.300433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:15.325612 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m22:39:15.329849 [debug] [MainThread]: On debug: Close
[0m22:39:15.332119 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:39:15.335769 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:39:15.339765 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m22:39:15.344153 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.66451347, "process_in_blocks": "1504", "process_kernel_time": 0.493285, "process_mem_max_rss": "118824", "process_out_blocks": "0", "process_user_time": 2.983973}
[0m22:39:15.346909 [debug] [MainThread]: Command `dbt debug` failed at 22:39:15.346316 after 0.67 seconds
[0m22:39:15.348984 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:39:15.351088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79424895b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794245a8f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794245ddc440>]}
[0m22:39:15.352550 [debug] [MainThread]: Flushing usage events
[0m22:39:15.504327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:45:57.835120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b4270e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b4270ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b4270b90>]}


============================== 22:45:57.859663 | 4640818e-076d-4bfb-9b7f-6d286e9d2331 ==============================
[0m22:45:57.859663 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:45:57.864826 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt_profiles', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'False'}
[0m22:45:58.333650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b2ddb0e0>]}
[0m22:45:58.437230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b43e3470>]}
[0m22:45:58.440266 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:45:58.576156 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:45:58.737437 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:45:58.738839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b2db7e90>]}
[0m22:46:00.457410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b11a5190>]}
[0m22:46:00.575946 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m22:46:00.596152 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m22:46:00.656587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b119e3f0>]}
[0m22:46:00.658248 [info ] [MainThread]: Found 3 models, 4 data tests, 464 macros
[0m22:46:00.660506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b195faa0>]}
[0m22:46:00.664476 [info ] [MainThread]: 
[0m22:46:00.666949 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:00.669083 [info ] [MainThread]: 
[0m22:46:00.672352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:46:00.679546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m22:46:00.726468 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m22:46:00.727906 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m22:46:00.728795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:00.747867 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m22:46:00.750831 [debug] [ThreadPool]: On list_de_db: Close
[0m22:46:00.754666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_db, now list_de_db_public)
[0m22:46:00.761888 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m22:46:00.763257 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:46:00.764619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:00.789666 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.025 seconds
[0m22:46:00.793404 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m22:46:00.798167 [debug] [ThreadPool]: On list_de_db_public: Close
[0m22:46:00.813137 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:00.814674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:46:00.815627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:00.838359 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m22:46:00.840811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b1539910>]}
[0m22:46:00.842711 [debug] [MainThread]: On master: ROLLBACK
[0m22:46:00.845633 [debug] [MainThread]: On master: COMMIT
[0m22:46:00.847457 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:00.848480 [debug] [MainThread]: On master: COMMIT
[0m22:46:00.851848 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m22:46:00.853857 [debug] [MainThread]: On master: Close
[0m22:46:00.865331 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m22:46:00.865850 [debug] [Thread-2 (]: Began running node model.my_dbt.my_first_dbt_model
[0m22:46:00.866726 [info ] [Thread-1 (]: 1 of 3 START sql table model public.hello ...................................... [RUN]
[0m22:46:00.868362 [info ] [Thread-2 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:46:00.870505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now model.my_dbt.hello)
[0m22:46:00.872719 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.my_first_dbt_model'
[0m22:46:00.873932 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m22:46:00.875382 [debug] [Thread-2 (]: Began compiling node model.my_dbt.my_first_dbt_model
[0m22:46:00.882522 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m22:46:00.886191 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.my_first_dbt_model"
[0m22:46:00.903387 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m22:46:00.905420 [debug] [Thread-2 (]: Began executing node model.my_dbt.my_first_dbt_model
[0m22:46:00.976983 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m22:46:00.977984 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.my_first_dbt_model"
[0m22:46:00.994309 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:46:00.995079 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:46:00.996780 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m22:46:00.998538 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */

  
    

  create  table "de_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:46:01.000226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:01.002471 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:46:01.027144 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.025 seconds
[0m22:46:01.027779 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.028 seconds
[0m22:46:01.040520 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:46:01.047554 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:46:01.048684 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m22:46:01.050509 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m22:46:01.054404 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:46:01.055108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:46:01.059665 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:46:01.064535 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:46:01.066074 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:46:01.067277 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m22:46:01.069973 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:01.070440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:01.092249 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m22:46:01.094035 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m22:46:01.095379 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:46:01.096790 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:46:01.098008 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m22:46:01.099395 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m22:46:01.106736 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m22:46:01.107572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m22:46:01.115837 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."my_first_dbt_model__dbt_backup"
[0m22:46:01.119368 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m22:46:01.127609 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:46:01.129537 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:46:01.130636 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
drop table if exists "de_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:46:01.131498 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m22:46:01.139287 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m22:46:01.139927 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m22:46:01.143032 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m22:46:01.146399 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: Close
[0m22:46:01.150513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b5961e20>]}
[0m22:46:01.152854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674a2d55250>]}
[0m22:46:01.155522 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.28s]
[0m22:46:01.158576 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.28s]
[0m22:46:01.161247 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m22:46:01.163287 [debug] [Thread-2 (]: Finished running node model.my_dbt.my_first_dbt_model
[0m22:46:01.168632 [debug] [Thread-4 (]: Began running node model.my_dbt.my_second_dbt_model
[0m22:46:01.172470 [info ] [Thread-4 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m22:46:01.175092 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.my_second_dbt_model'
[0m22:46:01.177393 [debug] [Thread-4 (]: Began compiling node model.my_dbt.my_second_dbt_model
[0m22:46:01.185777 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.my_second_dbt_model"
[0m22:46:01.214454 [debug] [Thread-4 (]: Began executing node model.my_dbt.my_second_dbt_model
[0m22:46:01.226095 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.my_second_dbt_model"
[0m22:46:01.251743 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:46:01.253324 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */

  
    

  create  table "de_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "de_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m22:46:01.255177 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:46:01.275645 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m22:46:01.281561 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:46:01.283071 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m22:46:01.287214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:46:01.292325 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:46:01.294216 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:46:01.296960 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:46:01.300024 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m22:46:01.301141 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:46:01.302393 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m22:46:01.309763 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:46:01.314651 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."my_second_dbt_model__dbt_backup"
[0m22:46:01.316910 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:46:01.317880 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
drop table if exists "de_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:46:01.323816 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m22:46:01.326347 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: Close
[0m22:46:01.328036 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4640818e-076d-4bfb-9b7f-6d286e9d2331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674a0426780>]}
[0m22:46:01.329468 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.15s]
[0m22:46:01.332098 [debug] [Thread-4 (]: Finished running node model.my_dbt.my_second_dbt_model
[0m22:46:01.336060 [debug] [MainThread]: On master: COMMIT
[0m22:46:01.337948 [debug] [MainThread]: Using postgres connection "master"
[0m22:46:01.338909 [debug] [MainThread]: On master: COMMIT
[0m22:46:01.339663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:01.356665 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m22:46:01.358005 [debug] [MainThread]: On master: Close
[0m22:46:01.359620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:01.361246 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m22:46:01.363061 [debug] [MainThread]: Connection 'model.my_dbt.my_first_dbt_model' was properly closed.
[0m22:46:01.364738 [debug] [MainThread]: Connection 'model.my_dbt.my_second_dbt_model' was properly closed.
[0m22:46:01.366196 [info ] [MainThread]: 
[0m22:46:01.367319 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m22:46:01.370152 [debug] [MainThread]: Command end result
[0m22:46:01.416582 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m22:46:01.431205 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m22:46:01.470071 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m22:46:01.472098 [info ] [MainThread]: 
[0m22:46:01.475084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:01.478189 [info ] [MainThread]: 
[0m22:46:01.481466 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:46:01.484402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7495577, "process_in_blocks": "8096", "process_kernel_time": 0.581002, "process_mem_max_rss": "132148", "process_out_blocks": "0", "process_user_time": 5.188673}
[0m22:46:01.486787 [debug] [MainThread]: Command `dbt run` succeeded at 22:46:01.486371 after 3.75 seconds
[0m22:46:01.488882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b5461a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b215a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7674b11a68a0>]}
[0m22:46:01.491470 [debug] [MainThread]: Flushing usage events
[0m22:46:01.579671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:59.029294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728639352720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72863b0b6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286393516a0>]}


============================== 22:49:59.040734 | b96a0012-43d5-4b71-99ed-72eafbb5f591 ==============================
[0m22:49:59.040734 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:49:59.043833 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m22:49:59.349415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286384e6900>]}
[0m22:49:59.452944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728639b5bb30>]}
[0m22:49:59.455450 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:49:59.605929 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:49:59.999447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:50:00.000879 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:50:00.002332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:50:00.056597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728637b45430>]}
[0m22:50:00.169376 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m22:50:00.176539 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m22:50:00.259862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72863852b1a0>]}
[0m22:50:00.262574 [info ] [MainThread]: Found 3 models, 4 data tests, 464 macros
[0m22:50:00.266506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728637b13a40>]}
[0m22:50:00.271274 [info ] [MainThread]: 
[0m22:50:00.275101 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:50:00.278238 [info ] [MainThread]: 
[0m22:50:00.281262 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:50:00.289601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m22:50:00.334264 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m22:50:00.335355 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m22:50:00.336101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:00.361041 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m22:50:00.375960 [debug] [ThreadPool]: On list_de_db: Close
[0m22:50:00.381898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_db, now list_de_db_public)
[0m22:50:00.399135 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m22:50:00.401224 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:50:00.402841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:50:00.438194 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.035 seconds
[0m22:50:00.441808 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m22:50:00.446395 [debug] [ThreadPool]: On list_de_db_public: Close
[0m22:50:00.471848 [debug] [MainThread]: Using postgres connection "master"
[0m22:50:00.474260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:50:00.477286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:50:00.507826 [debug] [MainThread]: SQL status: SELECT 0 in 0.030 seconds
[0m22:50:00.512321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72863abe5370>]}
[0m22:50:00.517523 [debug] [MainThread]: On master: ROLLBACK
[0m22:50:00.523287 [debug] [MainThread]: On master: COMMIT
[0m22:50:00.524970 [debug] [MainThread]: Using postgres connection "master"
[0m22:50:00.526723 [debug] [MainThread]: On master: COMMIT
[0m22:50:00.532995 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m22:50:00.535200 [debug] [MainThread]: On master: Close
[0m22:50:00.546533 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m22:50:00.547443 [debug] [Thread-2 (]: Began running node model.my_dbt.my_first_dbt_model
[0m22:50:00.548778 [info ] [Thread-1 (]: 1 of 3 START sql table model public.hello ...................................... [RUN]
[0m22:50:00.550906 [info ] [Thread-2 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:50:00.554026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now model.my_dbt.hello)
[0m22:50:00.556142 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.my_first_dbt_model'
[0m22:50:00.557998 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m22:50:00.559503 [debug] [Thread-2 (]: Began compiling node model.my_dbt.my_first_dbt_model
[0m22:50:00.569089 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m22:50:00.574304 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.my_first_dbt_model"
[0m22:50:00.579924 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m22:50:00.582128 [debug] [Thread-2 (]: Began executing node model.my_dbt.my_first_dbt_model
[0m22:50:00.678141 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m22:50:00.679187 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.my_first_dbt_model"
[0m22:50:00.684264 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:50:00.686582 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m22:50:00.687658 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:50:00.689017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:00.691685 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */

  
    

  create  table "de_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:50:00.694841 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:50:00.716051 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m22:50:00.725492 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.031 seconds
[0m22:50:00.733061 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:50:00.740609 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:50:00.742181 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m22:50:00.743678 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m22:50:00.748266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:50:00.749321 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:50:00.757607 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:50:00.763256 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:50:00.764615 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m22:50:00.766032 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:50:00.770651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:50:00.771476 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:50:00.792490 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m22:50:00.794293 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m22:50:00.796163 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:50:00.797782 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:50:00.799301 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m22:50:00.801064 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m22:50:00.808011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:50:00.809448 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m22:50:00.819459 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m22:50:00.823487 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."my_first_dbt_model__dbt_backup"
[0m22:50:00.831957 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m22:50:00.833354 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m22:50:00.834740 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m22:50:00.836198 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
drop table if exists "de_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:50:00.842050 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m22:50:00.843760 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m22:50:00.848394 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m22:50:00.852012 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: Close
[0m22:50:00.856711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728636fc05f0>]}
[0m22:50:00.859386 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728636329bb0>]}
[0m22:50:00.863732 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.30s]
[0m22:50:00.867295 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.30s]
[0m22:50:00.869480 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m22:50:00.871162 [debug] [Thread-2 (]: Finished running node model.my_dbt.my_first_dbt_model
[0m22:50:00.875426 [debug] [Thread-4 (]: Began running node model.my_dbt.my_second_dbt_model
[0m22:50:00.876988 [info ] [Thread-4 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m22:50:00.878803 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.my_second_dbt_model'
[0m22:50:00.880052 [debug] [Thread-4 (]: Began compiling node model.my_dbt.my_second_dbt_model
[0m22:50:00.884330 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.my_second_dbt_model"
[0m22:50:00.891531 [debug] [Thread-4 (]: Began executing node model.my_dbt.my_second_dbt_model
[0m22:50:00.897499 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.my_second_dbt_model"
[0m22:50:00.904065 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:50:00.906198 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */

  
    

  create  table "de_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "de_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m22:50:00.907480 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:50:00.928416 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m22:50:00.933933 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:50:00.935633 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m22:50:00.939596 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:50:00.944388 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:50:00.946134 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:50:00.950340 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:50:00.953449 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m22:50:00.955210 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:50:00.956466 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m22:50:00.962123 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m22:50:00.966108 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."my_second_dbt_model__dbt_backup"
[0m22:50:00.968564 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m22:50:00.969816 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
drop table if exists "de_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:50:00.975658 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:50:00.981279 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: Close
[0m22:50:00.983881 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b96a0012-43d5-4b71-99ed-72eafbb5f591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728636329e50>]}
[0m22:50:00.987692 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m22:50:00.993949 [debug] [Thread-4 (]: Finished running node model.my_dbt.my_second_dbt_model
[0m22:50:01.002370 [debug] [MainThread]: On master: COMMIT
[0m22:50:01.007672 [debug] [MainThread]: Using postgres connection "master"
[0m22:50:01.012460 [debug] [MainThread]: On master: COMMIT
[0m22:50:01.014971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:50:01.039993 [debug] [MainThread]: SQL status: COMMIT in 0.025 seconds
[0m22:50:01.043700 [debug] [MainThread]: On master: Close
[0m22:50:01.048116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:01.051618 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m22:50:01.053476 [debug] [MainThread]: Connection 'model.my_dbt.my_first_dbt_model' was properly closed.
[0m22:50:01.056846 [debug] [MainThread]: Connection 'model.my_dbt.my_second_dbt_model' was properly closed.
[0m22:50:01.060231 [info ] [MainThread]: 
[0m22:50:01.062359 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m22:50:01.065565 [debug] [MainThread]: Command end result
[0m22:50:01.108269 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m22:50:01.116313 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m22:50:01.130704 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m22:50:01.133133 [info ] [MainThread]: 
[0m22:50:01.135429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:50:01.138229 [info ] [MainThread]: 
[0m22:50:01.139809 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:50:01.143082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2100549, "process_in_blocks": "0", "process_kernel_time": 0.624121, "process_mem_max_rss": "127624", "process_out_blocks": "448", "process_user_time": 4.352846}
[0m22:50:01.145242 [debug] [MainThread]: Command `dbt run` succeeded at 22:50:01.144928 after 2.21 seconds
[0m22:50:01.146610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728639a6c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286390cf800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728639a35b50>]}
[0m22:50:01.148166 [debug] [MainThread]: Flushing usage events
[0m22:50:01.287196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:42.105962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04551A0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04556B8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04553AA50>]}


============================== 11:04:42.115287 | 844a942e-7426-475e-a39a-b0d481d7ae6e ==============================
[0m11:04:42.115287 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:04:42.116289 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m11:04:42.586815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B045512B10>]}
[0m11:04:42.657146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B041D681D0>]}
[0m11:04:42.661145 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:04:43.278157 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:04:43.404914 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:04:43.405911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B044560AD0>]}
[0m11:04:46.822029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0469BBED0>]}
[0m11:04:46.911585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m11:04:46.937970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m11:04:46.999809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B046F12750>]}
[0m11:04:47.001446 [info ] [MainThread]: Found 6 models, 11 data tests, 464 macros
[0m11:04:47.001446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B046C505D0>]}
[0m11:04:47.005444 [info ] [MainThread]: 
[0m11:04:47.005444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:04:47.006441 [info ] [MainThread]: 
[0m11:04:47.007447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:04:47.012443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m11:04:50.859080 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m11:04:50.860075 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m11:04:50.861073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:50.916573 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.055 seconds
[0m11:04:50.918126 [debug] [ThreadPool]: On list_de_db: Close
[0m11:04:50.921556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m11:04:50.930198 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m11:04:50.931529 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:04:50.932057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:50.953093 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.021 seconds
[0m11:04:50.955989 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m11:04:50.958660 [debug] [ThreadPool]: On list_de_db_public: Close
[0m11:04:50.971252 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:50.972295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:04:50.972812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:50.993703 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m11:04:50.995259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04144E110>]}
[0m11:04:50.995780 [debug] [MainThread]: On master: ROLLBACK
[0m11:04:50.997955 [debug] [MainThread]: On master: COMMIT
[0m11:04:50.998993 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:50.999515 [debug] [MainThread]: On master: COMMIT
[0m11:04:51.002518 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:04:51.003069 [debug] [MainThread]: On master: Close
[0m11:04:51.011408 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m11:04:51.011408 [debug] [Thread-2 (]: Began running node model.my_dbt.my_first_dbt_model
[0m11:04:51.012407 [info ] [Thread-1 (]: 1 of 3 START sql table model public.hello ...................................... [RUN]
[0m11:04:51.013409 [info ] [Thread-2 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m11:04:51.013409 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m11:04:51.014409 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.my_first_dbt_model'
[0m11:04:51.015412 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m11:04:51.016413 [debug] [Thread-2 (]: Began compiling node model.my_dbt.my_first_dbt_model
[0m11:04:51.023407 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m11:04:51.027409 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.my_first_dbt_model"
[0m11:04:51.028407 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m11:04:51.049094 [debug] [Thread-2 (]: Began executing node model.my_dbt.my_first_dbt_model
[0m11:04:51.072022 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m11:04:51.077028 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.my_first_dbt_model"
[0m11:04:51.079024 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:04:51.079024 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:04:51.080296 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m11:04:51.080820 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */

  
    

  create  table "de_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m11:04:51.080820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:51.081811 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:04:51.122900 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.042 seconds
[0m11:04:51.123939 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.042 seconds
[0m11:04:51.134778 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:04:51.141010 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:04:51.141524 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m11:04:51.142525 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:04:51.144524 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:51.145523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:51.149522 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:04:51.154523 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:04:51.154523 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:04:51.155524 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m11:04:51.157527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:51.158524 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:51.176528 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m11:04:51.178526 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m11:04:51.179522 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:04:51.179522 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:04:51.180521 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m11:04:51.180521 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m11:04:51.184541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:04:51.185060 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m11:04:51.193311 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m11:04:51.195906 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."my_first_dbt_model__dbt_backup"
[0m11:04:51.201902 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:04:51.203904 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:04:51.204904 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m11:04:51.204904 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
drop table if exists "de_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m11:04:51.216451 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m11:04:51.216819 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.011 seconds
[0m11:04:51.219946 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m11:04:51.222029 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: Close
[0m11:04:51.227322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B047262810>]}
[0m11:04:51.228377 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B046C6E590>]}
[0m11:04:51.229374 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.21s]
[0m11:04:51.230375 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m11:04:51.231378 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m11:04:51.232380 [debug] [Thread-2 (]: Finished running node model.my_dbt.my_first_dbt_model
[0m11:04:51.233374 [debug] [Thread-4 (]: Began running node model.my_dbt.my_second_dbt_model
[0m11:04:51.234374 [info ] [Thread-4 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m11:04:51.234374 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.my_second_dbt_model'
[0m11:04:51.236381 [debug] [Thread-4 (]: Began compiling node model.my_dbt.my_second_dbt_model
[0m11:04:51.240373 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.my_second_dbt_model"
[0m11:04:51.241378 [debug] [Thread-4 (]: Began executing node model.my_dbt.my_second_dbt_model
[0m11:04:51.250132 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.my_second_dbt_model"
[0m11:04:51.252135 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:04:51.253137 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */

  
    

  create  table "de_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "de_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m11:04:51.254139 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:04:51.272716 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m11:04:51.276748 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:04:51.277752 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:04:51.281213 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:51.284777 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:04:51.285780 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:04:51.288778 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:51.290777 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m11:04:51.291778 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:04:51.291778 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m11:04:51.297782 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m11:04:51.304105 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."my_second_dbt_model__dbt_backup"
[0m11:04:51.306926 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:04:51.308131 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
drop table if exists "de_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m11:04:51.315459 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:04:51.318798 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: Close
[0m11:04:51.320295 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '844a942e-7426-475e-a39a-b0d481d7ae6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B047791410>]}
[0m11:04:51.321836 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.09s]
[0m11:04:51.323408 [debug] [Thread-4 (]: Finished running node model.my_dbt.my_second_dbt_model
[0m11:04:51.325027 [debug] [MainThread]: On master: COMMIT
[0m11:04:51.325974 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:51.326973 [debug] [MainThread]: On master: COMMIT
[0m11:04:51.327972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:51.343971 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m11:04:51.343971 [debug] [MainThread]: On master: Close
[0m11:04:51.344968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:51.345976 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m11:04:51.346971 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m11:04:51.347972 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m11:04:51.347972 [debug] [MainThread]: Connection 'model.my_dbt.my_first_dbt_model' was properly closed.
[0m11:04:51.349978 [debug] [MainThread]: Connection 'model.my_dbt.my_second_dbt_model' was properly closed.
[0m11:04:51.349978 [info ] [MainThread]: 
[0m11:04:51.350969 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m11:04:51.351968 [debug] [MainThread]: Command end result
[0m11:04:51.496084 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m11:04:51.500080 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m11:04:51.507075 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m11:04:51.507075 [info ] [MainThread]: 
[0m11:04:51.509078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:51.510077 [info ] [MainThread]: 
[0m11:04:51.511078 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:04:51.512935 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:51.512935 after 9.52 seconds
[0m11:04:51.513933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B03E6D8BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B03E9E1650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B03E9E0890>]}
[0m11:04:51.514934 [debug] [MainThread]: Flushing usage events
[0m11:04:51.982984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:05:01.907617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2B2AA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2B2D2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2B2D3190>]}


============================== 11:05:01.915276 | a9689a3a-1d9b-415f-8665-7da7deccc0be ==============================
[0m11:05:01.915276 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:05:01.916262 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m11:05:02.135350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9689a3a-1d9b-415f-8665-7da7deccc0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2B304550>]}
[0m11:05:02.211962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9689a3a-1d9b-415f-8665-7da7deccc0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A27B081D0>]}
[0m11:05:02.214965 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:05:02.497481 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:05:02.657290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:05:02.657290 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:05:02.658290 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:05:02.703512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9689a3a-1d9b-415f-8665-7da7deccc0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2C774890>]}
[0m11:05:02.797210 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m11:05:02.801211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m11:05:02.853774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9689a3a-1d9b-415f-8665-7da7deccc0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2CA9FFD0>]}
[0m11:05:02.854779 [info ] [MainThread]: Found 6 models, 11 data tests, 464 macros
[0m11:05:02.855772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9689a3a-1d9b-415f-8665-7da7deccc0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2B304C10>]}
[0m11:05:02.859775 [info ] [MainThread]: 
[0m11:05:02.861773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:05:02.862771 [info ] [MainThread]: 
[0m11:05:02.863775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:05:02.870691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m11:05:03.046804 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m11:05:03.047805 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:05:03.047805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:03.070806 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.023 seconds
[0m11:05:03.073805 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m11:05:03.075807 [debug] [ThreadPool]: On list_de_db_public: Close
[0m11:05:03.090805 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:03.090805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:05:03.091813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:05:03.110813 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m11:05:03.112372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9689a3a-1d9b-415f-8665-7da7deccc0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2AAD5710>]}
[0m11:05:03.113424 [debug] [MainThread]: On master: ROLLBACK
[0m11:05:03.116680 [debug] [MainThread]: On master: COMMIT
[0m11:05:03.117196 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:03.117196 [debug] [MainThread]: On master: COMMIT
[0m11:05:03.120221 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:05:03.121265 [debug] [MainThread]: On master: Close
[0m11:05:03.127620 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94
[0m11:05:03.128123 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12
[0m11:05:03.128650 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5
[0m11:05:03.129171 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:05:03.129675 [info ] [Thread-1 (]: 1 of 11 START test not_null_mart_trip_facts_do_location_id ..................... [RUN]
[0m11:05:03.130514 [info ] [Thread-2 (]: 2 of 11 START test not_null_mart_trip_facts_pickup_ts .......................... [RUN]
[0m11:05:03.132197 [info ] [Thread-3 (]: 3 of 11 START test not_null_mart_trip_facts_pu_location_id ..................... [RUN]
[0m11:05:03.133201 [info ] [Thread-4 (]: 4 of 11 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m11:05:03.134195 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94'
[0m11:05:03.134195 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12'
[0m11:05:03.135195 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5'
[0m11:05:03.137195 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m11:05:03.137195 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94
[0m11:05:03.138198 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12
[0m11:05:03.139196 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5
[0m11:05:03.139196 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:05:03.158897 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94"
[0m11:05:03.164899 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12"
[0m11:05:03.169901 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5"
[0m11:05:03.174414 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:05:03.178334 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94
[0m11:05:03.178334 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:05:03.179338 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12
[0m11:05:03.200105 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94"
[0m11:05:03.200105 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5
[0m11:05:03.204106 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:05:03.207999 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12"
[0m11:05:03.210998 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5"
[0m11:05:03.212999 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:05:03.214001 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94"
[0m11:05:03.216006 [debug] [Thread-4 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "de_db"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.217002 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12"
[0m11:05:03.217002 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5"
[0m11:05:03.217999 [debug] [Thread-1 (]: On test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select do_location_id
from "de_db"."public"."mart_trip_facts"
where do_location_id is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.217999 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:05:03.219001 [debug] [Thread-2 (]: On test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_ts
from "de_db"."public"."mart_trip_facts"
where pickup_ts is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.219001 [debug] [Thread-3 (]: On test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pu_location_id
from "de_db"."public"."mart_trip_facts"
where pu_location_id is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.220001 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:05:03.221002 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:05:03.222503 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:05:03.240429 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.mart_trip_facts" does not exist
LINE 17: from "de_db"."public"."mart_trip_facts"
              ^

[0m11:05:03.241429 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m11:05:03.241429 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.mart_trip_facts" does not exist
LINE 17: from "de_db"."public"."mart_trip_facts"
              ^

[0m11:05:03.242429 [debug] [Thread-1 (]: On test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94: ROLLBACK
[0m11:05:03.247429 [debug] [Thread-4 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m11:05:03.247429 [debug] [Thread-3 (]: On test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5: ROLLBACK
[0m11:05:03.249431 [debug] [Thread-1 (]: On test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94: Close
[0m11:05:03.250431 [debug] [Thread-4 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m11:05:03.250431 [debug] [Thread-3 (]: On test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5: Close
[0m11:05:03.251428 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.mart_trip_facts" does not exist
LINE 17: from "de_db"."public"."mart_trip_facts"
              ^

[0m11:05:03.256830 [debug] [Thread-2 (]: On test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12: ROLLBACK
[0m11:05:03.253429 [error] [Thread-4 (]: 4 of 11 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.12s]
[0m11:05:03.260864 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:05:03.262170 [debug] [Thread-2 (]: On test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12: Close
[0m11:05:03.262692 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m11:05:03.266062 [info ] [Thread-4 (]: 5 of 11 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m11:05:03.267056 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m11:05:03.269049 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m11:05:03.278377 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m11:05:03.279926 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m11:05:03.286978 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m11:05:03.288979 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m11:05:03.289978 [debug] [Thread-4 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "de_db"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.290976 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:03.309979 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m11:05:03.311978 [debug] [Thread-4 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m11:05:03.315524 [debug] [Thread-4 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m11:05:03.317179 [info ] [Thread-4 (]: 5 of 11 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.05s]
[0m11:05:03.319773 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m11:05:03.320820 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de
[0m11:05:03.321911 [info ] [Thread-4 (]: 6 of 11 START test not_null_stg_yellow_tripdata_dropoff_ts ..................... [RUN]
[0m11:05:03.323495 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de)
[0m11:05:03.324015 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de
[0m11:05:03.330267 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de"
[0m11:05:03.332735 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de
[0m11:05:03.335732 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de"
[0m11:05:03.337736 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de"
[0m11:05:03.338735 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_ts
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_ts is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.338735 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:03.357075 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_yellow_tripdata" does not exist
LINE 17: from "de_db"."public"."stg_yellow_tripdata"
              ^

[0m11:05:03.358074 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de: ROLLBACK
[0m11:05:03.360075 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de: Close
[0m11:05:03.487320 [debug] [Thread-4 (]: Database Error in test not_null_stg_yellow_tripdata_dropoff_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_dropoff_ts.sql
[0m11:05:03.488322 [debug] [Thread-3 (]: Database Error in test not_null_mart_trip_facts_pu_location_id (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_pu_location_id.sql
[0m11:05:03.489322 [debug] [Thread-2 (]: Database Error in test not_null_mart_trip_facts_pickup_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_pickup_ts.sql
[0m11:05:03.491320 [debug] [Thread-1 (]: Database Error in test not_null_mart_trip_facts_do_location_id (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_do_location_id.sql
[0m11:05:03.491320 [error] [Thread-4 (]: 6 of 11 ERROR not_null_stg_yellow_tripdata_dropoff_ts .......................... [[31mERROR[0m in 0.17s]
[0m11:05:03.492319 [error] [Thread-3 (]: 3 of 11 ERROR not_null_mart_trip_facts_pu_location_id .......................... [[31mERROR[0m in 0.36s]
[0m11:05:03.493323 [error] [Thread-2 (]: 2 of 11 ERROR not_null_mart_trip_facts_pickup_ts ............................... [[31mERROR[0m in 0.36s]
[0m11:05:03.495320 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de
[0m11:05:03.494325 [error] [Thread-1 (]: 1 of 11 ERROR not_null_mart_trip_facts_do_location_id .......................... [[31mERROR[0m in 0.36s]
[0m11:05:03.495320 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5
[0m11:05:03.496319 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12
[0m11:05:03.497321 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67
[0m11:05:03.498324 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_yellow_tripdata_dropoff_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_dropoff_ts.sql.
[0m11:05:03.498324 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94
[0m11:05:03.499322 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4
[0m11:05:03.500321 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e
[0m11:05:03.503326 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_trip_facts_pu_location_id (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_pu_location_id.sql.
[0m11:05:03.501323 [info ] [Thread-4 (]: 7 of 11 START test not_null_stg_yellow_tripdata_fare_amount .................... [RUN]
[0m11:05:03.504854 [debug] [Thread-1 (]: Began running node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m11:05:03.504854 [info ] [Thread-3 (]: 8 of 11 START test not_null_stg_yellow_tripdata_passenger_count_clean .......... [RUN]
[0m11:05:03.505843 [info ] [Thread-2 (]: 9 of 11 START test not_null_stg_yellow_tripdata_pickup_ts ...................... [RUN]
[0m11:05:03.506845 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_trip_facts_pickup_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_pickup_ts.sql.
[0m11:05:03.506845 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_stg_yellow_tripdata_dropoff_ts.d2e608a3de, now test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67)
[0m11:05:03.507847 [info ] [Thread-1 (]: 10 of 11 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m11:05:03.509845 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_mart_trip_facts_pu_location_id.ff3a5c5bb5, now test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4)
[0m11:05:03.509845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_mart_trip_facts_pickup_ts.0e9eecdf12, now test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e)
[0m11:05:03.510847 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_trip_facts_do_location_id (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_do_location_id.sql.
[0m11:05:03.511843 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67
[0m11:05:03.511843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_mart_trip_facts_do_location_id.f6910bdd94, now test.my_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m11:05:03.512845 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4
[0m11:05:03.512845 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e
[0m11:05:03.518849 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67"
[0m11:05:03.519846 [debug] [Thread-1 (]: Began compiling node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m11:05:03.524844 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4"
[0m11:05:03.530848 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e"
[0m11:05:03.538975 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m11:05:03.539975 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67
[0m11:05:03.545154 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67"
[0m11:05:03.545669 [debug] [Thread-1 (]: Began executing node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m11:05:03.546671 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e
[0m11:05:03.546671 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4
[0m11:05:03.551197 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m11:05:03.552202 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67"
[0m11:05:03.556198 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e"
[0m11:05:03.559202 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4"
[0m11:05:03.560339 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fare_amount
from "de_db"."public"."stg_yellow_tripdata"
where fare_amount is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.560855 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m11:05:03.561856 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:03.562852 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e"
[0m11:05:03.562852 [debug] [Thread-1 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "de_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:05:03.563855 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4"
[0m11:05:03.564858 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_ts
from "de_db"."public"."stg_yellow_tripdata"
where pickup_ts is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.566217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:03.567181 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select passenger_count_clean
from "de_db"."public"."stg_yellow_tripdata"
where passenger_count_clean is null



  
  
      
    ) dbt_internal_test
[0m11:05:03.567725 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:05:03.568752 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:05:03.582486 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.stg_yellow_tripdata" does not exist
LINE 17: from "de_db"."public"."stg_yellow_tripdata"
              ^

[0m11:05:03.583529 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67: ROLLBACK
[0m11:05:03.584559 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67: Close
[0m11:05:03.588800 [debug] [Thread-4 (]: Database Error in test not_null_stg_yellow_tripdata_fare_amount (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_fare_amount.sql
[0m11:05:03.589369 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_yellow_tripdata" does not exist
LINE 17: from "de_db"."public"."stg_yellow_tripdata"
              ^

[0m11:05:03.590428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m11:05:03.592948 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e: ROLLBACK
[0m11:05:03.590987 [error] [Thread-4 (]: 7 of 11 ERROR not_null_stg_yellow_tripdata_fare_amount ......................... [[31mERROR[0m in 0.08s]
[0m11:05:03.595748 [debug] [Thread-1 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m11:05:03.597586 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67
[0m11:05:03.598112 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e: Close
[0m11:05:03.599138 [debug] [Thread-4 (]: Began running node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m11:05:03.599657 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_yellow_tripdata_fare_amount (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_fare_amount.sql.
[0m11:05:03.600175 [debug] [Thread-1 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m11:05:03.604206 [debug] [Thread-2 (]: Database Error in test not_null_stg_yellow_tripdata_pickup_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_pickup_ts.sql
[0m11:05:03.601685 [info ] [Thread-4 (]: 11 of 11 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m11:05:03.606211 [info ] [Thread-1 (]: 10 of 11 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.09s]
[0m11:05:03.609208 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_yellow_tripdata" does not exist
LINE 17: from "de_db"."public"."stg_yellow_tripdata"
              ^

[0m11:05:03.610208 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_stg_yellow_tripdata_fare_amount.cad2315b67, now test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:05:03.607208 [error] [Thread-2 (]: 9 of 11 ERROR not_null_stg_yellow_tripdata_pickup_ts ........................... [[31mERROR[0m in 0.10s]
[0m11:05:03.611205 [debug] [Thread-1 (]: Finished running node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m11:05:03.611205 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4: ROLLBACK
[0m11:05:03.612206 [debug] [Thread-4 (]: Began compiling node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m11:05:03.613208 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e
[0m11:05:03.622207 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4: Close
[0m11:05:03.621208 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:05:03.624210 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_yellow_tripdata_pickup_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_pickup_ts.sql.
[0m11:05:03.627914 [debug] [Thread-4 (]: Began executing node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m11:05:03.633579 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:05:03.636723 [debug] [Thread-3 (]: Database Error in test not_null_stg_yellow_tripdata_passenger_count_clean (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_passenger_count_clean.sql
[0m11:05:03.639155 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:05:03.638603 [error] [Thread-3 (]: 8 of 11 ERROR not_null_stg_yellow_tripdata_passenger_count_clean ............... [[31mERROR[0m in 0.13s]
[0m11:05:03.643542 [debug] [Thread-4 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "de_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:05:03.644595 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4
[0m11:05:03.645640 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:05:03.646163 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_yellow_tripdata_passenger_count_clean (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_passenger_count_clean.sql.
[0m11:05:03.665549 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m11:05:03.667804 [debug] [Thread-4 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m11:05:03.670420 [debug] [Thread-4 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m11:05:03.671986 [info ] [Thread-4 (]: 11 of 11 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
[0m11:05:03.673547 [debug] [Thread-4 (]: Finished running node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m11:05:03.675316 [debug] [MainThread]: On master: COMMIT
[0m11:05:03.676357 [debug] [MainThread]: Using postgres connection "master"
[0m11:05:03.676878 [debug] [MainThread]: On master: COMMIT
[0m11:05:03.677407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:05:03.692451 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m11:05:03.693500 [debug] [MainThread]: On master: Close
[0m11:05:03.694018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:03.694018 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m11:05:03.695008 [debug] [MainThread]: Connection 'test.my_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m11:05:03.695008 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_ts.37ccee7f6e' was properly closed.
[0m11:05:03.696010 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_passenger_count_clean.69232dabb4' was properly closed.
[0m11:05:03.696530 [debug] [MainThread]: Connection 'test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:05:03.697528 [info ] [MainThread]: 
[0m11:05:03.698527 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m11:05:03.701036 [debug] [MainThread]: Command end result
[0m11:05:03.728038 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m11:05:03.733035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m11:05:03.740036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m11:05:03.741035 [info ] [MainThread]: 
[0m11:05:03.742036 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m11:05:03.743044 [info ] [MainThread]: 
[0m11:05:03.745164 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m11:05:03.747159 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:05:03.749161 [info ] [MainThread]: 
[0m11:05:03.750157 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m11:05:03.751157 [info ] [MainThread]: 
[0m11:05:03.752156 [error] [MainThread]: [31mFailure in test not_null_stg_yellow_tripdata_dropoff_ts (models\staging\stg_yellow_tripdata.yml)[0m
[0m11:05:03.753155 [error] [MainThread]:   Database Error in test not_null_stg_yellow_tripdata_dropoff_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_dropoff_ts.sql
[0m11:05:03.755159 [info ] [MainThread]: 
[0m11:05:03.755159 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_dropoff_ts.sql
[0m11:05:03.756156 [info ] [MainThread]: 
[0m11:05:03.757155 [error] [MainThread]: [31mFailure in test not_null_mart_trip_facts_pu_location_id (models\staging\stg_yellow_tripdata.yml)[0m
[0m11:05:03.758158 [error] [MainThread]:   Database Error in test not_null_mart_trip_facts_pu_location_id (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_pu_location_id.sql
[0m11:05:03.759161 [info ] [MainThread]: 
[0m11:05:03.760561 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_pu_location_id.sql
[0m11:05:03.763082 [info ] [MainThread]: 
[0m11:05:03.766086 [error] [MainThread]: [31mFailure in test not_null_mart_trip_facts_pickup_ts (models\staging\stg_yellow_tripdata.yml)[0m
[0m11:05:03.767083 [error] [MainThread]:   Database Error in test not_null_mart_trip_facts_pickup_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_pickup_ts.sql
[0m11:05:03.771087 [info ] [MainThread]: 
[0m11:05:03.772094 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_pickup_ts.sql
[0m11:05:03.773090 [info ] [MainThread]: 
[0m11:05:03.775092 [error] [MainThread]: [31mFailure in test not_null_mart_trip_facts_do_location_id (models\staging\stg_yellow_tripdata.yml)[0m
[0m11:05:03.778112 [error] [MainThread]:   Database Error in test not_null_mart_trip_facts_do_location_id (models\staging\stg_yellow_tripdata.yml)
  relation "public.mart_trip_facts" does not exist
  LINE 17: from "de_db"."public"."mart_trip_facts"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_do_location_id.sql
[0m11:05:03.779109 [info ] [MainThread]: 
[0m11:05:03.781635 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_mart_trip_facts_do_location_id.sql
[0m11:05:03.782637 [info ] [MainThread]: 
[0m11:05:03.784635 [error] [MainThread]: [31mFailure in test not_null_stg_yellow_tripdata_fare_amount (models\staging\stg_yellow_tripdata.yml)[0m
[0m11:05:03.785636 [error] [MainThread]:   Database Error in test not_null_stg_yellow_tripdata_fare_amount (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_fare_amount.sql
[0m11:05:03.787641 [info ] [MainThread]: 
[0m11:05:03.788634 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_fare_amount.sql
[0m11:05:03.788634 [info ] [MainThread]: 
[0m11:05:03.789633 [error] [MainThread]: [31mFailure in test not_null_stg_yellow_tripdata_pickup_ts (models\staging\stg_yellow_tripdata.yml)[0m
[0m11:05:03.789633 [error] [MainThread]:   Database Error in test not_null_stg_yellow_tripdata_pickup_ts (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_pickup_ts.sql
[0m11:05:03.790728 [info ] [MainThread]: 
[0m11:05:03.792246 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_pickup_ts.sql
[0m11:05:03.793246 [info ] [MainThread]: 
[0m11:05:03.794246 [error] [MainThread]: [31mFailure in test not_null_stg_yellow_tripdata_passenger_count_clean (models\staging\stg_yellow_tripdata.yml)[0m
[0m11:05:03.795243 [error] [MainThread]:   Database Error in test not_null_stg_yellow_tripdata_passenger_count_clean (models\staging\stg_yellow_tripdata.yml)
  relation "public.stg_yellow_tripdata" does not exist
  LINE 17: from "de_db"."public"."stg_yellow_tripdata"
                ^
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_passenger_count_clean.sql
[0m11:05:03.797248 [info ] [MainThread]: 
[0m11:05:03.798244 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\stg_yellow_tripdata.yml\not_null_stg_yellow_tripdata_passenger_count_clean.sql
[0m11:05:03.799247 [info ] [MainThread]: 
[0m11:05:03.800247 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=8 SKIP=0 NO-OP=0 TOTAL=11
[0m11:05:03.801244 [debug] [MainThread]: Command `dbt test` failed at 11:05:03.801244 after 1.98 seconds
[0m11:05:03.801244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A244A8BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2B2A2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A2B0DC750>]}
[0m11:05:03.803253 [debug] [MainThread]: Flushing usage events
[0m11:05:04.143650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:20.318048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B459CA790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B459C9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B459CA510>]}


============================== 11:24:20.324818 | d6e8aaa5-e07a-44cc-adf0-b11dbcf7e9f5 ==============================
[0m11:24:20.324818 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:24:20.325854 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m11:24:20.579617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6e8aaa5-e07a-44cc-adf0-b11dbcf7e9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B46B57650>]}
[0m11:24:20.653047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6e8aaa5-e07a-44cc-adf0-b11dbcf7e9f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B42228310>]}
[0m11:24:20.656051 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:24:20.983110 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:24:21.172375 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m11:24:21.173374 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\sources.yml
[0m11:24:21.174372 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\schema.yml
[0m11:24:21.174372 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\stg_yellow_tripdata.sql
[0m11:24:21.677232 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt.stg_yellow_tripdata' (models\staging\stg_yellow_tripdata.sql) depends on a source named 'raw.yellow_tripdata_raw' which was not found
[0m11:24:21.679234 [debug] [MainThread]: Command `dbt run` failed at 11:24:21.678236 after 1.50 seconds
[0m11:24:21.679234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4725B0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4725B090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B46FBFF50>]}
[0m11:24:21.680234 [debug] [MainThread]: Flushing usage events
[0m11:24:22.098108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:04.017162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE93F41490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9AA82750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9AA81A10>]}


============================== 11:28:04.024791 | e6fd3819-7a85-4235-81a1-df8a2734a511 ==============================
[0m11:28:04.024791 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:28:04.026795 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m11:28:04.294389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9AB8E650>]}
[0m11:28:04.379814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE972B8350>]}
[0m11:28:04.382815 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:28:04.698677 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:28:04.890667 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m11:28:04.891665 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\schema.yml
[0m11:28:04.893668 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\sources.yml
[0m11:28:04.895667 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\stg_yellow_tripdata.sql
[0m11:28:05.825945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9BF0EDD0>]}
[0m11:28:05.911297 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m11:28:05.915300 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m11:28:05.963824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9C3BBE50>]}
[0m11:28:05.966119 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 464 macros
[0m11:28:05.968228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9BECE090>]}
[0m11:28:05.970830 [info ] [MainThread]: 
[0m11:28:05.971344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:28:05.972347 [info ] [MainThread]: 
[0m11:28:05.973345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:28:05.979860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m11:28:06.061394 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m11:28:06.062394 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m11:28:06.063395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:06.082846 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m11:28:06.084406 [debug] [ThreadPool]: On list_de_db: Close
[0m11:28:06.087406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m11:28:06.095688 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m11:28:06.096198 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:28:06.096716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:06.114458 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.018 seconds
[0m11:28:06.117054 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m11:28:06.118642 [debug] [ThreadPool]: On list_de_db_public: Close
[0m11:28:06.137514 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.139513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:28:06.139513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:06.164915 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m11:28:06.166912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE969AC410>]}
[0m11:28:06.168913 [debug] [MainThread]: On master: ROLLBACK
[0m11:28:06.170913 [debug] [MainThread]: On master: COMMIT
[0m11:28:06.171913 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.172919 [debug] [MainThread]: On master: COMMIT
[0m11:28:06.174913 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:28:06.176915 [debug] [MainThread]: On master: Close
[0m11:28:06.184594 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m11:28:06.185105 [debug] [Thread-2 (]: Began running node model.my_dbt.my_first_dbt_model
[0m11:28:06.185623 [debug] [Thread-3 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m11:28:06.185623 [info ] [Thread-1 (]: 1 of 4 START sql table model public.hello ...................................... [RUN]
[0m11:28:06.186614 [info ] [Thread-2 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m11:28:06.187613 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_yellow_tripdata ......................... [RUN]
[0m11:28:06.188617 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m11:28:06.189615 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.my_first_dbt_model'
[0m11:28:06.189615 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m11:28:06.190615 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m11:28:06.191614 [debug] [Thread-2 (]: Began compiling node model.my_dbt.my_first_dbt_model
[0m11:28:06.191614 [debug] [Thread-3 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m11:28:06.200300 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m11:28:06.205297 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.my_first_dbt_model"
[0m11:28:06.210296 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m11:28:06.212299 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m11:28:06.244050 [debug] [Thread-3 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m11:28:06.272142 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m11:28:06.273143 [debug] [Thread-2 (]: Began executing node model.my_dbt.my_first_dbt_model
[0m11:28:06.293847 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m11:28:06.300849 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.my_first_dbt_model"
[0m11:28:06.301847 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:28:06.302846 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m11:28:06.303849 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m11:28:06.304845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:28:06.305848 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:28:06.306845 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  create view "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
    
    
  as (
    

select
    vendorid,
    tpep_pickup_datetime,
    tpep_dropoff_datetime,
    passenger_count,
    trip_distance,
    pulocationid,
    dolocationid,
    payment_type,
    fare_amount,
    tip_amount,
    total_amount
from "de_db"."public"."yellow_tripdata_raw"
where passenger_count is not null
  );
[0m11:28:06.307851 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */

  
    

  create  table "de_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m11:28:06.308292 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:28:06.310016 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:28:06.327461 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 10:     vendorid,
             ^
HINT:  Perhaps you meant to reference the column "yellow_tripdata_raw.VendorID".

[0m11:28:06.328124 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.019 seconds
[0m11:28:06.328646 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m11:28:06.329161 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: ROLLBACK
[0m11:28:06.340894 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:28:06.345895 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:28:06.347355 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:28:06.347898 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m11:28:06.348792 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m11:28:06.352017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:28:06.352529 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:28:06.356824 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:28:06.362249 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:28:06.362762 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m11:28:06.363803 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:28:06.365827 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:28:06.366831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:28:06.390833 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m11:28:06.393829 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m11:28:06.394829 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:28:06.395829 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:28:06.396831 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m11:28:06.396831 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m11:28:06.402781 [debug] [Thread-3 (]: Database Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  column "vendorid" does not exist
  LINE 10:     vendorid,
               ^
  HINT:  Perhaps you meant to reference the column "yellow_tripdata_raw.VendorID".
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.sql
[0m11:28:06.403853 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m11:28:06.404456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m11:28:06.416973 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."my_first_dbt_model__dbt_backup"
[0m11:28:06.421974 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m11:28:06.422973 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9CCB3F10>]}
[0m11:28:06.430092 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m11:28:06.431088 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:28:06.432088 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model public.stg_yellow_tripdata ................ [[31mERROR[0m in 0.22s]
[0m11:28:06.434089 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
drop table if exists "de_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m11:28:06.434089 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m11:28:06.435091 [debug] [Thread-3 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m11:28:06.437088 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.stg_yellow_tripdata' to be skipped because of status 'error'.  Reason: Database Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  column "vendorid" does not exist
  LINE 10:     vendorid,
               ^
  HINT:  Perhaps you meant to reference the column "yellow_tripdata_raw.VendorID".
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.sql.
[0m11:28:06.442007 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m11:28:06.443523 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m11:28:06.446650 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m11:28:06.449652 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: Close
[0m11:28:06.451655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9C4091D0>]}
[0m11:28:06.453657 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9CC96350>]}
[0m11:28:06.454664 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.26s]
[0m11:28:06.457654 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m11:28:06.459653 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m11:28:06.462353 [debug] [Thread-2 (]: Finished running node model.my_dbt.my_first_dbt_model
[0m11:28:06.466102 [debug] [Thread-4 (]: Began running node model.my_dbt.my_second_dbt_model
[0m11:28:06.467101 [info ] [Thread-4 (]: 4 of 4 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m11:28:06.469099 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.my_second_dbt_model'
[0m11:28:06.471103 [debug] [Thread-4 (]: Began compiling node model.my_dbt.my_second_dbt_model
[0m11:28:06.478098 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.my_second_dbt_model"
[0m11:28:06.480111 [debug] [Thread-4 (]: Began executing node model.my_dbt.my_second_dbt_model
[0m11:28:06.489987 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.my_second_dbt_model"
[0m11:28:06.493691 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:28:06.494692 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */

  
    

  create  table "de_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "de_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m11:28:06.495693 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:28:06.519825 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m11:28:06.534205 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:28:06.538205 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:28:06.542208 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:28:06.548205 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:28:06.549207 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:28:06.552205 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:28:06.555204 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m11:28:06.556206 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:28:06.557207 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m11:28:06.563780 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m11:28:06.570137 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."my_second_dbt_model__dbt_backup"
[0m11:28:06.573138 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m11:28:06.575747 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
drop table if exists "de_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m11:28:06.581658 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:28:06.584654 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: Close
[0m11:28:06.585654 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fd3819-7a85-4235-81a1-df8a2734a511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9C8BBC50>]}
[0m11:28:06.586652 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.12s]
[0m11:28:06.587656 [debug] [Thread-4 (]: Finished running node model.my_dbt.my_second_dbt_model
[0m11:28:06.589653 [debug] [MainThread]: On master: COMMIT
[0m11:28:06.590653 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:06.590653 [debug] [MainThread]: On master: COMMIT
[0m11:28:06.591652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:06.609655 [debug] [MainThread]: SQL status: COMMIT in 0.018 seconds
[0m11:28:06.610655 [debug] [MainThread]: On master: Close
[0m11:28:06.611656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:06.613657 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m11:28:06.613657 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m11:28:06.614659 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m11:28:06.615655 [debug] [MainThread]: Connection 'model.my_dbt.my_first_dbt_model' was properly closed.
[0m11:28:06.615655 [debug] [MainThread]: Connection 'model.my_dbt.stg_yellow_tripdata' was properly closed.
[0m11:28:06.616654 [debug] [MainThread]: Connection 'model.my_dbt.my_second_dbt_model' was properly closed.
[0m11:28:06.617656 [info ] [MainThread]: 
[0m11:28:06.618653 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m11:28:06.621653 [debug] [MainThread]: Command end result
[0m11:28:06.660842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m11:28:06.664843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m11:28:06.673843 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m11:28:06.674846 [info ] [MainThread]: 
[0m11:28:06.678709 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:28:06.682274 [info ] [MainThread]: 
[0m11:28:06.685209 [error] [MainThread]: [31mFailure in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)[0m
[0m11:28:06.688227 [error] [MainThread]:   Database Error in model stg_yellow_tripdata (models\staging\stg_yellow_tripdata.sql)
  column "vendorid" does not exist
  LINE 10:     vendorid,
               ^
  HINT:  Perhaps you meant to reference the column "yellow_tripdata_raw.VendorID".
  compiled code at target\run\my_dbt\models\staging\stg_yellow_tripdata.sql
[0m11:28:06.689843 [info ] [MainThread]: 
[0m11:28:06.690956 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\stg_yellow_tripdata.sql
[0m11:28:06.692355 [info ] [MainThread]: 
[0m11:28:06.694356 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m11:28:06.696431 [debug] [MainThread]: Command `dbt run` failed at 11:28:06.695920 after 2.80 seconds
[0m11:28:06.696954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE93C38BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9AA5AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE9CD82750>]}
[0m11:28:06.699465 [debug] [MainThread]: Flushing usage events
[0m11:28:07.083182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:53.541954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC961A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC966AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC966B110>]}


============================== 12:14:53.544953 | 7cde3ab0-1d18-4c29-804a-d3bd3558189a ==============================
[0m12:14:53.544953 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:14:53.545953 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_yellow_tripdata', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:14:53.734372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cde3ab0-1d18-4c29-804a-d3bd3558189a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC9674310>]}
[0m12:14:53.794962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cde3ab0-1d18-4c29-804a-d3bd3558189a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC5E78310>]}
[0m12:14:53.795986 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:14:54.017609 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:14:54.164011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:54.164986 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\stg_yellow_tripdata.sql
[0m12:14:54.583464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cde3ab0-1d18-4c29-804a-d3bd3558189a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DCAB566D0>]}
[0m12:14:54.660546 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:14:54.662547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:14:54.689548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cde3ab0-1d18-4c29-804a-d3bd3558189a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC8DF0550>]}
[0m12:14:54.690548 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 464 macros
[0m12:14:54.691547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cde3ab0-1d18-4c29-804a-d3bd3558189a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DCADDDD90>]}
[0m12:14:54.692574 [info ] [MainThread]: 
[0m12:14:54.693547 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:14:54.693547 [info ] [MainThread]: 
[0m12:14:54.694547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:14:54.695679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m12:14:54.761112 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m12:14:54.762088 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m12:14:54.762088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:54.783930 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m12:14:54.785554 [debug] [ThreadPool]: On list_de_db: Close
[0m12:14:54.789964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:14:54.794915 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:14:54.795939 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:14:54.795939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:54.811646 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.015 seconds
[0m12:14:54.813627 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:14:54.814776 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:14:54.825601 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:54.826177 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:14:54.826691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:54.855205 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m12:14:54.856209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cde3ab0-1d18-4c29-804a-d3bd3558189a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DCB261310>]}
[0m12:14:54.857235 [debug] [MainThread]: On master: ROLLBACK
[0m12:14:54.859205 [debug] [MainThread]: On master: COMMIT
[0m12:14:54.859205 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:54.859205 [debug] [MainThread]: On master: COMMIT
[0m12:14:54.861207 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:14:54.862233 [debug] [MainThread]: On master: Close
[0m12:14:54.866208 [debug] [Thread-1 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m12:14:54.867207 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m12:14:54.868205 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m12:14:54.868205 [debug] [Thread-1 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m12:14:54.877278 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m12:14:54.878356 [debug] [Thread-1 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m12:14:54.911711 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m12:14:54.913709 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:14:54.913709 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m12:14:54.914709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:06.247577 [debug] [Thread-1 (]: SQL status: SELECT 3475226 in 11.333 seconds
[0m12:15:06.257313 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:15:06.257313 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m12:15:06.259307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:15:06.271281 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m12:15:06.271281 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:15:06.272281 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m12:15:06.302867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m12:15:06.308428 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m12:15:06.312429 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:15:06.313409 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m12:15:06.317029 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m12:15:06.319891 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m12:15:06.322191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cde3ab0-1d18-4c29-804a-d3bd3558189a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DCB1C0DD0>]}
[0m12:15:06.322940 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 11.45s]
[0m12:15:06.324250 [debug] [Thread-1 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m12:15:06.325360 [debug] [MainThread]: On master: COMMIT
[0m12:15:06.326095 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:06.326095 [debug] [MainThread]: On master: COMMIT
[0m12:15:06.326610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:06.339897 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m12:15:06.340552 [debug] [MainThread]: On master: Close
[0m12:15:06.340917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:06.341469 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m12:15:06.341469 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:15:06.342019 [debug] [MainThread]: Connection 'model.my_dbt.stg_yellow_tripdata' was properly closed.
[0m12:15:06.342565 [info ] [MainThread]: 
[0m12:15:06.343115 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.65 seconds (11.65s).
[0m12:15:06.343658 [debug] [MainThread]: Command end result
[0m12:15:06.366352 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:15:06.368363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:15:06.373352 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:15:06.373352 [info ] [MainThread]: 
[0m12:15:06.374352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:06.375352 [info ] [MainThread]: 
[0m12:15:06.375352 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:15:06.376352 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:06.376352 after 12.92 seconds
[0m12:15:06.376352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC966BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC879A810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC2B60950>]}
[0m12:15:06.377352 [debug] [MainThread]: Flushing usage events
[0m12:15:06.735653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:27.605772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EFC5A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EFC52E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EFC5A9D0>]}


============================== 12:18:27.609801 | 9c0eb875-0531-4fdf-abba-1f5f1331d127 ==============================
[0m12:18:27.609801 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:18:27.610937 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:18:27.784902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1F0E3E250>]}
[0m12:18:27.841929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EC4B8550>]}
[0m12:18:27.843905 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:18:28.072112 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:18:28.205917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:28.205917 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:18:28.206915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:28.247212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EFD9FA50>]}
[0m12:18:28.324918 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:18:28.327516 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:18:28.353412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1F0E19590>]}
[0m12:18:28.353412 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 464 macros
[0m12:18:28.354413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1F1345D50>]}
[0m12:18:28.356438 [info ] [MainThread]: 
[0m12:18:28.356438 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:28.357523 [info ] [MainThread]: 
[0m12:18:28.358035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:28.362061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m12:18:28.475575 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m12:18:28.476588 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m12:18:28.476588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:28.493743 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m12:18:28.494743 [debug] [ThreadPool]: On list_de_db: Close
[0m12:18:28.496769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:18:28.502456 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:18:28.503418 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:18:28.503418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:28.541628 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.037 seconds
[0m12:18:28.543621 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:18:28.545595 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:18:28.555348 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:28.556341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:18:28.556341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:28.588347 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m12:18:28.589625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EFC67350>]}
[0m12:18:28.590440 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:28.591521 [debug] [MainThread]: On master: COMMIT
[0m12:18:28.592091 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:28.592605 [debug] [MainThread]: On master: COMMIT
[0m12:18:28.594367 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:18:28.594935 [debug] [MainThread]: On master: Close
[0m12:18:28.599944 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m12:18:28.600455 [debug] [Thread-2 (]: Began running node model.my_dbt.my_first_dbt_model
[0m12:18:28.600495 [debug] [Thread-3 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m12:18:28.601246 [info ] [Thread-1 (]: 1 of 4 START sql table model public.hello ...................................... [RUN]
[0m12:18:28.601789 [info ] [Thread-2 (]: 2 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m12:18:28.602518 [info ] [Thread-3 (]: 3 of 4 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m12:18:28.603195 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m12:18:28.604525 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.my_first_dbt_model'
[0m12:18:28.604747 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m12:18:28.605406 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m12:18:28.605922 [debug] [Thread-2 (]: Began compiling node model.my_dbt.my_first_dbt_model
[0m12:18:28.606486 [debug] [Thread-3 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m12:18:28.613383 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m12:18:28.616632 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.my_first_dbt_model"
[0m12:18:28.619143 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m12:18:28.620142 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m12:18:28.658230 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m12:18:28.659205 [debug] [Thread-2 (]: Began executing node model.my_dbt.my_first_dbt_model
[0m12:18:28.659205 [debug] [Thread-3 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m12:18:28.663233 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.my_first_dbt_model"
[0m12:18:28.664204 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m12:18:28.667958 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m12:18:28.667958 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m12:18:28.668961 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m12:18:28.668961 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:18:28.669932 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */

  
    

  create  table "de_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:18:28.669932 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:18:28.670961 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:28.671701 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m12:18:28.672530 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:18:28.709770 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.039 seconds
[0m12:18:28.711772 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.042 seconds
[0m12:18:28.722457 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m12:18:28.727102 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m12:18:28.727102 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:18:28.728107 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m12:18:28.730291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:18:28.730853 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:18:28.734127 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m12:18:28.736895 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m12:18:28.737439 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m12:18:28.737985 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
alter table "de_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:18:28.740172 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:18:28.740692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:18:28.756330 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m12:18:28.758193 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m12:18:28.759220 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m12:18:28.759220 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m12:18:28.760190 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: COMMIT
[0m12:18:28.760190 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m12:18:28.815065 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m12:18:28.815676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.054 seconds
[0m12:18:28.822633 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."my_first_dbt_model__dbt_backup"
[0m12:18:28.825138 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m12:18:28.831138 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.my_first_dbt_model"
[0m12:18:28.832138 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m12:18:28.832138 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_first_dbt_model"} */
drop table if exists "de_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m12:18:28.833140 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m12:18:28.859225 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.025 seconds
[0m12:18:28.859736 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.026 seconds
[0m12:18:28.863613 [debug] [Thread-2 (]: On model.my_dbt.my_first_dbt_model: Close
[0m12:18:28.865813 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m12:18:28.869257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1F1704F10>]}
[0m12:18:28.870301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1F17BFE50>]}
[0m12:18:28.871394 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m12:18:28.874151 [debug] [Thread-2 (]: Finished running node model.my_dbt.my_first_dbt_model
[0m12:18:28.873093 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.27s]
[0m12:18:28.875186 [debug] [Thread-4 (]: Began running node model.my_dbt.my_second_dbt_model
[0m12:18:28.876260 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m12:18:28.876811 [info ] [Thread-4 (]: 4 of 4 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m12:18:28.878946 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.my_second_dbt_model'
[0m12:18:28.879513 [debug] [Thread-4 (]: Began compiling node model.my_dbt.my_second_dbt_model
[0m12:18:28.885522 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.my_second_dbt_model"
[0m12:18:28.887626 [debug] [Thread-4 (]: Began executing node model.my_dbt.my_second_dbt_model
[0m12:18:28.894531 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.my_second_dbt_model"
[0m12:18:28.896148 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m12:18:28.897211 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */

  
    

  create  table "de_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "de_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m12:18:28.898432 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:18:28.941390 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.043 seconds
[0m12:18:28.945391 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m12:18:28.946391 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:18:28.947392 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:18:28.951389 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m12:18:28.951389 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
alter table "de_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:18:28.954395 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:18:28.957399 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m12:18:28.957399 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m12:18:28.958397 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: COMMIT
[0m12:18:28.988639 [debug] [Thread-4 (]: SQL status: COMMIT in 0.029 seconds
[0m12:18:28.992636 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."my_second_dbt_model__dbt_backup"
[0m12:18:28.994643 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.my_second_dbt_model"
[0m12:18:28.994643 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.my_second_dbt_model"} */
drop table if exists "de_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m12:18:29.008729 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m12:18:29.009807 [debug] [Thread-4 (]: On model.my_dbt.my_second_dbt_model: Close
[0m12:18:29.010908 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1F1704B90>]}
[0m12:18:29.011453 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.13s]
[0m12:18:29.012567 [debug] [Thread-4 (]: Finished running node model.my_dbt.my_second_dbt_model
[0m12:18:36.756819 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 8.084 seconds
[0m12:18:36.760819 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:18:36.760819 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m12:18:36.829187 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.067 seconds
[0m12:18:36.832347 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:18:36.832896 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m12:18:36.835378 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:18:36.836981 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m12:18:36.837543 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:18:36.837543 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m12:18:39.610646 [debug] [Thread-3 (]: SQL status: COMMIT in 2.773 seconds
[0m12:18:39.614250 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m12:18:39.615010 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m12:18:39.615521 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m12:18:39.685732 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.070 seconds
[0m12:18:39.687315 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m12:18:39.687858 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c0eb875-0531-4fdf-abba-1f5f1331d127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1F0E3D610>]}
[0m12:18:39.688369 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 11.08s]
[0m12:18:39.689438 [debug] [Thread-3 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m12:18:39.691149 [debug] [MainThread]: On master: COMMIT
[0m12:18:39.691686 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:39.692228 [debug] [MainThread]: On master: COMMIT
[0m12:18:39.692228 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:39.717967 [debug] [MainThread]: SQL status: COMMIT in 0.025 seconds
[0m12:18:39.718745 [debug] [MainThread]: On master: Close
[0m12:18:39.719256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:39.719307 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m12:18:39.719861 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:18:39.720410 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m12:18:39.720410 [debug] [MainThread]: Connection 'model.my_dbt.my_first_dbt_model' was properly closed.
[0m12:18:39.720950 [debug] [MainThread]: Connection 'model.my_dbt.stg_yellow_tripdata' was properly closed.
[0m12:18:39.721648 [debug] [MainThread]: Connection 'model.my_dbt.my_second_dbt_model' was properly closed.
[0m12:18:39.722208 [info ] [MainThread]: 
[0m12:18:39.722208 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.36 seconds (11.36s).
[0m12:18:39.724186 [debug] [MainThread]: Command end result
[0m12:18:39.747079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:18:39.748967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:18:39.754834 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:18:39.755965 [info ] [MainThread]: 
[0m12:18:39.755965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:39.756965 [info ] [MainThread]: 
[0m12:18:39.757964 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:18:39.758965 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:39.758965 after 12.22 seconds
[0m12:18:39.758965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EFC5A9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1E8E68BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1EEDDA510>]}
[0m12:18:39.759964 [debug] [MainThread]: Flushing usage events
[0m12:18:40.071177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:56.670443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022594A2E010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022595D7A0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022595D7A150>]}


============================== 12:32:56.673443 | d24fda3a-6933-4aea-9452-b686e6926afd ==============================
[0m12:32:56.673443 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:32:56.674432 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:32:56.860513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd24fda3a-6933-4aea-9452-b686e6926afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022594EEA950>]}
[0m12:32:56.917103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd24fda3a-6933-4aea-9452-b686e6926afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225925C8450>]}
[0m12:32:56.918076 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:32:57.147028 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:32:57.268964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:57.268964 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:32:57.268964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:57.310208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd24fda3a-6933-4aea-9452-b686e6926afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022597326D10>]}
[0m12:32:57.386852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:32:57.389853 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:32:57.422193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd24fda3a-6933-4aea-9452-b686e6926afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022597580410>]}
[0m12:32:57.423192 [info ] [MainThread]: Found 6 models, 8 data tests, 1 source, 464 macros
[0m12:32:57.423192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd24fda3a-6933-4aea-9452-b686e6926afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225972D8890>]}
[0m12:32:57.426892 [info ] [MainThread]: 
[0m12:32:57.426892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:32:57.427891 [info ] [MainThread]: 
[0m12:32:57.428890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:32:57.432889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:32:57.550462 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:32:57.550462 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:32:57.551463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:57.570466 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.019 seconds
[0m12:32:57.572466 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:32:57.573840 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:32:57.583399 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:57.584619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:32:57.585379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:57.602825 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m12:32:57.603943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd24fda3a-6933-4aea-9452-b686e6926afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225971BF150>]}
[0m12:32:57.604966 [debug] [MainThread]: On master: ROLLBACK
[0m12:32:57.606345 [debug] [MainThread]: On master: COMMIT
[0m12:32:57.606927 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:57.606927 [debug] [MainThread]: On master: COMMIT
[0m12:32:57.609207 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:32:57.610026 [debug] [MainThread]: On master: Close
[0m12:32:57.616192 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:32:57.616809 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:32:57.616908 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m12:32:57.617462 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9
[0m12:32:57.618080 [info ] [Thread-1 (]: 1 of 8 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m12:32:57.618689 [info ] [Thread-2 (]: 2 of 8 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m12:32:57.619198 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m12:32:57.619564 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_yellow_tripdata_passenger_count ................. [RUN]
[0m12:32:57.620687 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m12:32:57.622314 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m12:32:57.623000 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001'
[0m12:32:57.623594 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9'
[0m12:32:57.624099 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:32:57.624153 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:32:57.625215 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m12:32:57.625725 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9
[0m12:32:57.640751 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:32:57.644455 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m12:32:57.648184 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m12:32:57.651184 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9"
[0m12:32:57.652158 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:32:57.654158 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:32:57.669906 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:32:57.672878 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m12:32:57.672878 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m12:32:57.674002 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9
[0m12:32:57.676514 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m12:32:57.678540 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9"
[0m12:32:57.679539 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:32:57.679539 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m12:32:57.680514 [debug] [Thread-1 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "de_db"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:32:57.681514 [debug] [Thread-2 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "de_db"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:32:57.681514 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m12:32:57.682514 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9"
[0m12:32:57.682514 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:57.683542 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:32:57.683542 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m12:32:57.684544 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select passenger_count
from "de_db"."public"."stg_yellow_tripdata"
where passenger_count is null



  
  
      
    ) dbt_internal_test
[0m12:32:57.685434 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:32:57.685946 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:32:57.720430 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.037 seconds
[0m12:32:57.722083 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.039 seconds
[0m12:32:57.731081 [debug] [Thread-2 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m12:32:57.736084 [debug] [Thread-1 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m12:32:57.746217 [debug] [Thread-2 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m12:32:57.747216 [debug] [Thread-1 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m12:32:57.749602 [info ] [Thread-2 (]: 2 of 8 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.13s]
[0m12:32:57.750801 [error] [Thread-1 (]: 1 of 8 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.13s]
[0m12:32:57.752048 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m12:32:57.753100 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:32:57.754263 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m12:32:57.755293 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m12:32:57.755815 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m12:32:57.756842 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m12:32:57.757369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44)
[0m12:32:57.758395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786)
[0m12:32:57.760399 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m12:32:57.760399 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m12:32:57.777479 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m12:32:57.787058 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m12:32:57.793052 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m12:32:57.797048 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m12:32:57.800056 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m12:32:57.805049 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m12:32:57.808052 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m12:32:57.810054 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m12:32:57.811048 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m12:32:57.817050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:57.818052 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m12:32:57.820050 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:32:57.899036 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.214 seconds
[0m12:32:57.901627 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m12:32:57.904238 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m12:32:57.905842 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 0.28s]
[0m12:32:57.907412 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m12:32:57.907931 [debug] [Thread-3 (]: Began running node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:32:57.908975 [info ] [Thread-3 (]: 7 of 8 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m12:32:57.910120 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001, now test.my_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m12:32:57.911126 [debug] [Thread-3 (]: Began compiling node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:32:57.923126 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:32:57.925128 [debug] [Thread-3 (]: Began executing node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:32:57.930172 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:32:57.932173 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m12:32:57.942177 [debug] [Thread-3 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "de_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:32:57.943180 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:32:57.982976 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.297 seconds
[0m12:32:57.985822 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9: ROLLBACK
[0m12:32:58.017234 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9: Close
[0m12:32:58.018647 [error] [Thread-4 (]: 4 of 8 FAIL 540149 not_null_stg_yellow_tripdata_passenger_count ................ [[31mFAIL 540149[0m in 0.40s]
[0m12:32:58.020258 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9
[0m12:32:58.020785 [debug] [Thread-4 (]: Began running node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:32:58.021822 [info ] [Thread-4 (]: 8 of 8 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m12:32:58.023831 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_stg_yellow_tripdata_passenger_count.6ded6df0d9, now test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m12:32:58.025391 [debug] [Thread-4 (]: Began compiling node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:32:58.036144 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:32:58.038251 [debug] [Thread-4 (]: Began executing node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:32:58.042829 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:32:58.044929 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:32:58.046014 [debug] [Thread-4 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "de_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:32:58.046534 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:32:58.055937 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.113 seconds
[0m12:32:58.061934 [debug] [Thread-3 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m12:32:58.072347 [debug] [Thread-3 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m12:32:58.074348 [info ] [Thread-3 (]: 7 of 8 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.16s]
[0m12:32:58.075351 [debug] [Thread-3 (]: Finished running node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m12:32:58.084356 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.037 seconds
[0m12:32:58.087356 [debug] [Thread-4 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m12:32:58.089348 [debug] [Thread-4 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m12:32:58.090348 [info ] [Thread-4 (]: 8 of 8 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
[0m12:32:58.092349 [debug] [Thread-4 (]: Finished running node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m12:32:58.127966 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.307 seconds
[0m12:32:58.130972 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m12:32:58.133972 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m12:32:58.135975 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.38s]
[0m12:32:58.138968 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m12:32:58.154144 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.337 seconds
[0m12:32:58.155767 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m12:32:58.156884 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m12:32:58.157398 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 0.40s]
[0m12:32:58.157907 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m12:32:58.159459 [debug] [MainThread]: On master: COMMIT
[0m12:32:58.159975 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:58.160486 [debug] [MainThread]: On master: COMMIT
[0m12:32:58.160486 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:32:58.173726 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m12:32:58.174239 [debug] [MainThread]: On master: Close
[0m12:32:58.174754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:58.175272 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:32:58.176299 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m12:32:58.176956 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m12:32:58.177472 [debug] [MainThread]: Connection 'test.my_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m12:32:58.177988 [debug] [MainThread]: Connection 'test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m12:32:58.177988 [info ] [MainThread]: 
[0m12:32:58.178503 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:32:58.180564 [debug] [MainThread]: Command end result
[0m12:32:58.205075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:32:58.208095 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:32:58.214099 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:32:58.214099 [info ] [MainThread]: 
[0m12:32:58.215715 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:32:58.215715 [info ] [MainThread]: 
[0m12:32:58.216736 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m12:32:58.216736 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:32:58.217735 [info ] [MainThread]: 
[0m12:32:58.217735 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m12:32:58.218735 [info ] [MainThread]: 
[0m12:32:58.218735 [error] [MainThread]: [31mFailure in test not_null_stg_yellow_tripdata_passenger_count (models\staging\schema.yml)[0m
[0m12:32:58.219739 [error] [MainThread]:   Got 540149 results, configured to fail if != 0
[0m12:32:58.219739 [info ] [MainThread]: 
[0m12:32:58.220739 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\staging\schema.yml\not_null_stg_yellow_tripdata_passenger_count.sql
[0m12:32:58.220739 [info ] [MainThread]: 
[0m12:32:58.221738 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=8
[0m12:32:58.222741 [debug] [MainThread]: Command `dbt test` failed at 12:32:58.222741 after 1.62 seconds
[0m12:32:58.222741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258EF68BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022595DA5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022595DBCE50>]}
[0m12:32:58.223740 [debug] [MainThread]: Flushing usage events
[0m12:32:58.538476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:14.387788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AE07A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AD15FE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AE078D10>]}


============================== 13:27:14.396791 | aba26358-c6fb-45b0-ad5f-3bc57a7645b5 ==============================
[0m13:27:14.396791 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:27:14.398790 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m13:27:14.582884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba26358-c6fb-45b0-ad5f-3bc57a7645b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AF25A490>]}
[0m13:27:14.642114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aba26358-c6fb-45b0-ad5f-3bc57a7645b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AA8DC290>]}
[0m13:27:14.644114 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:27:14.889280 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:27:15.103904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:15.104904 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\schema.yml
[0m13:27:15.595792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba26358-c6fb-45b0-ad5f-3bc57a7645b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AAB6BCD0>]}
[0m13:27:15.678356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m13:27:15.681057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m13:27:15.718732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aba26358-c6fb-45b0-ad5f-3bc57a7645b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AFAAD690>]}
[0m13:27:15.719853 [info ] [MainThread]: Found 6 models, 7 data tests, 1 source, 464 macros
[0m13:27:15.721502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba26358-c6fb-45b0-ad5f-3bc57a7645b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AF79CF50>]}
[0m13:27:15.726250 [info ] [MainThread]: 
[0m13:27:15.728394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:15.729554 [info ] [MainThread]: 
[0m13:27:15.731281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:27:15.737800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m13:27:15.806415 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m13:27:15.807414 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:27:15.808414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:15.851780 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.044 seconds
[0m13:27:15.854285 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m13:27:15.856530 [debug] [ThreadPool]: On list_de_db_public: Close
[0m13:27:15.867794 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:15.868346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:27:15.869123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:15.897057 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m13:27:15.897596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba26358-c6fb-45b0-ad5f-3bc57a7645b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AF79B110>]}
[0m13:27:15.898565 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:15.900597 [debug] [MainThread]: On master: COMMIT
[0m13:27:15.900597 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:15.901565 [debug] [MainThread]: On master: COMMIT
[0m13:27:15.903566 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:27:15.904092 [debug] [MainThread]: On master: Close
[0m13:27:15.909219 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:27:15.909781 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:27:15.909818 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m13:27:15.910373 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m13:27:15.910920 [info ] [Thread-1 (]: 1 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m13:27:15.911868 [info ] [Thread-2 (]: 2 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m13:27:15.912485 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m13:27:15.914229 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:27:15.913085 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m13:27:15.915413 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m13:27:15.916482 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001'
[0m13:27:15.917531 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:27:15.918532 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m13:27:15.919528 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:27:15.920533 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m13:27:15.938268 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:27:15.939268 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m13:27:15.944268 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:27:15.949266 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m13:27:15.954269 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m13:27:15.955268 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:27:15.956268 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:27:15.957266 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m13:27:15.988429 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:27:15.989429 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m13:27:15.993429 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:27:15.998429 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m13:27:16.002427 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m13:27:16.004430 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:27:16.006430 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m13:27:16.007428 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:27:16.008428 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m13:27:16.008428 [debug] [Thread-1 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "de_db"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:27:16.010429 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m13:27:16.010429 [debug] [Thread-2 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "de_db"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:27:16.012430 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m13:27:16.013430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:16.014429 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:27:16.014429 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:16.015431 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:27:16.034428 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m13:27:16.042897 [debug] [Thread-1 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:27:16.043894 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.029 seconds
[0m13:27:16.050118 [debug] [Thread-2 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:27:16.056132 [debug] [Thread-1 (]: On test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:27:16.059118 [error] [Thread-1 (]: 1 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.15s]
[0m13:27:16.066115 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:27:16.067117 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m13:27:16.068796 [debug] [Thread-2 (]: On test.my_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:27:16.068278 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m13:27:16.069793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786)
[0m13:27:16.073438 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m13:27:16.081522 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m13:27:16.072390 [info ] [Thread-2 (]: 2 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.16s]
[0m13:27:16.083582 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:27:16.084099 [debug] [Thread-2 (]: Began running node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:27:16.085100 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m13:27:16.091102 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m13:27:16.086101 [info ] [Thread-2 (]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m13:27:16.093104 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m13:27:16.095103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m13:27:16.099100 [debug] [Thread-2 (]: Began compiling node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:27:16.097102 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m13:27:16.112917 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:27:16.113915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:16.116917 [debug] [Thread-2 (]: Began executing node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:27:16.124042 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:27:16.126799 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:27:16.127453 [debug] [Thread-2 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "de_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:27:16.128559 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:16.171975 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.043 seconds
[0m13:27:16.174540 [debug] [Thread-2 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:27:16.177534 [debug] [Thread-2 (]: On test.my_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:27:16.179536 [info ] [Thread-2 (]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.09s]
[0m13:27:16.181532 [debug] [Thread-2 (]: Finished running node test.my_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:27:16.182535 [debug] [Thread-2 (]: Began running node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:27:16.183533 [info ] [Thread-2 (]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m13:27:16.185540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt.unique_my_first_dbt_model_id.16e066b321, now test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:27:16.187534 [debug] [Thread-2 (]: Began compiling node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:27:16.196533 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:27:16.197533 [debug] [Thread-2 (]: Began executing node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:27:16.202539 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:27:16.204543 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:27:16.205540 [debug] [Thread-2 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "de_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:27:16.207057 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:16.262289 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.056 seconds
[0m13:27:16.265295 [debug] [Thread-2 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:27:16.270287 [debug] [Thread-2 (]: On test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:27:16.272231 [info ] [Thread-2 (]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.09s]
[0m13:27:16.275229 [debug] [Thread-2 (]: Finished running node test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:27:16.531539 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.515 seconds
[0m13:27:16.534270 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m13:27:16.535849 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.522 seconds
[0m13:27:16.536360 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m13:27:16.538849 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m13:27:16.541037 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.62s]
[0m13:27:16.544836 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m13:27:16.546257 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m13:27:16.547870 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 0.63s]
[0m13:27:16.549847 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m13:27:16.592438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.478 seconds
[0m13:27:16.595442 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m13:27:16.597438 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m13:27:16.599437 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 0.53s]
[0m13:27:16.601438 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m13:27:16.604436 [debug] [MainThread]: On master: COMMIT
[0m13:27:16.605440 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:16.606438 [debug] [MainThread]: On master: COMMIT
[0m13:27:16.607440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:16.623437 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m13:27:16.624442 [debug] [MainThread]: On master: Close
[0m13:27:16.625440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:16.627437 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m13:27:16.627437 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m13:27:16.628439 [debug] [MainThread]: Connection 'test.my_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:27:16.629441 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m13:27:16.629441 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m13:27:16.630442 [info ] [MainThread]: 
[0m13:27:16.631437 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m13:27:16.634441 [debug] [MainThread]: Command end result
[0m13:27:16.667437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m13:27:16.670435 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m13:27:16.680437 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m13:27:16.680437 [info ] [MainThread]: 
[0m13:27:16.682437 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:27:16.683440 [info ] [MainThread]: 
[0m13:27:16.685442 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:27:16.686437 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:27:16.687438 [info ] [MainThread]: 
[0m13:27:16.687438 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:27:16.688436 [info ] [MainThread]: 
[0m13:27:16.689439 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m13:27:16.691436 [debug] [MainThread]: Command `dbt test` failed at 13:27:16.690437 after 2.40 seconds
[0m13:27:16.691436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AE078D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AE07AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210ADD7A350>]}
[0m13:27:16.692434 [debug] [MainThread]: Flushing usage events
[0m13:27:17.062673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:27.633885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EF712C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EF73A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EF73B150>]}


============================== 21:52:27.638886 | 699785d2-1932-4e9a-8b5b-2d8043b3ed8a ==============================
[0m21:52:27.638886 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:52:27.639859 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m21:52:27.869474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '699785d2-1932-4e9a-8b5b-2d8043b3ed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EF727150>]}
[0m21:52:27.945018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '699785d2-1932-4e9a-8b5b-2d8043b3ed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EBF78610>]}
[0m21:52:27.947024 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:52:28.206346 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:52:28.366944 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m21:52:28.367944 [debug] [MainThread]: Partial parsing: deleted file: my_dbt://models\example\my_second_dbt_model.sql
[0m21:52:28.368947 [debug] [MainThread]: Partial parsing: deleted file: my_dbt://models\example\my_first_dbt_model.sql
[0m21:52:28.456920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '699785d2-1932-4e9a-8b5b-2d8043b3ed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F0901950>]}
[0m21:52:28.540664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m21:52:28.542663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m21:52:28.573831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '699785d2-1932-4e9a-8b5b-2d8043b3ed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F0EADFD0>]}
[0m21:52:28.574833 [info ] [MainThread]: Found 4 models, 3 data tests, 1 source, 464 macros
[0m21:52:28.575837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699785d2-1932-4e9a-8b5b-2d8043b3ed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F0E876D0>]}
[0m21:52:28.577833 [info ] [MainThread]: 
[0m21:52:28.578832 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:52:28.578832 [info ] [MainThread]: 
[0m21:52:28.579834 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:52:28.584832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m21:52:28.742163 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m21:52:28.743162 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m21:52:28.744161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:28.763847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m21:52:28.765624 [debug] [ThreadPool]: On list_de_db: Close
[0m21:52:28.767749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m21:52:28.775191 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m21:52:28.776359 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:52:28.776359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:28.805145 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.028 seconds
[0m21:52:28.807748 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m21:52:28.809617 [debug] [ThreadPool]: On list_de_db_public: Close
[0m21:52:28.820502 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:28.821527 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:52:28.821527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:28.851354 [debug] [MainThread]: SQL status: SELECT 0 in 0.029 seconds
[0m21:52:28.852956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '699785d2-1932-4e9a-8b5b-2d8043b3ed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EF76AB50>]}
[0m21:52:28.854015 [debug] [MainThread]: On master: ROLLBACK
[0m21:52:28.855215 [debug] [MainThread]: On master: COMMIT
[0m21:52:28.855787 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:28.856601 [debug] [MainThread]: On master: COMMIT
[0m21:52:28.859082 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m21:52:28.859616 [debug] [MainThread]: On master: Close
[0m21:52:28.866234 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m21:52:28.866785 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m21:52:28.867335 [info ] [Thread-1 (]: 1 of 2 START sql table model public.hello ...................................... [RUN]
[0m21:52:28.869012 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m21:52:28.867905 [info ] [Thread-2 (]: 2 of 2 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m21:52:28.869564 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m21:52:28.870075 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m21:52:28.877075 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m21:52:28.878077 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m21:52:28.881840 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m21:52:28.882837 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m21:52:28.919310 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m21:52:28.920313 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m21:52:28.925310 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m21:52:28.926312 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m21:52:28.927311 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m21:52:28.928313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:52:28.928313 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:52:28.929338 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m21:52:28.930228 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:52:28.957988 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m21:52:28.969661 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m21:52:28.970660 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m21:52:28.973643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:52:28.980575 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m21:52:28.981615 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m21:52:28.983803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:52:29.002565 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m21:52:29.002565 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m21:52:29.003569 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m21:52:29.021784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m21:52:29.029375 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m21:52:29.033879 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m21:52:29.034878 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m21:52:29.062356 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.027 seconds
[0m21:52:29.066192 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m21:52:29.070039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699785d2-1932-4e9a-8b5b-2d8043b3ed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F11830D0>]}
[0m21:52:29.072391 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.20s]
[0m21:52:29.073389 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m21:52:45.080198 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 16.149 seconds
[0m21:52:45.084709 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:52:45.084709 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m21:52:45.088045 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:52:45.092464 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:52:45.092974 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m21:52:45.095137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:52:45.096779 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m21:52:45.097925 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:52:45.098528 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m21:52:45.143739 [debug] [Thread-2 (]: SQL status: COMMIT in 0.045 seconds
[0m21:52:45.146250 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m21:52:45.147249 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:52:45.148250 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m21:52:45.354627 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.206 seconds
[0m21:52:45.356182 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m21:52:45.357228 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '699785d2-1932-4e9a-8b5b-2d8043b3ed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F1180150>]}
[0m21:52:45.358859 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 16.49s]
[0m21:52:45.359925 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m21:52:45.361521 [debug] [MainThread]: On master: COMMIT
[0m21:52:45.362045 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:45.362045 [debug] [MainThread]: On master: COMMIT
[0m21:52:45.362592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:52:45.377557 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m21:52:45.378557 [debug] [MainThread]: On master: Close
[0m21:52:45.378557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:45.379559 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m21:52:45.379559 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m21:52:45.380562 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m21:52:45.380562 [debug] [MainThread]: Connection 'model.my_dbt.stg_yellow_tripdata' was properly closed.
[0m21:52:45.381564 [info ] [MainThread]: 
[0m21:52:45.382558 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 16.80 seconds (16.80s).
[0m21:52:45.383557 [debug] [MainThread]: Command end result
[0m21:52:45.410076 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m21:52:45.413079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m21:52:45.420078 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m21:52:45.421078 [info ] [MainThread]: 
[0m21:52:45.421078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:52:45.422081 [info ] [MainThread]: 
[0m21:52:45.423075 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:52:45.424076 [debug] [MainThread]: Command `dbt run` succeeded at 21:52:45.423075 after 17.88 seconds
[0m21:52:45.425077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E88B8BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EF775690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EF7770D0>]}
[0m21:52:45.425077 [debug] [MainThread]: Flushing usage events
[0m21:52:45.860476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:53.241410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611055B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016110552690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611055BD10>]}


============================== 21:52:53.246410 | 271cb167-f0ae-4dc7-8643-960a76637351 ==============================
[0m21:52:53.246410 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:52:53.247412 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m21:52:53.455570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '271cb167-f0ae-4dc7-8643-960a76637351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161116EB690>]}
[0m21:52:53.519791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '271cb167-f0ae-4dc7-8643-960a76637351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610CDB8510>]}
[0m21:52:53.520816 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:52:53.769144 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:52:53.922443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:52:53.922443 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:52:53.923443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:52:53.969339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '271cb167-f0ae-4dc7-8643-960a76637351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611055A490>]}
[0m21:52:54.056950 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m21:52:54.060949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m21:52:54.113943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '271cb167-f0ae-4dc7-8643-960a76637351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016111DD3E90>]}
[0m21:52:54.114946 [info ] [MainThread]: Found 4 models, 3 data tests, 1 source, 464 macros
[0m21:52:54.115943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '271cb167-f0ae-4dc7-8643-960a76637351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161119C41D0>]}
[0m21:52:54.118943 [info ] [MainThread]: 
[0m21:52:54.119944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:52:54.120942 [info ] [MainThread]: 
[0m21:52:54.120942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:52:54.127454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m21:52:54.300534 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m21:52:54.300534 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:52:54.301536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:54.321536 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.020 seconds
[0m21:52:54.323534 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m21:52:54.325536 [debug] [ThreadPool]: On list_de_db_public: Close
[0m21:52:54.338535 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:54.338535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:52:54.339536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:54.370535 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m21:52:54.372534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '271cb167-f0ae-4dc7-8643-960a76637351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610F0C8D50>]}
[0m21:52:54.372534 [debug] [MainThread]: On master: ROLLBACK
[0m21:52:54.374535 [debug] [MainThread]: On master: COMMIT
[0m21:52:54.375537 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:54.375537 [debug] [MainThread]: On master: COMMIT
[0m21:52:54.377534 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:52:54.378534 [debug] [MainThread]: On master: Close
[0m21:52:54.383749 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:52:54.384278 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:52:54.384793 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:52:54.385307 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m21:52:54.386219 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m21:52:54.387871 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001'
[0m21:52:54.386825 [info ] [Thread-3 (]: 3 of 3 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m21:52:54.388455 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m21:52:54.388984 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:52:54.390039 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786'
[0m21:52:54.390578 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:52:54.406998 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:52:54.408036 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:52:54.412030 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:52:54.418030 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:52:54.420000 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:52:54.421000 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:52:54.438709 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:52:54.441708 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:52:54.441708 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:52:54.442710 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:52:54.445848 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:52:54.446362 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:52:54.447363 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:52:54.448362 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:52:54.448362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:52:54.449361 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:52:54.449361 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:52:54.450361 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:52:54.451708 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:52:55.157389 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.706 seconds
[0m21:52:55.158391 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.709 seconds
[0m21:52:55.162389 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m21:52:55.162389 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.713 seconds
[0m21:52:55.164391 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m21:52:55.166388 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m21:52:55.166388 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m21:52:55.168389 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m21:52:55.168389 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m21:52:55.167388 [info ] [Thread-3 (]: 3 of 3 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 0.78s]
[0m21:52:55.169390 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 0.78s]
[0m21:52:55.171390 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:52:55.170391 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.78s]
[0m21:52:55.172392 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:52:55.173389 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:52:55.175388 [debug] [MainThread]: On master: COMMIT
[0m21:52:55.176390 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:55.176390 [debug] [MainThread]: On master: COMMIT
[0m21:52:55.177389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:52:55.189388 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m21:52:55.190388 [debug] [MainThread]: On master: Close
[0m21:52:55.191391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:55.192392 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m21:52:55.192392 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m21:52:55.193391 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m21:52:55.193391 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m21:52:55.194393 [info ] [MainThread]: 
[0m21:52:55.195391 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m21:52:55.196388 [debug] [MainThread]: Command end result
[0m21:52:55.219555 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m21:52:55.222066 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m21:52:55.228065 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m21:52:55.229065 [info ] [MainThread]: 
[0m21:52:55.229065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:52:55.230065 [info ] [MainThread]: 
[0m21:52:55.230065 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:52:55.231066 [debug] [MainThread]: Command `dbt test` succeeded at 21:52:55.231066 after 2.07 seconds
[0m21:52:55.232066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161097B8BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161098736D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016109AF38D0>]}
[0m21:52:55.232066 [debug] [MainThread]: Flushing usage events
[0m21:52:55.537956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:17.845998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF6DFAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF5E06F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF6DA3650>]}


============================== 23:14:17.850000 | 8c7bfeaa-c350-4c06-b273-0dfecf455cf9 ==============================
[0m23:14:17.850000 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:14:17.850999 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:14:18.036629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c7bfeaa-c350-4c06-b273-0dfecf455cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF7F3B010>]}
[0m23:14:18.096311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c7bfeaa-c350-4c06-b273-0dfecf455cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF3608190>]}
[0m23:14:18.097895 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:14:18.341340 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:14:18.485452 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m23:14:18.486699 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\mart_payment_type.sql
[0m23:14:18.486801 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\schema.yml
[0m23:14:18.487382 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\fct_yellow_trips.sql
[0m23:14:18.487941 [debug] [MainThread]: Partial parsing: deleted file: my_dbt://models\marts\mart_trip_facts.sql
[0m23:14:18.956026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c7bfeaa-c350-4c06-b273-0dfecf455cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF7F6B0D0>]}
[0m23:14:19.029467 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:14:19.031466 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:14:19.055769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c7bfeaa-c350-4c06-b273-0dfecf455cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF85937D0>]}
[0m23:14:19.056796 [info ] [MainThread]: Found 5 models, 8 data tests, 1 source, 464 macros
[0m23:14:19.057796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c7bfeaa-c350-4c06-b273-0dfecf455cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF5DEE350>]}
[0m23:14:19.058798 [info ] [MainThread]: 
[0m23:14:19.059794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:19.060768 [info ] [MainThread]: 
[0m23:14:19.060768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:19.064797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m23:14:19.127751 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m23:14:19.128755 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m23:14:19.128755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:19.145976 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m23:14:19.147222 [debug] [ThreadPool]: On list_de_db: Close
[0m23:14:19.149206 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m23:14:19.154211 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m23:14:19.154727 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:14:19.154727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:19.170268 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.016 seconds
[0m23:14:19.173150 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m23:14:19.174764 [debug] [ThreadPool]: On list_de_db_public: Close
[0m23:14:19.184686 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:19.184686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:14:19.185685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:19.224241 [debug] [MainThread]: SQL status: SELECT 0 in 0.039 seconds
[0m23:14:19.225184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c7bfeaa-c350-4c06-b273-0dfecf455cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF8A98F50>]}
[0m23:14:19.226184 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:19.227557 [debug] [MainThread]: On master: COMMIT
[0m23:14:19.227557 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:19.227557 [debug] [MainThread]: On master: COMMIT
[0m23:14:19.230554 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:14:19.230554 [debug] [MainThread]: On master: Close
[0m23:14:19.235556 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m23:14:19.235556 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m23:14:19.236367 [info ] [Thread-1 (]: 1 of 2 START sql table model public.hello ...................................... [RUN]
[0m23:14:19.236367 [info ] [Thread-2 (]: 2 of 2 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m23:14:19.237365 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m23:14:19.238364 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m23:14:19.238364 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m23:14:19.238364 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m23:14:19.244137 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m23:14:19.247112 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m23:14:19.248112 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m23:14:19.256810 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m23:14:19.279021 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m23:14:19.282995 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m23:14:19.283998 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:14:19.283998 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:14:19.284996 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m23:14:19.284996 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m23:14:19.285997 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:14:19.285997 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:14:19.318933 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.033 seconds
[0m23:14:19.327959 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:14:19.327959 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m23:14:19.329672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:19.333247 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:14:19.333860 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m23:14:19.335993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:19.349206 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:14:19.349206 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:14:19.350174 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:14:19.368098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m23:14:19.373661 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m23:14:19.378724 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:14:19.379262 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m23:14:19.410975 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m23:14:19.412938 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m23:14:19.415374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c7bfeaa-c350-4c06-b273-0dfecf455cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF8BB6690>]}
[0m23:14:19.416400 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.18s]
[0m23:14:19.417378 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m23:14:31.901815 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 12.615 seconds
[0m23:14:31.905429 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:14:31.905984 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m23:14:31.907390 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:31.910239 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:14:31.910239 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m23:14:31.911514 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:14:31.913554 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:14:31.913554 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:14:31.914528 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:14:31.960518 [debug] [Thread-2 (]: SQL status: COMMIT in 0.046 seconds
[0m23:14:31.963502 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m23:14:31.964503 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:14:31.964503 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m23:14:32.113488 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.148 seconds
[0m23:14:32.114932 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m23:14:32.115562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c7bfeaa-c350-4c06-b273-0dfecf455cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF8B996D0>]}
[0m23:14:32.116128 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 12.88s]
[0m23:14:32.117196 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m23:14:32.118357 [debug] [MainThread]: On master: COMMIT
[0m23:14:32.119071 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:32.119071 [debug] [MainThread]: On master: COMMIT
[0m23:14:32.119643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:14:32.132584 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m23:14:32.132584 [debug] [MainThread]: On master: Close
[0m23:14:32.133589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:32.133589 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m23:14:32.134301 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m23:14:32.134813 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m23:14:32.134813 [debug] [MainThread]: Connection 'model.my_dbt.stg_yellow_tripdata' was properly closed.
[0m23:14:32.135598 [info ] [MainThread]: 
[0m23:14:32.136107 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.07 seconds (13.07s).
[0m23:14:32.137106 [debug] [MainThread]: Command end result
[0m23:14:32.157944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:14:32.159916 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:14:32.164942 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m23:14:32.165915 [info ] [MainThread]: 
[0m23:14:32.165915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:14:32.166942 [info ] [MainThread]: 
[0m23:14:32.166942 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:14:32.167915 [debug] [MainThread]: Command `dbt run` succeeded at 23:14:32.167915 after 14.42 seconds
[0m23:14:32.168915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF5E06F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DEFFB8BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF5F2A650>]}
[0m23:14:32.168915 [debug] [MainThread]: Flushing usage events
[0m23:14:32.490569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:38.911984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DE33A350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DF1BA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DF1BA490>]}


============================== 23:14:38.918985 | 2ee63891-c14b-41db-96b8-77f405eb954f ==============================
[0m23:14:38.918985 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:14:38.920985 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:14:39.118821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ee63891-c14b-41db-96b8-77f405eb954f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E0399DD0>]}
[0m23:14:39.176459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ee63891-c14b-41db-96b8-77f405eb954f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DBA18110>]}
[0m23:14:39.178117 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:14:39.413165 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:14:39.551687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:14:39.552269 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:14:39.552269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:14:39.593051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ee63891-c14b-41db-96b8-77f405eb954f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DF215C50>]}
[0m23:14:39.666930 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:14:39.668937 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:14:39.705593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ee63891-c14b-41db-96b8-77f405eb954f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E0A43E50>]}
[0m23:14:39.707801 [info ] [MainThread]: Found 5 models, 8 data tests, 1 source, 464 macros
[0m23:14:39.708397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ee63891-c14b-41db-96b8-77f405eb954f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E0625790>]}
[0m23:14:39.711573 [info ] [MainThread]: 
[0m23:14:39.712786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:39.712786 [info ] [MainThread]: 
[0m23:14:39.713785 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:39.718991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m23:14:39.834796 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m23:14:39.835804 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:14:39.836784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:39.854954 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.018 seconds
[0m23:14:39.855978 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m23:14:39.858322 [debug] [ThreadPool]: On list_de_db_public: Close
[0m23:14:39.868495 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:39.869048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:14:39.869594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:39.886191 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m23:14:39.887261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ee63891-c14b-41db-96b8-77f405eb954f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239E06245D0>]}
[0m23:14:39.887815 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:39.889360 [debug] [MainThread]: On master: COMMIT
[0m23:14:39.889360 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:39.889920 [debug] [MainThread]: On master: COMMIT
[0m23:14:39.891838 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:14:39.892353 [debug] [MainThread]: On master: Close
[0m23:14:39.896053 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd
[0m23:14:39.897053 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7
[0m23:14:39.897053 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12
[0m23:14:39.898083 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03
[0m23:14:39.897053 [info ] [Thread-1 (]: 1 of 8 START test not_null_fct_yellow_trips_dropoff_datetime ................... [RUN]
[0m23:14:39.898083 [info ] [Thread-2 (]: 2 of 8 START test not_null_fct_yellow_trips_pickup_datetime .................... [RUN]
[0m23:14:39.899109 [info ] [Thread-3 (]: 3 of 8 START test not_null_fct_yellow_trips_total_amount ....................... [RUN]
[0m23:14:39.900107 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd'
[0m23:14:39.899109 [info ] [Thread-4 (]: 4 of 8 START test not_null_mart_daily_revenue_pickup_date ...................... [RUN]
[0m23:14:39.901106 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7'
[0m23:14:39.901106 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12'
[0m23:14:39.902142 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd
[0m23:14:39.902142 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03'
[0m23:14:39.903138 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7
[0m23:14:39.903138 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12
[0m23:14:39.916175 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd"
[0m23:14:39.917175 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03
[0m23:14:39.921042 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7"
[0m23:14:39.924011 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12"
[0m23:14:39.928356 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03"
[0m23:14:39.929901 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd
[0m23:14:39.930903 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7
[0m23:14:39.930903 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12
[0m23:14:39.945785 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd"
[0m23:14:39.946753 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03
[0m23:14:39.949788 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7"
[0m23:14:39.951878 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12"
[0m23:14:39.954911 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03"
[0m23:14:39.955883 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd"
[0m23:14:39.955883 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7"
[0m23:14:39.956877 [debug] [Thread-1 (]: On test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."fct_yellow_trips"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:14:39.956877 [debug] [Thread-2 (]: On test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."fct_yellow_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:14:39.957883 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12"
[0m23:14:39.957883 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03"
[0m23:14:39.958883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:14:39.958883 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:14:39.959901 [debug] [Thread-3 (]: On test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."fct_yellow_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m23:14:39.959901 [debug] [Thread-4 (]: On test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_date
from "de_db"."public"."mart_daily_revenue"
where pickup_date is null



  
  
      
    ) dbt_internal_test
[0m23:14:39.960912 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:14:39.961879 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:14:39.977195 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_yellow_trips" does not exist
LINE 17: from "de_db"."public"."fct_yellow_trips"
              ^

[0m23:14:39.977790 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.fct_yellow_trips" does not exist
LINE 17: from "de_db"."public"."fct_yellow_trips"
              ^

[0m23:14:39.977790 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.fct_yellow_trips" does not exist
LINE 17: from "de_db"."public"."fct_yellow_trips"
              ^

[0m23:14:39.978795 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.mart_daily_revenue" does not exist
LINE 17: from "de_db"."public"."mart_daily_revenue"
              ^

[0m23:14:39.978795 [debug] [Thread-1 (]: On test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd: ROLLBACK
[0m23:14:39.979788 [debug] [Thread-2 (]: On test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7: ROLLBACK
[0m23:14:39.979788 [debug] [Thread-3 (]: On test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12: ROLLBACK
[0m23:14:39.980788 [debug] [Thread-4 (]: On test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03: ROLLBACK
[0m23:14:39.982384 [debug] [Thread-3 (]: On test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12: Close
[0m23:14:39.982930 [debug] [Thread-2 (]: On test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7: Close
[0m23:14:39.983461 [debug] [Thread-1 (]: On test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd: Close
[0m23:14:39.983975 [debug] [Thread-4 (]: On test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03: Close
[0m23:14:39.995004 [debug] [Thread-2 (]: Database Error in test not_null_fct_yellow_trips_pickup_datetime (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_pickup_datetime.sql
[0m23:14:39.997150 [debug] [Thread-4 (]: Database Error in test not_null_mart_daily_revenue_pickup_date (models\marts\schema.yml)
  relation "public.mart_daily_revenue" does not exist
  LINE 17: from "de_db"."public"."mart_daily_revenue"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_mart_daily_revenue_pickup_date.sql
[0m23:14:39.998251 [debug] [Thread-1 (]: Database Error in test not_null_fct_yellow_trips_dropoff_datetime (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_dropoff_datetime.sql
[0m23:14:39.996182 [error] [Thread-2 (]: 2 of 8 ERROR not_null_fct_yellow_trips_pickup_datetime ......................... [[31mERROR[0m in 0.10s]
[0m23:14:39.999947 [debug] [Thread-3 (]: Database Error in test not_null_fct_yellow_trips_total_amount (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_total_amount.sql
[0m23:14:39.998849 [error] [Thread-4 (]: 4 of 8 ERROR not_null_mart_daily_revenue_pickup_date ........................... [[31mERROR[0m in 0.10s]
[0m23:14:40.000929 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7
[0m23:14:39.999947 [error] [Thread-1 (]: 1 of 8 ERROR not_null_fct_yellow_trips_dropoff_datetime ........................ [[31mERROR[0m in 0.10s]
[0m23:14:40.001929 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03
[0m23:14:40.002928 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m23:14:40.000929 [error] [Thread-3 (]: 3 of 8 ERROR not_null_fct_yellow_trips_total_amount ............................ [[31mERROR[0m in 0.10s]
[0m23:14:40.002928 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_yellow_trips_pickup_datetime (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_pickup_datetime.sql.
[0m23:14:40.003935 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd
[0m23:14:40.004936 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:14:40.004936 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m23:14:40.005929 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12
[0m23:14:40.006964 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03' to be skipped because of status 'error'.  Reason: Database Error in test not_null_mart_daily_revenue_pickup_date (models\marts\schema.yml)
  relation "public.mart_daily_revenue" does not exist
  LINE 17: from "de_db"."public"."mart_daily_revenue"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_mart_daily_revenue_pickup_date.sql.
[0m23:14:40.006964 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m23:14:40.007936 [info ] [Thread-4 (]: 6 of 8 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m23:14:40.007936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_fct_yellow_trips_pickup_datetime.b76d5796b7, now test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001)
[0m23:14:40.008936 [debug] [Thread-3 (]: Began running node test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc
[0m23:14:40.009928 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_yellow_trips_dropoff_datetime (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_dropoff_datetime.sql.
[0m23:14:40.010928 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_mart_daily_revenue_pickup_date.1d73581b03, now test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44)
[0m23:14:40.009928 [info ] [Thread-1 (]: 7 of 8 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m23:14:40.010928 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m23:14:40.011928 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_yellow_trips_total_amount (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_total_amount.sql.
[0m23:14:40.011928 [info ] [Thread-3 (]: 8 of 8 START test unique_mart_daily_revenue_pickup_date ........................ [RUN]
[0m23:14:40.012928 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:14:40.012928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_fct_yellow_trips_dropoff_datetime.c4abf596bd, now test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786)
[0m23:14:40.016969 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m23:14:40.016969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_fct_yellow_trips_total_amount.032e20ce12, now test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc)
[0m23:14:40.020409 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:14:40.021407 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m23:14:40.022375 [debug] [Thread-3 (]: Began compiling node test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc
[0m23:14:40.022375 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m23:14:40.026407 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m23:14:40.031088 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc"
[0m23:14:40.034089 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m23:14:40.034089 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:14:40.035055 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m23:14:40.035055 [debug] [Thread-3 (]: Began executing node test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc
[0m23:14:40.038088 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:14:40.038088 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m23:14:40.040087 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m23:14:40.043056 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc"
[0m23:14:40.044056 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:14:40.045332 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:14:40.045332 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m23:14:40.046337 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:14:40.046337 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:14:40.046337 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc"
[0m23:14:40.047336 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m23:14:40.048330 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:14:40.048690 [debug] [Thread-3 (]: On test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pickup_date as unique_field,
    count(*) as n_records

from "de_db"."public"."mart_daily_revenue"
where pickup_date is not null
group by pickup_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:14:40.049209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:40.050031 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:14:40.090787 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.mart_daily_revenue" does not exist
LINE 18: from "de_db"."public"."mart_daily_revenue"
              ^

[0m23:14:40.091301 [debug] [Thread-3 (]: On test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc: ROLLBACK
[0m23:14:40.097622 [debug] [Thread-3 (]: On test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc: Close
[0m23:14:40.100746 [debug] [Thread-3 (]: Database Error in test unique_mart_daily_revenue_pickup_date (models\marts\schema.yml)
  relation "public.mart_daily_revenue" does not exist
  LINE 18: from "de_db"."public"."mart_daily_revenue"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\unique_mart_daily_revenue_pickup_date.sql
[0m23:14:40.102311 [error] [Thread-3 (]: 8 of 8 ERROR unique_mart_daily_revenue_pickup_date ............................. [[31mERROR[0m in 0.08s]
[0m23:14:40.103364 [debug] [Thread-3 (]: Finished running node test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc
[0m23:14:40.103880 [debug] [Thread-7 (]: Marking all children of 'test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc' to be skipped because of status 'error'.  Reason: Database Error in test unique_mart_daily_revenue_pickup_date (models\marts\schema.yml)
  relation "public.mart_daily_revenue" does not exist
  LINE 18: from "de_db"."public"."mart_daily_revenue"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\unique_mart_daily_revenue_pickup_date.sql.
[0m23:14:40.313666 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.268 seconds
[0m23:14:40.319667 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m23:14:40.321666 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m23:14:40.321666 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.274 seconds
[0m23:14:40.322666 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.273 seconds
[0m23:14:40.324665 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m23:14:40.322666 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 0.31s]
[0m23:14:40.325665 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m23:14:40.326665 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m23:14:40.326665 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m23:14:40.327665 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m23:14:40.327665 [info ] [Thread-4 (]: 6 of 8 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.32s]
[0m23:14:40.329668 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:14:40.328666 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 0.32s]
[0m23:14:40.329668 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m23:14:40.331665 [debug] [MainThread]: On master: COMMIT
[0m23:14:40.331665 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:40.332665 [debug] [MainThread]: On master: COMMIT
[0m23:14:40.332665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:14:40.342664 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m23:14:40.343665 [debug] [MainThread]: On master: Close
[0m23:14:40.343665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:40.344665 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m23:14:40.344665 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m23:14:40.344665 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m23:14:40.345666 [debug] [MainThread]: Connection 'test.my_dbt.unique_mart_daily_revenue_pickup_date.2808c81afc' was properly closed.
[0m23:14:40.345666 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m23:14:40.346666 [info ] [MainThread]: 
[0m23:14:40.346666 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m23:14:40.348666 [debug] [MainThread]: Command end result
[0m23:14:40.368664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:14:40.370664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:14:40.376664 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m23:14:40.376664 [info ] [MainThread]: 
[0m23:14:40.377665 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m23:14:40.378664 [info ] [MainThread]: 
[0m23:14:40.378664 [error] [MainThread]: [31mFailure in test not_null_fct_yellow_trips_pickup_datetime (models\marts\schema.yml)[0m
[0m23:14:40.379665 [error] [MainThread]:   Database Error in test not_null_fct_yellow_trips_pickup_datetime (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_pickup_datetime.sql
[0m23:14:40.380665 [info ] [MainThread]: 
[0m23:14:40.380665 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_pickup_datetime.sql
[0m23:14:40.381666 [info ] [MainThread]: 
[0m23:14:40.382668 [error] [MainThread]: [31mFailure in test not_null_mart_daily_revenue_pickup_date (models\marts\schema.yml)[0m
[0m23:14:40.382668 [error] [MainThread]:   Database Error in test not_null_mart_daily_revenue_pickup_date (models\marts\schema.yml)
  relation "public.mart_daily_revenue" does not exist
  LINE 17: from "de_db"."public"."mart_daily_revenue"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_mart_daily_revenue_pickup_date.sql
[0m23:14:40.383667 [info ] [MainThread]: 
[0m23:14:40.384665 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\schema.yml\not_null_mart_daily_revenue_pickup_date.sql
[0m23:14:40.384665 [info ] [MainThread]: 
[0m23:14:40.385665 [error] [MainThread]: [31mFailure in test not_null_fct_yellow_trips_dropoff_datetime (models\marts\schema.yml)[0m
[0m23:14:40.386665 [error] [MainThread]:   Database Error in test not_null_fct_yellow_trips_dropoff_datetime (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_dropoff_datetime.sql
[0m23:14:40.386665 [info ] [MainThread]: 
[0m23:14:40.387665 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_dropoff_datetime.sql
[0m23:14:40.388675 [info ] [MainThread]: 
[0m23:14:40.388675 [error] [MainThread]: [31mFailure in test not_null_fct_yellow_trips_total_amount (models\marts\schema.yml)[0m
[0m23:14:40.389665 [error] [MainThread]:   Database Error in test not_null_fct_yellow_trips_total_amount (models\marts\schema.yml)
  relation "public.fct_yellow_trips" does not exist
  LINE 17: from "de_db"."public"."fct_yellow_trips"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_total_amount.sql
[0m23:14:40.390665 [info ] [MainThread]: 
[0m23:14:40.390665 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\schema.yml\not_null_fct_yellow_trips_total_amount.sql
[0m23:14:40.391665 [info ] [MainThread]: 
[0m23:14:40.391665 [error] [MainThread]: [31mFailure in test unique_mart_daily_revenue_pickup_date (models\marts\schema.yml)[0m
[0m23:14:40.392665 [error] [MainThread]:   Database Error in test unique_mart_daily_revenue_pickup_date (models\marts\schema.yml)
  relation "public.mart_daily_revenue" does not exist
  LINE 18: from "de_db"."public"."mart_daily_revenue"
                ^
  compiled code at target\run\my_dbt\models\marts\schema.yml\unique_mart_daily_revenue_pickup_date.sql
[0m23:14:40.392665 [info ] [MainThread]: 
[0m23:14:40.393665 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\schema.yml\unique_mart_daily_revenue_pickup_date.sql
[0m23:14:40.393665 [info ] [MainThread]: 
[0m23:14:40.394665 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=8
[0m23:14:40.395677 [debug] [MainThread]: Command `dbt test` failed at 23:14:40.395677 after 1.56 seconds
[0m23:14:40.395677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D8428BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DDE35410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239DF1B3A50>]}
[0m23:14:40.396665 [debug] [MainThread]: Flushing usage events
[0m23:14:40.689124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:58.835245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C638AAA3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C638AD4CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C638AAA8D0>]}


============================== 23:14:58.838849 | 7a4b01a1-2ca2-446d-ba5f-5767e26c4421 ==============================
[0m23:14:58.838849 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:14:58.839848 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:14:59.015415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a4b01a1-2ca2-446d-ba5f-5767e26c4421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C638B055D0>]}
[0m23:14:59.072132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a4b01a1-2ca2-446d-ba5f-5767e26c4421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6352F82D0>]}
[0m23:14:59.073645 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:14:59.297797 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:14:59.417089 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m23:14:59.650060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a4b01a1-2ca2-446d-ba5f-5767e26c4421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63A24FD10>]}
[0m23:14:59.794339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:14:59.796513 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:14:59.827939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a4b01a1-2ca2-446d-ba5f-5767e26c4421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C639F15DD0>]}
[0m23:14:59.828915 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 464 macros
[0m23:14:59.828915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4b01a1-2ca2-446d-ba5f-5767e26c4421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C639CA2610>]}
[0m23:14:59.830940 [info ] [MainThread]: 
[0m23:14:59.832192 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:59.832730 [info ] [MainThread]: 
[0m23:14:59.832730 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:59.837759 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m23:14:59.900361 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m23:14:59.900361 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:14:59.901362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:59.918548 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.017 seconds
[0m23:14:59.920549 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m23:14:59.922156 [debug] [ThreadPool]: On list_de_db_public: Close
[0m23:14:59.932339 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:59.933311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:14:59.933311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:59.950877 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m23:14:59.952537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4b01a1-2ca2-446d-ba5f-5767e26c4421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63A17F390>]}
[0m23:14:59.953268 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:59.954939 [debug] [MainThread]: On master: COMMIT
[0m23:14:59.955612 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:59.955742 [debug] [MainThread]: On master: COMMIT
[0m23:14:59.958292 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:14:59.958662 [debug] [MainThread]: On master: Close
[0m23:14:59.963999 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m23:14:59.963999 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:14:59.963999 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m23:14:59.965004 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m23:14:59.965004 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m23:14:59.966979 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001'
[0m23:14:59.965979 [info ] [Thread-3 (]: 3 of 3 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m23:14:59.966979 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m23:14:59.968021 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m23:14:59.968021 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786'
[0m23:14:59.969019 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:14:59.982087 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m23:14:59.983062 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m23:14:59.986719 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:14:59.989718 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m23:14:59.990718 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m23:14:59.991718 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:15:00.001853 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m23:15:00.008393 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m23:15:00.011471 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:15:00.014428 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m23:15:00.016403 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m23:15:00.016403 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m23:15:00.016403 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m23:15:00.017605 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:15:00.018119 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m23:15:00.018119 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m23:15:00.019151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:15:00.019151 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:15:00.019151 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:15:00.233765 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.215 seconds
[0m23:15:00.239765 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m23:15:00.240766 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.222 seconds
[0m23:15:00.243769 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m23:15:00.249161 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m23:15:00.253984 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m23:15:00.251165 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.28s]
[0m23:15:00.255827 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 0.29s]
[0m23:15:00.256838 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m23:15:00.257964 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m23:15:00.278291 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.258 seconds
[0m23:15:00.279968 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m23:15:00.281556 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m23:15:00.282594 [info ] [Thread-3 (]: 3 of 3 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 0.31s]
[0m23:15:00.283619 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m23:15:00.284675 [debug] [MainThread]: On master: COMMIT
[0m23:15:00.285190 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:00.285704 [debug] [MainThread]: On master: COMMIT
[0m23:15:00.285704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:15:00.296557 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m23:15:00.297085 [debug] [MainThread]: On master: Close
[0m23:15:00.297600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:00.297600 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m23:15:00.298117 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m23:15:00.298632 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m23:15:00.299148 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m23:15:00.299663 [info ] [MainThread]: 
[0m23:15:00.299663 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m23:15:00.300677 [debug] [MainThread]: Command end result
[0m23:15:00.322085 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:15:00.324086 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:15:00.330733 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m23:15:00.330733 [info ] [MainThread]: 
[0m23:15:00.331727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:15:00.332723 [info ] [MainThread]: 
[0m23:15:00.332723 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:15:00.334723 [debug] [MainThread]: Command `dbt test` succeeded at 23:15:00.334723 after 1.57 seconds
[0m23:15:00.334723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C631C98BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C638B04350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C638B05150>]}
[0m23:15:00.335725 [debug] [MainThread]: Flushing usage events
[0m23:15:00.638323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:40:03.825868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98C4B8C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98C70ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98C6E0AD0>]}


============================== 23:40:03.830446 | 06621107-ea92-4e85-b70b-4ce80baf7d3f ==============================
[0m23:40:03.830446 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:40:03.831446 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:40:03.999681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06621107-ea92-4e85-b70b-4ce80baf7d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98D889650>]}
[0m23:40:04.055299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06621107-ea92-4e85-b70b-4ce80baf7d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F988F18690>]}
[0m23:40:04.056292 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:40:04.282161 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:40:04.412323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:40:04.413323 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:40:04.413323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:40:04.454197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06621107-ea92-4e85-b70b-4ce80baf7d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98C6B2D50>]}
[0m23:40:04.529001 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:40:04.530924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:40:04.556072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06621107-ea92-4e85-b70b-4ce80baf7d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98DE34150>]}
[0m23:40:04.557147 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 464 macros
[0m23:40:04.558227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06621107-ea92-4e85-b70b-4ce80baf7d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98DDB1DD0>]}
[0m23:40:04.559889 [info ] [MainThread]: 
[0m23:40:04.560912 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:40:04.561458 [info ] [MainThread]: 
[0m23:40:04.561996 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:04.565871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m23:40:04.671099 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m23:40:04.672124 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m23:40:04.672124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:04.689098 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m23:40:04.690460 [debug] [ThreadPool]: On list_de_db: Close
[0m23:40:04.692099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m23:40:04.696950 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m23:40:04.697949 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:40:04.697949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:04.738195 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.040 seconds
[0m23:40:04.740227 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m23:40:04.740802 [debug] [ThreadPool]: On list_de_db_public: Close
[0m23:40:04.750979 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:04.750979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:40:04.751980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:04.783260 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m23:40:04.784254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06621107-ea92-4e85-b70b-4ce80baf7d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98DDB1ED0>]}
[0m23:40:04.785255 [debug] [MainThread]: On master: ROLLBACK
[0m23:40:04.786229 [debug] [MainThread]: On master: COMMIT
[0m23:40:04.787254 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:04.787254 [debug] [MainThread]: On master: COMMIT
[0m23:40:04.789522 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:40:04.789522 [debug] [MainThread]: On master: Close
[0m23:40:04.793530 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m23:40:04.794561 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m23:40:04.794561 [info ] [Thread-1 (]: 1 of 2 START sql table model public.hello ...................................... [RUN]
[0m23:40:04.796184 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m23:40:04.795184 [info ] [Thread-2 (]: 2 of 2 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m23:40:04.796184 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m23:40:04.797183 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m23:40:04.802210 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m23:40:04.803208 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m23:40:04.806184 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m23:40:04.807208 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m23:40:04.838591 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m23:40:04.839590 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m23:40:04.843590 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m23:40:04.843590 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:40:04.844590 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m23:40:04.844590 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:40:04.845608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:04.845608 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m23:40:04.846592 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:40:04.876485 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.031 seconds
[0m23:40:04.885198 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:40:04.886171 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m23:40:04.888493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:40:04.891389 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:40:04.891850 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m23:40:04.893618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:40:04.907104 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:40:04.908104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:40:04.908104 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:40:04.926073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m23:40:04.933311 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m23:40:04.937740 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:40:04.938472 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m23:40:04.969427 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m23:40:04.972427 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m23:40:04.974428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06621107-ea92-4e85-b70b-4ce80baf7d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98E161850>]}
[0m23:40:04.976275 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.18s]
[0m23:40:04.977346 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m23:40:14.870353 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 10.023 seconds
[0m23:40:14.873378 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:40:14.874379 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m23:40:14.876263 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:40:14.879263 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:40:14.879263 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m23:40:14.881330 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:40:14.882876 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:40:14.882876 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:40:14.883917 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:40:15.145945 [debug] [Thread-2 (]: SQL status: COMMIT in 0.262 seconds
[0m23:40:15.148021 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m23:40:15.149021 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:40:15.150019 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m23:40:15.232581 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.082 seconds
[0m23:40:15.234261 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m23:40:15.234780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06621107-ea92-4e85-b70b-4ce80baf7d3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98E178ED0>]}
[0m23:40:15.235390 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 10.44s]
[0m23:40:15.236482 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m23:40:15.237858 [debug] [MainThread]: On master: COMMIT
[0m23:40:15.238467 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:15.239003 [debug] [MainThread]: On master: COMMIT
[0m23:40:15.239003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:15.269163 [debug] [MainThread]: SQL status: COMMIT in 0.030 seconds
[0m23:40:15.269935 [debug] [MainThread]: On master: Close
[0m23:40:15.270557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:15.270557 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m23:40:15.271116 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m23:40:15.271627 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m23:40:15.271627 [debug] [MainThread]: Connection 'model.my_dbt.stg_yellow_tripdata' was properly closed.
[0m23:40:15.272196 [info ] [MainThread]: 
[0m23:40:15.273649 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.71 seconds (10.71s).
[0m23:40:15.274753 [debug] [MainThread]: Command end result
[0m23:40:15.295475 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:40:15.297475 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:40:15.303538 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m23:40:15.304079 [info ] [MainThread]: 
[0m23:40:15.304589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:15.304589 [info ] [MainThread]: 
[0m23:40:15.305588 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:40:15.306590 [debug] [MainThread]: Command `dbt run` succeeded at 23:40:15.306590 after 11.54 seconds
[0m23:40:15.307588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98C715150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F985BB1650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F985BB0890>]}
[0m23:40:15.307588 [debug] [MainThread]: Flushing usage events
[0m23:40:15.622837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:20.479260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4288A9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E428DB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E428DB150>]}


============================== 23:45:20.482257 | 7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d ==============================
[0m23:45:20.482257 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:45:20.483259 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:45:20.648531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E43AA1CD0>]}
[0m23:45:20.704495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3F0E8190>]}
[0m23:45:20.705775 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:45:20.933712 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:45:21.053007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:21.053007 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:45:21.054409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:21.094579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E43B456D0>]}
[0m23:45:21.168573 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:45:21.171292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:45:21.200087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E44004510>]}
[0m23:45:21.200611 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 464 macros
[0m23:45:21.201650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E43CDE590>]}
[0m23:45:21.203247 [info ] [MainThread]: 
[0m23:45:21.204325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:45:21.204850 [info ] [MainThread]: 
[0m23:45:21.205375 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:21.209478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m23:45:21.322576 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m23:45:21.323572 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m23:45:21.323572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:21.340216 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m23:45:21.341332 [debug] [ThreadPool]: On list_de_db: Close
[0m23:45:21.343345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m23:45:21.347486 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m23:45:21.348512 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:45:21.348512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:21.379695 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.031 seconds
[0m23:45:21.381646 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m23:45:21.383619 [debug] [ThreadPool]: On list_de_db_public: Close
[0m23:45:21.392730 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:21.393725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:45:21.393725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:21.425997 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m23:45:21.427574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4406CE10>]}
[0m23:45:21.427574 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:21.428574 [debug] [MainThread]: On master: COMMIT
[0m23:45:21.429573 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:21.429573 [debug] [MainThread]: On master: COMMIT
[0m23:45:21.431572 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:45:21.432539 [debug] [MainThread]: On master: Close
[0m23:45:21.436591 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m23:45:21.436591 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m23:45:21.437613 [info ] [Thread-1 (]: 1 of 2 START sql table model public.hello ...................................... [RUN]
[0m23:45:21.438595 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m23:45:21.437613 [info ] [Thread-2 (]: 2 of 2 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m23:45:21.439620 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m23:45:21.439620 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m23:45:21.445171 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m23:45:21.446205 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m23:45:21.449206 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m23:45:21.449206 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m23:45:21.480969 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m23:45:21.481967 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m23:45:21.485968 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m23:45:21.485968 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:45:21.486942 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m23:45:21.486942 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:45:21.487941 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:45:21.487941 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m23:45:21.488941 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:45:21.520604 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.033 seconds
[0m23:45:21.530285 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:45:21.530830 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m23:45:21.532225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:21.535226 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:45:21.536226 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m23:45:21.537227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:21.551226 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:45:21.552226 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:45:21.552226 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:45:21.585612 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m23:45:21.591613 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m23:45:21.595613 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:45:21.596613 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m23:45:21.616381 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m23:45:21.619383 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m23:45:21.621382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E44382090>]}
[0m23:45:21.622379 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.18s]
[0m23:45:21.623376 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m23:45:31.910722 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 10.422 seconds
[0m23:45:31.914754 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:45:31.914754 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m23:45:31.916251 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:31.919185 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:45:31.920019 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m23:45:31.921318 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:45:31.922479 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:45:31.923347 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:45:31.923753 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:45:31.970280 [debug] [Thread-2 (]: SQL status: COMMIT in 0.046 seconds
[0m23:45:31.972846 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m23:45:31.973527 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:45:31.974038 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m23:45:32.041396 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.067 seconds
[0m23:45:32.042693 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m23:45:32.043773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdbbc94-fb04-470c-8aa3-5ac8daa3be0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E43A3D690>]}
[0m23:45:32.043773 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 10.60s]
[0m23:45:32.044771 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m23:45:32.046820 [debug] [MainThread]: On master: COMMIT
[0m23:45:32.047380 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:32.047903 [debug] [MainThread]: On master: COMMIT
[0m23:45:32.048453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:32.060988 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m23:45:32.062015 [debug] [MainThread]: On master: Close
[0m23:45:32.062551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:32.062551 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m23:45:32.062551 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m23:45:32.063551 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m23:45:32.063551 [debug] [MainThread]: Connection 'model.my_dbt.stg_yellow_tripdata' was properly closed.
[0m23:45:32.063551 [info ] [MainThread]: 
[0m23:45:32.064595 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.86 seconds (10.86s).
[0m23:45:32.066178 [debug] [MainThread]: Command end result
[0m23:45:32.086869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:45:32.088837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:45:32.093861 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m23:45:32.094864 [info ] [MainThread]: 
[0m23:45:32.094864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:45:32.095867 [info ] [MainThread]: 
[0m23:45:32.095867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:45:32.097081 [debug] [MainThread]: Command `dbt run` succeeded at 23:45:32.097081 after 11.68 seconds
[0m23:45:32.098057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3BA98C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E428E4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E428E5150>]}
[0m23:45:32.098057 [debug] [MainThread]: Flushing usage events
[0m23:45:32.380303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:50:46.359825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278F9BAA450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278F9BD5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278F9BA9E90>]}


============================== 23:50:46.362825 | 0399ad65-c879-4478-a2b0-98c69879a60f ==============================
[0m23:50:46.362825 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:50:46.363825 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_yellow_trips', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:50:46.535349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0399ad65-c879-4478-a2b0-98c69879a60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278FADC1590>]}
[0m23:50:46.591009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0399ad65-c879-4478-a2b0-98c69879a60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278F6408150>]}
[0m23:50:46.592983 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:50:46.805043 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:50:46.930149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:46.931756 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\fct_yellow_trips.sql
[0m23:50:47.163661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0399ad65-c879-4478-a2b0-98c69879a60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278FB2AADD0>]}
[0m23:50:47.285404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:50:47.288253 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:50:47.309344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0399ad65-c879-4478-a2b0-98c69879a60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278FB25AAD0>]}
[0m23:50:47.310344 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 464 macros
[0m23:50:47.310344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0399ad65-c879-4478-a2b0-98c69879a60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278F892ED50>]}
[0m23:50:47.312344 [info ] [MainThread]: 
[0m23:50:47.312344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:50:47.313344 [info ] [MainThread]: 
[0m23:50:47.313344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:50:47.314344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m23:50:47.376284 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m23:50:47.376284 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m23:50:47.377283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:47.393558 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m23:50:47.394632 [debug] [ThreadPool]: On list_de_db: Close
[0m23:50:47.399750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m23:50:47.405126 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m23:50:47.405681 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:50:47.406224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:47.438140 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.032 seconds
[0m23:50:47.440140 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m23:50:47.441140 [debug] [ThreadPool]: On list_de_db_public: Close
[0m23:50:47.451140 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:47.451140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:50:47.452139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:47.485516 [debug] [MainThread]: SQL status: SELECT 0 in 0.033 seconds
[0m23:50:47.486600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0399ad65-c879-4478-a2b0-98c69879a60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278FB769490>]}
[0m23:50:47.487139 [debug] [MainThread]: On master: ROLLBACK
[0m23:50:47.489678 [debug] [MainThread]: On master: COMMIT
[0m23:50:47.490705 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:47.490729 [debug] [MainThread]: On master: COMMIT
[0m23:50:47.493594 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:50:47.494104 [debug] [MainThread]: On master: Close
[0m23:50:47.498102 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_yellow_trips
[0m23:50:47.498102 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m23:50:47.499102 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips'
[0m23:50:47.500102 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m23:50:47.506103 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m23:50:47.507103 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m23:50:47.537476 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m23:50:47.539449 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:50:47.539449 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m23:50:47.539449 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:51:00.144633 [debug] [Thread-1 (]: SQL status: SELECT 3475226 in 12.604 seconds
[0m23:51:00.153463 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:51:00.154489 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m23:51:00.156040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:00.167669 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m23:51:00.168700 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:51:00.168700 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m23:51:00.217236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m23:51:00.222711 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m23:51:00.226950 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:51:00.227975 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m23:51:00.229950 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:51:00.232152 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips: Close
[0m23:51:00.233982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0399ad65-c879-4478-a2b0-98c69879a60f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278FB7621D0>]}
[0m23:51:00.234957 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 12.73s]
[0m23:51:00.235982 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m23:51:00.237477 [debug] [MainThread]: On master: COMMIT
[0m23:51:00.238572 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:00.238572 [debug] [MainThread]: On master: COMMIT
[0m23:51:00.238572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:00.252397 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m23:51:00.252912 [debug] [MainThread]: On master: Close
[0m23:51:00.253430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:00.254011 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m23:51:00.254530 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m23:51:00.254530 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m23:51:00.255040 [info ] [MainThread]: 
[0m23:51:00.255611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.94 seconds (12.94s).
[0m23:51:00.256701 [debug] [MainThread]: Command end result
[0m23:51:00.276404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:51:00.279367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:51:00.284106 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m23:51:00.285106 [info ] [MainThread]: 
[0m23:51:00.285106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:00.286107 [info ] [MainThread]: 
[0m23:51:00.286107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:51:00.287133 [debug] [MainThread]: Command `dbt run` succeeded at 23:51:00.287133 after 13.99 seconds
[0m23:51:00.288136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278F9C05750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278F9C040D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278F8D2A310>]}
[0m23:51:00.288136 [debug] [MainThread]: Flushing usage events
[0m23:51:00.639663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:24.755108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2BE7A710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2BECBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2BECAAD0>]}


============================== 23:57:24.759132 | bfeca477-dc44-43d3-a385-c39700b68f30 ==============================
[0m23:57:24.759132 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:57:24.760106 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart_daily_revenue', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:57:24.927447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfeca477-dc44-43d3-a385-c39700b68f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2CEE4D90>]}
[0m23:57:24.982844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfeca477-dc44-43d3-a385-c39700b68f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B286D8650>]}
[0m23:57:24.983844 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:57:25.219833 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:57:25.366541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:25.367541 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:57:25.367541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:25.413977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfeca477-dc44-43d3-a385-c39700b68f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2D2CD190>]}
[0m23:57:25.495885 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:57:25.498681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:57:25.542962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfeca477-dc44-43d3-a385-c39700b68f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2D5F4490>]}
[0m23:57:25.544037 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 464 macros
[0m23:57:25.545077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfeca477-dc44-43d3-a385-c39700b68f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2D5CCC50>]}
[0m23:57:25.547881 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:57:25.550707 [debug] [MainThread]: Command end result
[0m23:57:25.575707 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:57:25.578709 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:57:25.582707 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m23:57:25.583707 [debug] [MainThread]: Command `dbt run` succeeded at 23:57:25.583707 after 0.90 seconds
[0m23:57:25.583707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B2BB7AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B253A2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B25390950>]}
[0m23:57:25.584706 [debug] [MainThread]: Flushing usage events
[0m23:57:25.987546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:37.884117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B118AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B118B010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B113A410>]}


============================== 23:57:37.889182 | 20483d5d-bd7c-4fe7-886a-3857aaeb2501 ==============================
[0m23:57:37.889182 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:57:37.890156 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:57:38.068369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B118AB90>]}
[0m23:57:38.125266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1AD998350>]}
[0m23:57:38.126292 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:57:38.347768 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:57:38.485935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:38.486492 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:57:38.487011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:38.530930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B27C9190>]}
[0m23:57:38.613474 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:57:38.618477 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:57:38.647753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B28B40D0>]}
[0m23:57:38.648275 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 464 macros
[0m23:57:38.648798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B258B390>]}
[0m23:57:38.650310 [info ] [MainThread]: 
[0m23:57:38.651310 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:38.651310 [info ] [MainThread]: 
[0m23:57:38.652311 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:38.656310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m23:57:38.766376 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m23:57:38.766376 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m23:57:38.767377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:38.783376 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m23:57:38.784376 [debug] [ThreadPool]: On list_de_db: Close
[0m23:57:38.786381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m23:57:38.791252 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m23:57:38.792251 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:57:38.792251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:38.831438 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.038 seconds
[0m23:57:38.833415 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m23:57:38.834434 [debug] [ThreadPool]: On list_de_db_public: Close
[0m23:57:38.844738 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:38.845739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:57:38.845739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:38.877397 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m23:57:38.878363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B290A790>]}
[0m23:57:38.878363 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:38.880337 [debug] [MainThread]: On master: COMMIT
[0m23:57:38.880337 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:38.880337 [debug] [MainThread]: On master: COMMIT
[0m23:57:38.883060 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:57:38.883060 [debug] [MainThread]: On master: Close
[0m23:57:38.888059 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m23:57:38.888059 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m23:57:38.889059 [info ] [Thread-1 (]: 1 of 3 START sql table model public.hello ...................................... [RUN]
[0m23:57:38.889978 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m23:57:38.889059 [info ] [Thread-2 (]: 2 of 3 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m23:57:38.890977 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m23:57:38.890977 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m23:57:38.897484 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m23:57:38.897484 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m23:57:38.900510 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m23:57:38.901515 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m23:57:38.909605 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m23:57:38.934744 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m23:57:38.938919 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m23:57:38.939917 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:57:38.939917 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m23:57:38.941056 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:57:38.941569 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:57:38.942570 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m23:57:38.943343 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:57:38.971014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m23:57:38.981568 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:57:38.982582 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m23:57:38.984340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:57:38.987593 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:57:38.988156 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m23:57:38.989740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:57:39.004958 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:57:39.004958 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:57:39.005958 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:57:39.109171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.103 seconds
[0m23:57:39.114705 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m23:57:39.119705 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:57:39.119705 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m23:57:39.140407 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m23:57:39.143406 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m23:57:39.145405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B2C61250>]}
[0m23:57:39.147446 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.25s]
[0m23:57:39.148723 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m23:57:48.223382 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 9.281 seconds
[0m23:57:48.227667 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:57:48.228303 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m23:57:48.333244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.105 seconds
[0m23:57:48.337072 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:57:48.337681 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m23:57:48.339860 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:57:48.341507 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:57:48.342055 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:57:48.342583 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:57:48.382309 [debug] [Thread-2 (]: SQL status: COMMIT in 0.039 seconds
[0m23:57:48.384750 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m23:57:48.385895 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:57:48.386455 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m23:57:48.457727 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.071 seconds
[0m23:57:48.458932 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m23:57:48.459900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B2BF0F10>]}
[0m23:57:48.459900 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 9.57s]
[0m23:57:48.460902 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m23:57:48.461875 [debug] [Thread-4 (]: Began running node model.my_dbt.fct_yellow_trips
[0m23:57:48.462874 [info ] [Thread-4 (]: 3 of 3 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m23:57:48.463875 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips'
[0m23:57:48.464900 [debug] [Thread-4 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m23:57:48.466889 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m23:57:48.467902 [debug] [Thread-4 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m23:57:48.474018 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m23:57:48.474992 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:57:48.474992 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m23:57:48.476020 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:58:08.356327 [debug] [Thread-4 (]: SQL status: SELECT 3475226 in 19.880 seconds
[0m23:58:08.360216 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:58:08.360754 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m23:58:08.362103 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:58:08.365362 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:58:08.365994 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m23:58:08.367528 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:58:08.368794 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m23:58:08.369342 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:58:08.369957 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m23:58:08.451515 [debug] [Thread-4 (]: SQL status: COMMIT in 0.081 seconds
[0m23:58:08.454370 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m23:58:08.455194 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:58:08.456070 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m23:58:08.556270 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.100 seconds
[0m23:58:08.557812 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: Close
[0m23:58:08.558369 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20483d5d-bd7c-4fe7-886a-3857aaeb2501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B2D217D0>]}
[0m23:58:08.558881 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 20.09s]
[0m23:58:08.559883 [debug] [Thread-4 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m23:58:08.561885 [debug] [MainThread]: On master: COMMIT
[0m23:58:08.561885 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:08.561885 [debug] [MainThread]: On master: COMMIT
[0m23:58:08.562882 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:08.587455 [debug] [MainThread]: SQL status: COMMIT in 0.025 seconds
[0m23:58:08.588227 [debug] [MainThread]: On master: Close
[0m23:58:08.588915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:08.588915 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m23:58:08.589433 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m23:58:08.589433 [debug] [MainThread]: Connection 'model.my_dbt.hello' was properly closed.
[0m23:58:08.590439 [debug] [MainThread]: Connection 'model.my_dbt.stg_yellow_tripdata' was properly closed.
[0m23:58:08.590439 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m23:58:08.591436 [info ] [MainThread]: 
[0m23:58:08.593306 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 29.94 seconds (29.94s).
[0m23:58:08.594305 [debug] [MainThread]: Command end result
[0m23:58:08.616939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:58:08.620722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:58:08.628794 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m23:58:08.629317 [info ] [MainThread]: 
[0m23:58:08.630430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:58:08.630988 [info ] [MainThread]: 
[0m23:58:08.631501 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:58:08.633065 [debug] [MainThread]: Command `dbt run` succeeded at 23:58:08.632543 after 30.81 seconds
[0m23:58:08.633579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1AA398C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1B1196E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1AA6A1690>]}
[0m23:58:08.634091 [debug] [MainThread]: Flushing usage events
[0m23:58:08.919511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:28.997090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDA479910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDA49A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDA4992D0>]}


============================== 23:58:29.001090 | cc74d62f-7809-4254-a26c-d8864fdbabb7 ==============================
[0m23:58:29.001090 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:58:29.002091 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m23:58:29.171030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDB6CAD90>]}
[0m23:58:29.225222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD6CC8110>]}
[0m23:58:29.227197 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:58:29.449953 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:58:29.582551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:58:29.582551 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\mart_payment_type.sql
[0m23:58:29.583526 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\mart_daily_revenue.sql
[0m23:58:29.820313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDBB96B50>]}
[0m23:58:29.953826 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m23:58:29.955954 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m23:58:29.978770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDB704390>]}
[0m23:58:29.979770 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 464 macros
[0m23:58:29.979770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDB6D5250>]}
[0m23:58:29.981796 [info ] [MainThread]: 
[0m23:58:29.982768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:58:29.982768 [info ] [MainThread]: 
[0m23:58:29.983768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:29.987769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m23:58:30.050601 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m23:58:30.050601 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m23:58:30.050601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:30.067998 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m23:58:30.068999 [debug] [ThreadPool]: On list_de_db: Close
[0m23:58:30.071095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m23:58:30.076961 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m23:58:30.077230 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:58:30.077739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:30.093459 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.016 seconds
[0m23:58:30.115477 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m23:58:30.117990 [debug] [ThreadPool]: On list_de_db_public: Close
[0m23:58:30.127913 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:30.128494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:58:30.128494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:30.162553 [debug] [MainThread]: SQL status: SELECT 0 in 0.034 seconds
[0m23:58:30.163527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDBA22790>]}
[0m23:58:30.164525 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:30.166553 [debug] [MainThread]: On master: COMMIT
[0m23:58:30.166553 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:30.166553 [debug] [MainThread]: On master: COMMIT
[0m23:58:30.169525 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:58:30.169525 [debug] [MainThread]: On master: Close
[0m23:58:30.174408 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m23:58:30.175014 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m23:58:30.175014 [info ] [Thread-1 (]: 1 of 5 START sql table model public.hello ...................................... [RUN]
[0m23:58:30.176011 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m23:58:30.176011 [info ] [Thread-2 (]: 2 of 5 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m23:58:30.177038 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m23:58:30.178037 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m23:58:30.183714 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m23:58:30.183714 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m23:58:30.187616 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m23:58:30.187616 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m23:58:30.210657 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m23:58:30.222015 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m23:58:30.226616 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m23:58:30.227615 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:58:30.228641 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m23:58:30.228641 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:58:30.228641 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:30.229644 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m23:58:30.230616 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:58:30.244939 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m23:58:30.253604 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:58:30.253604 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m23:58:30.256169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:58:30.258703 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:58:30.259727 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m23:58:30.261346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:58:30.274502 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:58:30.274502 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:58:30.275502 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m23:58:30.365601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.090 seconds
[0m23:58:30.371600 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m23:58:30.376114 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m23:58:30.376114 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m23:58:30.432653 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.055 seconds
[0m23:58:30.435164 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m23:58:30.439052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDB8F16D0>]}
[0m23:58:30.440057 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.26s]
[0m23:58:30.442176 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m23:58:55.066010 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 24.836 seconds
[0m23:58:55.072009 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:58:55.073010 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m23:58:56.145713 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 1.072 seconds
[0m23:58:56.150306 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:58:56.150540 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m23:58:56.153071 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:58:56.155254 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:58:56.155966 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:58:56.156477 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m23:58:56.168635 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m23:58:56.172286 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m23:58:56.173108 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m23:58:56.173618 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m23:58:56.260305 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.086 seconds
[0m23:58:56.269624 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m23:58:56.271048 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDC03D390>]}
[0m23:58:56.272095 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 26.09s]
[0m23:58:56.273095 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m23:58:56.275094 [debug] [Thread-4 (]: Began running node model.my_dbt.fct_yellow_trips
[0m23:58:56.277231 [info ] [Thread-4 (]: 3 of 5 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m23:58:56.278445 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips'
[0m23:58:56.278961 [debug] [Thread-4 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m23:58:56.282969 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m23:58:56.284045 [debug] [Thread-4 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m23:58:56.290809 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m23:58:56.292809 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m23:58:56.293808 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m23:58:56.293808 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:00:21.657854 [debug] [Thread-4 (]: SQL status: SELECT 3475226 in 85.363 seconds
[0m00:00:21.662965 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:21.664010 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m00:00:22.721096 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 1.056 seconds
[0m00:00:22.725183 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:22.726189 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m00:00:22.728520 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:22.730368 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m00:00:22.731613 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:22.732067 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m00:00:22.745859 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m00:00:22.749289 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m00:00:22.750960 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:22.751386 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m00:00:22.843036 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.091 seconds
[0m00:00:22.844579 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: Close
[0m00:00:22.845673 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDC4B04D0>]}
[0m00:00:22.846780 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 86.57s]
[0m00:00:22.848594 [debug] [Thread-4 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m00:00:22.850222 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_daily_revenue
[0m00:00:22.850441 [debug] [Thread-2 (]: Began running node model.my_dbt.mart_payment_type
[0m00:00:22.851480 [info ] [Thread-1 (]: 4 of 5 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m00:00:22.852753 [info ] [Thread-2 (]: 5 of 5 START sql table model public.mart_payment_type .......................... [RUN]
[0m00:00:22.854269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.hello, now model.my_dbt.mart_daily_revenue)
[0m00:00:22.855313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_payment_type)
[0m00:00:22.856371 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m00:00:22.856927 [debug] [Thread-2 (]: Began compiling node model.my_dbt.mart_payment_type
[0m00:00:22.860727 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m00:00:22.865536 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m00:00:22.866468 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m00:00:22.873468 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m00:00:22.874472 [debug] [Thread-2 (]: Began executing node model.my_dbt.mart_payment_type
[0m00:00:22.879469 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m00:00:22.881469 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:22.882470 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m00:00:22.883473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:22.885471 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:22.887472 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m00:00:22.888471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:00:23.826511 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.937 seconds
[0m00:00:23.832622 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:23.833620 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m00:00:23.882041 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.998 seconds
[0m00:00:23.888044 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:23.889042 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.055 seconds
[0m00:00:23.890042 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m00:00:23.892044 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m00:00:23.894043 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:23.895089 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m00:00:23.932763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m00:00:23.935796 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m00:00:23.936800 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:23.937797 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m00:00:24.018751 [debug] [Thread-2 (]: SQL status: COMMIT in 0.123 seconds
[0m00:00:24.028747 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m00:00:24.030751 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:24.032748 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m00:00:24.049175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.110 seconds
[0m00:00:24.190746 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m00:00:24.191958 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:00:24.193623 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:24.195734 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: Close
[0m00:00:24.196785 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m00:00:24.197829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDC4C2990>]}
[0m00:00:24.199910 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m00:00:24.199390 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 1.34s]
[0m00:00:24.202425 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: Close
[0m00:00:24.203425 [debug] [Thread-2 (]: Finished running node model.my_dbt.mart_payment_type
[0m00:00:24.205421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc74d62f-7809-4254-a26c-d8864fdbabb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDC029D10>]}
[0m00:00:24.207423 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.mart_daily_revenue .................... [[32mSELECT 33[0m in 1.35s]
[0m00:00:24.210070 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m00:00:24.211629 [debug] [MainThread]: On master: COMMIT
[0m00:00:24.212156 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:24.213942 [debug] [MainThread]: On master: COMMIT
[0m00:00:24.214976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:24.232164 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m00:00:24.232683 [debug] [MainThread]: On master: Close
[0m00:00:24.233192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:24.233192 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m00:00:24.234191 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m00:00:24.235192 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m00:00:24.236191 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m00:00:24.236191 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m00:00:24.238257 [info ] [MainThread]: 
[0m00:00:24.238776 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 54.25 seconds (114.25s).
[0m00:00:24.240336 [debug] [MainThread]: Command end result
[0m00:00:24.264103 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m00:00:24.268225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m00:00:24.275227 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m00:00:24.276224 [info ] [MainThread]: 
[0m00:00:24.277222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:24.277222 [info ] [MainThread]: 
[0m00:00:24.278221 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:00:24.279221 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:24.279221 after 115.35 seconds
[0m00:00:24.279221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD36A8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDA278F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACD95EA890>]}
[0m00:00:24.280221 [debug] [MainThread]: Flushing usage events
[0m00:00:24.749026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:36:12.397752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6E54A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6E59B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6E59B750>]}


============================== 00:36:12.404478 | 66a4429d-524d-49bd-997a-30127cdf349b ==============================
[0m00:36:12.404478 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:36:12.405472 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m00:36:12.650500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6E5A52D0>]}
[0m00:36:12.729269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6ADA8190>]}
[0m00:36:12.741955 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:36:13.186569 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:36:13.476311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:36:13.477332 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\mart_daily_revenue.sql
[0m00:36:13.887180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6F7CD6D0>]}
[0m00:36:14.103948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m00:36:14.107952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m00:36:14.148854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6FC1B5D0>]}
[0m00:36:14.149853 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 464 macros
[0m00:36:14.150857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6FC11290>]}
[0m00:36:14.154710 [info ] [MainThread]: 
[0m00:36:14.154710 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:36:14.155709 [info ] [MainThread]: 
[0m00:36:14.156712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:36:14.164712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m00:36:14.252902 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m00:36:14.253902 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m00:36:14.253902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:14.279157 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m00:36:14.281711 [debug] [ThreadPool]: On list_de_db: Close
[0m00:36:14.285475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m00:36:14.294039 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m00:36:14.295043 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:36:14.296045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:14.319149 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.022 seconds
[0m00:36:14.321790 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m00:36:14.326799 [debug] [ThreadPool]: On list_de_db_public: Close
[0m00:36:14.341530 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:14.342532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:36:14.343528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:36:14.365335 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m00:36:14.366883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6FC55690>]}
[0m00:36:14.368554 [debug] [MainThread]: On master: ROLLBACK
[0m00:36:14.371384 [debug] [MainThread]: On master: COMMIT
[0m00:36:14.371901 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:14.372420 [debug] [MainThread]: On master: COMMIT
[0m00:36:14.375026 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:36:14.376249 [debug] [MainThread]: On master: Close
[0m00:36:14.383523 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m00:36:14.384044 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m00:36:14.385517 [info ] [Thread-1 (]: 1 of 5 START sql table model public.hello ...................................... [RUN]
[0m00:36:14.387031 [info ] [Thread-2 (]: 2 of 5 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m00:36:14.388031 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m00:36:14.389030 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m00:36:14.389030 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m00:36:14.390029 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m00:36:14.399028 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m00:36:14.403703 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m00:36:14.405700 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m00:36:14.415832 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m00:36:14.469046 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m00:36:14.481040 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m00:36:14.477040 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m00:36:14.482044 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m00:36:14.483047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:36:14.488044 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:36:14.491040 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m00:36:14.492042 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:36:14.612232 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.129 seconds
[0m00:36:14.631489 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m00:36:14.632259 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m00:36:14.637986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m00:36:14.645888 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m00:36:14.646631 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m00:36:14.652917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m00:36:14.682187 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m00:36:14.683228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m00:36:14.684257 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m00:36:14.714107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m00:36:14.726590 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m00:36:14.737258 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m00:36:14.738260 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m00:36:14.759622 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m00:36:14.763985 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m00:36:14.769100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6FCC9E50>]}
[0m00:36:14.771144 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.38s]
[0m00:36:14.772841 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m00:36:30.878598 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 16.386 seconds
[0m00:36:30.884905 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:36:30.885954 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m00:36:30.888562 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:36:30.892589 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:36:30.893588 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m00:36:30.895980 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:36:30.898827 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m00:36:30.899872 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:36:30.900394 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m00:36:30.965740 [debug] [Thread-2 (]: SQL status: COMMIT in 0.065 seconds
[0m00:36:30.970599 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m00:36:30.972390 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:36:30.973641 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m00:36:31.170512 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.196 seconds
[0m00:36:31.172583 [debug] [Thread-2 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m00:36:31.174532 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A70076990>]}
[0m00:36:31.176283 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 16.79s]
[0m00:36:31.177877 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m00:36:31.179387 [debug] [Thread-4 (]: Began running node model.my_dbt.fct_yellow_trips
[0m00:36:31.181389 [info ] [Thread-4 (]: 3 of 5 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m00:36:31.183386 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips'
[0m00:36:31.184391 [debug] [Thread-4 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m00:36:31.189387 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m00:36:31.192387 [debug] [Thread-4 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m00:36:31.198387 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m00:36:31.199387 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:36:31.200387 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m00:36:31.201392 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:36:58.113138 [debug] [Thread-4 (]: SQL status: SELECT 3475226 in 26.911 seconds
[0m00:36:58.120492 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:36:58.121034 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m00:36:58.122659 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:36:58.127170 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:36:58.127170 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m00:36:58.130193 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:36:58.132303 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m00:36:58.132961 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:36:58.133504 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m00:36:58.246046 [debug] [Thread-4 (]: SQL status: COMMIT in 0.112 seconds
[0m00:36:58.249045 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m00:36:58.250045 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:36:58.250045 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m00:36:58.461829 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.211 seconds
[0m00:36:58.464832 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips: Close
[0m00:36:58.465829 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A705BEFD0>]}
[0m00:36:58.465829 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 27.28s]
[0m00:36:58.467831 [debug] [Thread-4 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m00:36:58.470835 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_daily_revenue
[0m00:36:58.470835 [debug] [Thread-2 (]: Began running node model.my_dbt.mart_payment_type
[0m00:36:58.472624 [info ] [Thread-1 (]: 4 of 5 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m00:36:58.473638 [info ] [Thread-2 (]: 5 of 5 START sql table model public.mart_payment_type .......................... [RUN]
[0m00:36:58.475636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.hello, now model.my_dbt.mart_daily_revenue)
[0m00:36:58.476644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_payment_type)
[0m00:36:58.477623 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m00:36:58.479639 [debug] [Thread-2 (]: Began compiling node model.my_dbt.mart_payment_type
[0m00:36:58.482811 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m00:36:58.487028 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m00:36:58.487718 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m00:36:58.492840 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m00:36:58.493840 [debug] [Thread-2 (]: Began executing node model.my_dbt.mart_payment_type
[0m00:36:58.498839 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m00:36:58.499227 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:36:58.499742 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    round(sum(total_amount), 2) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m00:36:58.500250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:36:58.500785 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:36:58.503544 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m00:36:58.504611 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:36:58.520219 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 15:     round(sum(total_amount), 2) as total_revenue,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:36:58.521251 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: ROLLBACK
[0m00:36:58.522818 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: Close
[0m00:36:58.530841 [debug] [Thread-1 (]: Database Error in model mart_daily_revenue (models\marts\mart_daily_revenue.sql)
  function round(double precision, integer) does not exist
  LINE 15:     round(sum(total_amount), 2) as total_revenue,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt\models\marts\mart_daily_revenue.sql
[0m00:36:58.532382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6FC38810>]}
[0m00:36:58.532997 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model public.mart_daily_revenue ................ [[31mERROR[0m in 0.06s]
[0m00:36:58.534556 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m00:36:58.536148 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.mart_daily_revenue' to be skipped because of status 'error'.  Reason: Database Error in model mart_daily_revenue (models\marts\mart_daily_revenue.sql)
  function round(double precision, integer) does not exist
  LINE 15:     round(sum(total_amount), 2) as total_revenue,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt\models\marts\mart_daily_revenue.sql.
[0m00:36:59.106643 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.602 seconds
[0m00:36:59.112811 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:36:59.113876 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m00:36:59.115963 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:36:59.120498 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:36:59.120498 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m00:36:59.124121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:36:59.126742 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m00:36:59.127782 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:36:59.128832 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m00:36:59.220258 [debug] [Thread-2 (]: SQL status: COMMIT in 0.091 seconds
[0m00:36:59.222839 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m00:36:59.223883 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:36:59.224928 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m00:36:59.232842 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m00:36:59.234353 [debug] [Thread-2 (]: On model.my_dbt.mart_payment_type: Close
[0m00:36:59.236356 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66a4429d-524d-49bd-997a-30127cdf349b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A70587C10>]}
[0m00:36:59.237355 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 0.76s]
[0m00:36:59.238351 [debug] [Thread-2 (]: Finished running node model.my_dbt.mart_payment_type
[0m00:36:59.239866 [debug] [MainThread]: On master: COMMIT
[0m00:36:59.240868 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:59.241866 [debug] [MainThread]: On master: COMMIT
[0m00:36:59.243249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:36:59.281536 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m00:36:59.282773 [debug] [MainThread]: On master: Close
[0m00:36:59.283386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:36:59.284001 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m00:36:59.284517 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m00:36:59.285517 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m00:36:59.286520 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m00:36:59.287517 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m00:36:59.288879 [info ] [MainThread]: 
[0m00:36:59.289935 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 45.13 seconds (45.13s).
[0m00:36:59.293219 [debug] [MainThread]: Command end result
[0m00:36:59.326832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m00:36:59.330836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m00:36:59.337831 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m00:36:59.338832 [info ] [MainThread]: 
[0m00:36:59.339834 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:36:59.340835 [info ] [MainThread]: 
[0m00:36:59.340835 [error] [MainThread]: [31mFailure in model mart_daily_revenue (models\marts\mart_daily_revenue.sql)[0m
[0m00:36:59.341835 [error] [MainThread]:   Database Error in model mart_daily_revenue (models\marts\mart_daily_revenue.sql)
  function round(double precision, integer) does not exist
  LINE 15:     round(sum(total_amount), 2) as total_revenue,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\my_dbt\models\marts\mart_daily_revenue.sql
[0m00:36:59.342833 [info ] [MainThread]: 
[0m00:36:59.343832 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\mart_daily_revenue.sql
[0m00:36:59.343832 [info ] [MainThread]: 
[0m00:36:59.344833 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m00:36:59.346836 [debug] [MainThread]: Command `dbt run` failed at 00:36:59.345837 after 47.04 seconds
[0m00:36:59.347837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A676F8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A6E54A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A70064D50>]}
[0m00:36:59.347837 [debug] [MainThread]: Flushing usage events
[0m00:36:59.729591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:04:44.339720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5512A790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF55137A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF55152790>]}


============================== 10:04:44.347993 | 794ecf04-688b-475a-bf73-135ccf1795dc ==============================
[0m10:04:44.347993 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:04:44.348668 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_taxi_zones', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m10:04:44.568200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '794ecf04-688b-475a-bf73-135ccf1795dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5637AA10>]}
[0m10:04:44.623594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '794ecf04-688b-475a-bf73-135ccf1795dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF5197BED0>]}
[0m10:04:44.624597 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:04:44.968474 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:04:46.136723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m10:04:46.137305 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\stg_taxi_zones.sql
[0m10:04:46.137305 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\sources.yml
[0m10:04:46.138332 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\schema.yml
[0m10:04:46.138332 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\mart_daily_revenue.sql
[0m10:04:46.633520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '794ecf04-688b-475a-bf73-135ccf1795dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF562C2650>]}
[0m10:04:46.702605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:04:46.718279 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:04:46.763661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '794ecf04-688b-475a-bf73-135ccf1795dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF56B2BF10>]}
[0m10:04:46.764662 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 464 macros
[0m10:04:46.765153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '794ecf04-688b-475a-bf73-135ccf1795dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF56A63FD0>]}
[0m10:04:46.766732 [info ] [MainThread]: 
[0m10:04:46.767729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:04:46.767729 [info ] [MainThread]: 
[0m10:04:46.768729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:04:46.770989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m10:04:48.522361 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m10:04:48.523361 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m10:04:48.523361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:48.541830 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m10:04:48.543407 [debug] [ThreadPool]: On list_de_db: Close
[0m10:04:48.548889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m10:04:48.554401 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m10:04:48.555030 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:04:48.555566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:48.590420 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.035 seconds
[0m10:04:48.593262 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m10:04:48.594548 [debug] [ThreadPool]: On list_de_db_public: Close
[0m10:04:48.607774 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:48.608327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:04:48.608949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:48.637837 [debug] [MainThread]: SQL status: SELECT 0 in 0.029 seconds
[0m10:04:48.638838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '794ecf04-688b-475a-bf73-135ccf1795dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF56B395D0>]}
[0m10:04:48.639861 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:48.641446 [debug] [MainThread]: On master: COMMIT
[0m10:04:48.641446 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:48.641446 [debug] [MainThread]: On master: COMMIT
[0m10:04:48.644208 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:04:48.644798 [debug] [MainThread]: On master: Close
[0m10:04:48.653288 [debug] [Thread-1 (]: Began running node model.my_dbt.stg_taxi_zones
[0m10:04:48.655097 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_taxi_zones ............................. [RUN]
[0m10:04:48.657019 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.stg_taxi_zones'
[0m10:04:48.657580 [debug] [Thread-1 (]: Began compiling node model.my_dbt.stg_taxi_zones
[0m10:04:48.667243 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.stg_taxi_zones"
[0m10:04:48.668382 [debug] [Thread-1 (]: Began executing node model.my_dbt.stg_taxi_zones
[0m10:04:48.706194 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.stg_taxi_zones"
[0m10:04:48.707256 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m10:04:48.707772 [debug] [Thread-1 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */

  
    

  create  table "de_db"."public"."stg_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select *
    from "de_db"."public"."taxi_zones_raw"
),

renamed as (
    select
        "LocationID"::int as location_id,
        "Borough"::text   as borough,
        "Zone"::text      as zone,
        "service_zone"::text as service_zone
    from source
)

select * from renamed
  );
  
[0m10:04:48.708288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:48.743552 [debug] [Thread-1 (]: SQL status: SELECT 265 in 0.035 seconds
[0m10:04:48.756353 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m10:04:48.757347 [debug] [Thread-1 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m10:04:48.759470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:04:48.774148 [debug] [Thread-1 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m10:04:48.774688 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m10:04:48.775230 [debug] [Thread-1 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m10:04:48.780832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:04:48.787616 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."stg_taxi_zones__dbt_backup"
[0m10:04:48.792782 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m10:04:48.793250 [debug] [Thread-1 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
drop table if exists "de_db"."public"."stg_taxi_zones__dbt_backup" cascade
[0m10:04:48.794255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:04:48.796255 [debug] [Thread-1 (]: On model.my_dbt.stg_taxi_zones: Close
[0m10:04:48.799798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '794ecf04-688b-475a-bf73-135ccf1795dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF568040D0>]}
[0m10:04:48.800799 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_taxi_zones ........................ [[32mSELECT 265[0m in 0.14s]
[0m10:04:48.802797 [debug] [Thread-1 (]: Finished running node model.my_dbt.stg_taxi_zones
[0m10:04:48.805011 [debug] [MainThread]: On master: COMMIT
[0m10:04:48.805011 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:48.806011 [debug] [MainThread]: On master: COMMIT
[0m10:04:48.806011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:48.819395 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m10:04:48.819946 [debug] [MainThread]: On master: Close
[0m10:04:48.820481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:48.820957 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m10:04:48.820957 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m10:04:48.821472 [debug] [MainThread]: Connection 'model.my_dbt.stg_taxi_zones' was properly closed.
[0m10:04:48.821987 [info ] [MainThread]: 
[0m10:04:48.822509 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m10:04:48.823544 [debug] [MainThread]: Command end result
[0m10:04:48.844658 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:04:48.847228 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:04:48.852343 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m10:04:48.852343 [info ] [MainThread]: 
[0m10:04:48.853343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:48.853907 [info ] [MainThread]: 
[0m10:04:48.854308 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:04:48.855308 [debug] [MainThread]: Command `dbt run` succeeded at 10:04:48.855308 after 4.60 seconds
[0m10:04:48.855308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF55151450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF551527D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF542AA810>]}
[0m10:04:48.856307 [debug] [MainThread]: Flushing usage events
[0m10:04:49.281885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:04:51.871587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0F739AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0F73A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0F738490>]}


============================== 10:04:51.875124 | 18ce4d14-7c01-4a73-9bcb-ea8e5123106e ==============================
[0m10:04:51.875124 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:04:51.876243 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt test --select stg_taxi_zones', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m10:04:52.042801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18ce4d14-7c01-4a73-9bcb-ea8e5123106e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C108D2B50>]}
[0m10:04:52.097230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18ce4d14-7c01-4a73-9bcb-ea8e5123106e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0F857C50>]}
[0m10:04:52.099135 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:04:52.309620 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:04:52.434669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:04:52.436272 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:04:52.436272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:04:52.476334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18ce4d14-7c01-4a73-9bcb-ea8e5123106e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C109FCE10>]}
[0m10:04:52.551760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:04:52.553735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:04:52.588988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18ce4d14-7c01-4a73-9bcb-ea8e5123106e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C10FBA390>]}
[0m10:04:52.588988 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 464 macros
[0m10:04:52.589996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18ce4d14-7c01-4a73-9bcb-ea8e5123106e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C10E30D50>]}
[0m10:04:52.591022 [info ] [MainThread]: 
[0m10:04:52.592009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:04:52.592828 [info ] [MainThread]: 
[0m10:04:52.593173 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:04:52.597181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m10:04:52.705422 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m10:04:52.706041 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:04:52.706041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:52.722891 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.017 seconds
[0m10:04:52.725626 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m10:04:52.726892 [debug] [ThreadPool]: On list_de_db_public: Close
[0m10:04:52.737043 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:52.738043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:04:52.738043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:52.775522 [debug] [MainThread]: SQL status: SELECT 0 in 0.037 seconds
[0m10:04:52.776381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18ce4d14-7c01-4a73-9bcb-ea8e5123106e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C10E38190>]}
[0m10:04:52.777408 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:52.778866 [debug] [MainThread]: On master: COMMIT
[0m10:04:52.778866 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:52.778866 [debug] [MainThread]: On master: COMMIT
[0m10:04:52.781752 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:04:52.782175 [debug] [MainThread]: On master: Close
[0m10:04:52.786493 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m10:04:52.786493 [debug] [Thread-2 (]: Began running node test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c
[0m10:04:52.787676 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_taxi_zones_location_id .......................... [RUN]
[0m10:04:52.788704 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m10:04:52.787703 [info ] [Thread-2 (]: 2 of 2 START test unique_stg_taxi_zones_location_id ............................ [RUN]
[0m10:04:52.788704 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m10:04:52.789704 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c'
[0m10:04:52.802673 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m10:04:52.804172 [debug] [Thread-2 (]: Began compiling node test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c
[0m10:04:52.809715 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m10:04:52.809715 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m10:04:52.823915 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m10:04:52.824923 [debug] [Thread-2 (]: Began executing node test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c
[0m10:04:52.827554 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m10:04:52.828553 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m10:04:52.828553 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "de_db"."public"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m10:04:52.828553 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:52.829554 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m10:04:52.830528 [debug] [Thread-2 (]: On test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "de_db"."public"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:04:52.830846 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:04:52.845318 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m10:04:52.848695 [debug] [Thread-2 (]: On test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m10:04:52.850333 [debug] [Thread-2 (]: On test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m10:04:52.851023 [info ] [Thread-2 (]: 2 of 2 PASS unique_stg_taxi_zones_location_id .................................. [[32mPASS[0m in 0.06s]
[0m10:04:52.851535 [debug] [Thread-2 (]: Finished running node test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c
[0m10:04:52.854803 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m10:04:52.855950 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m10:04:52.857384 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m10:04:52.857959 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.07s]
[0m10:04:52.858516 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m10:04:52.860554 [debug] [MainThread]: On master: COMMIT
[0m10:04:52.861004 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:52.861400 [debug] [MainThread]: On master: COMMIT
[0m10:04:52.861602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:52.873708 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m10:04:52.874707 [debug] [MainThread]: On master: Close
[0m10:04:52.874707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:52.875708 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m10:04:52.876298 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf' was properly closed.
[0m10:04:52.876416 [debug] [MainThread]: Connection 'test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c' was properly closed.
[0m10:04:52.876416 [info ] [MainThread]: 
[0m10:04:52.877363 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m10:04:52.878514 [debug] [MainThread]: Command end result
[0m10:04:52.899565 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:04:52.901564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:04:52.907367 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m10:04:52.907367 [info ] [MainThread]: 
[0m10:04:52.908375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:52.908375 [info ] [MainThread]: 
[0m10:04:52.909437 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:04:52.910829 [debug] [MainThread]: Command `dbt test` succeeded at 10:04:52.910829 after 1.10 seconds
[0m10:04:52.910829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0F797550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0F794990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0F797350>]}
[0m10:04:52.911827 [debug] [MainThread]: Flushing usage events
[0m10:04:53.187310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:53.049621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AE1CABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AE21AF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AE1F27D0>]}


============================== 10:05:53.054283 | 8c0e3c11-a7b9-4237-861a-c97073812f29 ==============================
[0m10:05:53.054283 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:05:53.055284 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select dim_taxi_zones', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m10:05:53.223483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c0e3c11-a7b9-4237-861a-c97073812f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AE2253D0>]}
[0m10:05:53.277001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c0e3c11-a7b9-4237-861a-c97073812f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AF2CFC50>]}
[0m10:05:53.278975 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:05:53.501387 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:05:53.628083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:05:53.628083 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\dim_taxi_zones.sql
[0m10:05:53.863268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c0e3c11-a7b9-4237-861a-c97073812f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AF8FC650>]}
[0m10:05:53.994029 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:05:53.996655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:05:54.023330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c0e3c11-a7b9-4237-861a-c97073812f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AB113350>]}
[0m10:05:54.024478 [info ] [MainThread]: Found 7 models, 5 data tests, 2 sources, 464 macros
[0m10:05:54.024989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0e3c11-a7b9-4237-861a-c97073812f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AF7B2490>]}
[0m10:05:54.027023 [info ] [MainThread]: 
[0m10:05:54.027988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:05:54.027988 [info ] [MainThread]: 
[0m10:05:54.028988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:54.029989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m10:05:54.096553 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m10:05:54.096553 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m10:05:54.097552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:54.134645 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.037 seconds
[0m10:05:54.135285 [debug] [ThreadPool]: On list_de_db: Close
[0m10:05:54.140391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m10:05:54.144910 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m10:05:54.145927 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:05:54.145927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:54.172052 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.026 seconds
[0m10:05:54.174081 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m10:05:54.176053 [debug] [ThreadPool]: On list_de_db_public: Close
[0m10:05:54.186316 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:54.186899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:05:54.187318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:54.216052 [debug] [MainThread]: SQL status: SELECT 0 in 0.029 seconds
[0m10:05:54.217050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0e3c11-a7b9-4237-861a-c97073812f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AF44E090>]}
[0m10:05:54.218027 [debug] [MainThread]: On master: ROLLBACK
[0m10:05:54.219024 [debug] [MainThread]: On master: COMMIT
[0m10:05:54.219024 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:54.220024 [debug] [MainThread]: On master: COMMIT
[0m10:05:54.221687 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:05:54.221687 [debug] [MainThread]: On master: Close
[0m10:05:54.226687 [debug] [Thread-1 (]: Began running node model.my_dbt.dim_taxi_zones
[0m10:05:54.227314 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_taxi_zones ............................. [RUN]
[0m10:05:54.228313 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.dim_taxi_zones'
[0m10:05:54.228313 [debug] [Thread-1 (]: Began compiling node model.my_dbt.dim_taxi_zones
[0m10:05:54.234342 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.dim_taxi_zones"
[0m10:05:54.236111 [debug] [Thread-1 (]: Began executing node model.my_dbt.dim_taxi_zones
[0m10:05:54.267030 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.dim_taxi_zones"
[0m10:05:54.268029 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m10:05:54.268029 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */

  
    

  create  table "de_db"."public"."dim_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with zones as (
    select *
    from "de_db"."public"."stg_taxi_zones"
)

select
    location_id,
    borough,
    zone,
    service_zone
from zones
  );
  
[0m10:05:54.269005 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:05:54.325939 [debug] [Thread-1 (]: SQL status: SELECT 265 in 0.057 seconds
[0m10:05:54.334984 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m10:05:54.335404 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones__dbt_tmp" rename to "dim_taxi_zones"
[0m10:05:54.337042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:05:54.349370 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m10:05:54.350371 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m10:05:54.350371 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m10:05:54.362856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:05:54.369285 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."dim_taxi_zones__dbt_backup"
[0m10:05:54.373588 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m10:05:54.374129 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
drop table if exists "de_db"."public"."dim_taxi_zones__dbt_backup" cascade
[0m10:05:54.376404 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:05:54.378527 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: Close
[0m10:05:54.380210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0e3c11-a7b9-4237-861a-c97073812f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AF8E0050>]}
[0m10:05:54.381823 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_taxi_zones ........................ [[32mSELECT 265[0m in 0.15s]
[0m10:05:54.381960 [debug] [Thread-1 (]: Finished running node model.my_dbt.dim_taxi_zones
[0m10:05:54.383985 [debug] [MainThread]: On master: COMMIT
[0m10:05:54.383985 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:54.383985 [debug] [MainThread]: On master: COMMIT
[0m10:05:54.384989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:05:54.408343 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m10:05:54.408852 [debug] [MainThread]: On master: Close
[0m10:05:54.409564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:54.410096 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m10:05:54.410102 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m10:05:54.410102 [debug] [MainThread]: Connection 'model.my_dbt.dim_taxi_zones' was properly closed.
[0m10:05:54.411123 [info ] [MainThread]: 
[0m10:05:54.411698 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m10:05:54.412238 [debug] [MainThread]: Command end result
[0m10:05:54.432748 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:05:54.434748 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:05:54.440496 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m10:05:54.440496 [info ] [MainThread]: 
[0m10:05:54.441497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:05:54.441497 [info ] [MainThread]: 
[0m10:05:54.442660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:05:54.444293 [debug] [MainThread]: Command `dbt run` succeeded at 10:05:54.443291 after 1.46 seconds
[0m10:05:54.444293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AE225150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286A7388D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286AE1C8210>]}
[0m10:05:54.444293 [debug] [MainThread]: Flushing usage events
[0m10:05:54.753554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:03.132993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1E0A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1E5AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1E5B450>]}


============================== 10:07:03.137085 | 3e75dea5-aa20-46f3-be63-13b785431a42 ==============================
[0m10:07:03.137085 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:07:03.137964 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_yellow_trips_enriched', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m10:07:03.301972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e75dea5-aa20-46f3-be63-13b785431a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1E40290>]}
[0m10:07:03.355506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e75dea5-aa20-46f3-be63-13b785431a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BE658110>]}
[0m10:07:03.357480 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:07:03.576995 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:07:03.708758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:07:03.709784 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\fct_yellow_trips_enriched.sql
[0m10:07:03.940790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e75dea5-aa20-46f3-be63-13b785431a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C35BF350>]}
[0m10:07:04.065126 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:07:04.067151 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:07:04.092723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e75dea5-aa20-46f3-be63-13b785431a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C308C350>]}
[0m10:07:04.093725 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m10:07:04.093725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e75dea5-aa20-46f3-be63-13b785431a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C33BD1D0>]}
[0m10:07:04.095750 [info ] [MainThread]: 
[0m10:07:04.095750 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:07:04.096725 [info ] [MainThread]: 
[0m10:07:04.096725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:04.098210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m10:07:04.162747 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m10:07:04.163771 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m10:07:04.163771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:04.183331 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m10:07:04.184204 [debug] [ThreadPool]: On list_de_db: Close
[0m10:07:04.190204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m10:07:04.196314 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m10:07:04.196314 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:07:04.197313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:04.214098 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.017 seconds
[0m10:07:04.216795 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m10:07:04.217878 [debug] [ThreadPool]: On list_de_db_public: Close
[0m10:07:04.229147 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:04.229147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:07:04.230147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:04.247777 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m10:07:04.249158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e75dea5-aa20-46f3-be63-13b785431a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C3081DD0>]}
[0m10:07:04.249698 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:04.251495 [debug] [MainThread]: On master: COMMIT
[0m10:07:04.251495 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:04.252068 [debug] [MainThread]: On master: COMMIT
[0m10:07:04.254521 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:07:04.255036 [debug] [MainThread]: On master: Close
[0m10:07:04.259470 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m10:07:04.260028 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m10:07:04.261105 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips_enriched'
[0m10:07:04.261162 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m10:07:04.267803 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m10:07:04.268828 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m10:07:04.302157 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m10:07:04.303487 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m10:07:04.303908 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        do.borough as do_borough,
        do.zone as do_zone,
        do.service_zone as do_service_zone

    from trips t
    left join zones pu on t.pu_location_id = pu.location_id
    left join zones do on t.do_location_id = do.location_id
)

select * from final
  );
  
[0m10:07:04.303908 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:07:04.331453 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "do"
LINE 30:         do.borough as do_borough,
                 ^

[0m10:07:04.332140 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: ROLLBACK
[0m10:07:04.333671 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m10:07:04.444538 [debug] [Thread-1 (]: Database Error in model fct_yellow_trips_enriched (models\marts\fct_yellow_trips_enriched.sql)
  syntax error at or near "do"
  LINE 30:         do.borough as do_borough,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_yellow_trips_enriched.sql
[0m10:07:04.446948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e75dea5-aa20-46f3-be63-13b785431a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C39F42D0>]}
[0m10:07:04.447840 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.fct_yellow_trips_enriched ......... [[31mERROR[0m in 0.18s]
[0m10:07:04.448155 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m10:07:04.449232 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.fct_yellow_trips_enriched' to be skipped because of status 'error'.  Reason: Database Error in model fct_yellow_trips_enriched (models\marts\fct_yellow_trips_enriched.sql)
  syntax error at or near "do"
  LINE 30:         do.borough as do_borough,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_yellow_trips_enriched.sql.
[0m10:07:04.450239 [debug] [MainThread]: On master: COMMIT
[0m10:07:04.451271 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:04.451271 [debug] [MainThread]: On master: COMMIT
[0m10:07:04.451271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:04.480558 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m10:07:04.481124 [debug] [MainThread]: On master: Close
[0m10:07:04.481124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:04.482067 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m10:07:04.482067 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m10:07:04.483067 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m10:07:04.483067 [info ] [MainThread]: 
[0m10:07:04.483067 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m10:07:04.484068 [debug] [MainThread]: Command end result
[0m10:07:04.504685 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:07:04.506690 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:07:04.512386 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m10:07:04.512386 [info ] [MainThread]: 
[0m10:07:04.513394 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:07:04.513745 [info ] [MainThread]: 
[0m10:07:04.514586 [error] [MainThread]: [31mFailure in model fct_yellow_trips_enriched (models\marts\fct_yellow_trips_enriched.sql)[0m
[0m10:07:04.515043 [error] [MainThread]:   Database Error in model fct_yellow_trips_enriched (models\marts\fct_yellow_trips_enriched.sql)
  syntax error at or near "do"
  LINE 30:         do.borough as do_borough,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_yellow_trips_enriched.sql
[0m10:07:04.515043 [info ] [MainThread]: 
[0m10:07:04.516079 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\fct_yellow_trips_enriched.sql
[0m10:07:04.516079 [info ] [MainThread]: 
[0m10:07:04.517077 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:07:04.518077 [debug] [MainThread]: Command `dbt run` failed at 10:07:04.518077 after 1.45 seconds
[0m10:07:04.518077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1E5AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1E5AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BB053650>]}
[0m10:07:04.519050 [debug] [MainThread]: Flushing usage events
[0m10:07:04.831790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:44.449451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B14FAB510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B14FD20D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B14FD0510>]}


============================== 10:10:44.454450 | 733a2fef-8eb8-4566-9394-9a46064be460 ==============================
[0m10:10:44.454450 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:10:44.455449 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_yellow_trips_enriched', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m10:10:44.664194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733a2fef-8eb8-4566-9394-9a46064be460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B14FA8310>]}
[0m10:10:44.731512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '733a2fef-8eb8-4566-9394-9a46064be460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B117F8110>]}
[0m10:10:44.733811 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:10:44.984932 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:10:45.166466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:10:45.167465 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\fct_yellow_trips_enriched.sql
[0m10:10:45.451699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '733a2fef-8eb8-4566-9394-9a46064be460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B1675DED0>]}
[0m10:10:45.617705 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:10:45.621708 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:10:45.664973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '733a2fef-8eb8-4566-9394-9a46064be460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B13AF6D10>]}
[0m10:10:45.665973 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m10:10:45.666973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733a2fef-8eb8-4566-9394-9a46064be460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B11AB3F10>]}
[0m10:10:45.667971 [info ] [MainThread]: 
[0m10:10:45.669972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:45.669972 [info ] [MainThread]: 
[0m10:10:45.670971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:10:45.672970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m10:10:45.746299 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m10:10:45.747300 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m10:10:45.748302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:45.790930 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m10:10:45.793955 [debug] [ThreadPool]: On list_de_db: Close
[0m10:10:45.801822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m10:10:45.808823 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m10:10:45.809828 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:10:45.809828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:45.827199 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.017 seconds
[0m10:10:45.829796 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m10:10:45.831910 [debug] [ThreadPool]: On list_de_db_public: Close
[0m10:10:45.845952 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:45.846468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:10:45.846978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:45.863754 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m10:10:45.865872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733a2fef-8eb8-4566-9394-9a46064be460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B16A69650>]}
[0m10:10:45.865872 [debug] [MainThread]: On master: ROLLBACK
[0m10:10:45.866870 [debug] [MainThread]: On master: COMMIT
[0m10:10:45.867869 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:45.867869 [debug] [MainThread]: On master: COMMIT
[0m10:10:45.869871 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:10:45.870871 [debug] [MainThread]: On master: Close
[0m10:10:45.875871 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m10:10:45.876873 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m10:10:45.877871 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips_enriched'
[0m10:10:45.878871 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m10:10:45.885871 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m10:10:45.887877 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m10:10:45.927461 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m10:10:45.928461 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m10:10:45.929462 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m10:10:45.929462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:11:06.685477 [debug] [Thread-1 (]: SQL status: SELECT 3475226 in 20.756 seconds
[0m10:11:06.696478 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m10:11:06.697480 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m10:11:06.699478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:06.713477 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m10:11:06.714481 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m10:11:06.715480 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m10:11:06.737479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:11:06.745477 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m10:11:06.750476 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m10:11:06.751478 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m10:11:06.753905 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:11:06.756901 [debug] [Thread-1 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m10:11:06.760903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '733a2fef-8eb8-4566-9394-9a46064be460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B16B2BFD0>]}
[0m10:11:06.761903 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fct_yellow_trips_enriched ............. [[32mSELECT 3475226[0m in 20.88s]
[0m10:11:06.762902 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m10:11:06.764904 [debug] [MainThread]: On master: COMMIT
[0m10:11:06.765902 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:06.766901 [debug] [MainThread]: On master: COMMIT
[0m10:11:06.766901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:11:06.784515 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m10:11:06.785030 [debug] [MainThread]: On master: Close
[0m10:11:06.785541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:06.786576 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m10:11:06.786576 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m10:11:06.787566 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m10:11:06.787566 [info ] [MainThread]: 
[0m10:11:06.789025 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.12 seconds (21.12s).
[0m10:11:06.790761 [debug] [MainThread]: Command end result
[0m10:11:06.833266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:11:06.837624 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:11:06.846620 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m10:11:06.847622 [info ] [MainThread]: 
[0m10:11:06.848621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:06.849622 [info ] [MainThread]: 
[0m10:11:06.850620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:11:06.851619 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:06.851619 after 22.48 seconds
[0m10:11:06.852621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B0E148C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B15007250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B15005190>]}
[0m10:11:06.853620 [debug] [MainThread]: Flushing usage events
[0m10:11:07.178466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:43.519912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B338A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B338A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B3388E10>]}


============================== 11:02:43.524784 | 21aad7cb-1205-4328-bfb8-f663eb9ea517 ==============================
[0m11:02:43.524784 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:02:43.525758 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m11:02:43.708755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B451DA10>]}
[0m11:02:43.766375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AFBD8590>]}
[0m11:02:43.768352 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:02:43.991406 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:02:44.138189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:44.139191 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:02:44.139703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:44.181989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B33E4E10>]}
[0m11:02:44.261758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m11:02:44.263749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m11:02:44.290757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4B1FED0>]}
[0m11:02:44.291757 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m11:02:44.292792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4AE8610>]}
[0m11:02:44.293784 [info ] [MainThread]: 
[0m11:02:44.294782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:44.295757 [info ] [MainThread]: 
[0m11:02:44.295757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:44.300658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m11:02:44.434302 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m11:02:44.435303 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m11:02:44.435303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:44.468472 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m11:02:44.470078 [debug] [ThreadPool]: On list_de_db: Close
[0m11:02:44.471131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m11:02:44.477448 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m11:02:44.477773 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:44.478293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:44.514384 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.036 seconds
[0m11:02:44.516435 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m11:02:44.518326 [debug] [ThreadPool]: On list_de_db_public: Close
[0m11:02:44.528121 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:44.529121 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:02:44.530096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:44.561353 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m11:02:44.562345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4A8F510>]}
[0m11:02:44.563345 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:44.564319 [debug] [MainThread]: On master: COMMIT
[0m11:02:44.565319 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:44.565319 [debug] [MainThread]: On master: COMMIT
[0m11:02:44.567319 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:02:44.568320 [debug] [MainThread]: On master: Close
[0m11:02:44.573210 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m11:02:44.573884 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_taxi_zones
[0m11:02:44.574280 [debug] [Thread-3 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m11:02:44.574866 [info ] [Thread-1 (]: 1 of 8 START sql table model public.hello ...................................... [RUN]
[0m11:02:44.575442 [info ] [Thread-2 (]: 2 of 8 START sql table model public.stg_taxi_zones ............................. [RUN]
[0m11:02:44.576954 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m11:02:44.575756 [info ] [Thread-3 (]: 3 of 8 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m11:02:44.577593 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_taxi_zones'
[0m11:02:44.577950 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m11:02:44.578509 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m11:02:44.579021 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_taxi_zones
[0m11:02:44.585640 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m11:02:44.585640 [debug] [Thread-3 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m11:02:44.588666 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_taxi_zones"
[0m11:02:44.592853 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m11:02:44.592853 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m11:02:44.593826 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_taxi_zones
[0m11:02:44.634860 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m11:02:44.634860 [debug] [Thread-3 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m11:02:44.639505 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_taxi_zones"
[0m11:02:44.643505 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m11:02:44.644506 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:02:44.645507 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m11:02:44.645507 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m11:02:44.646506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:44.647507 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m11:02:44.647507 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */

  
    

  create  table "de_db"."public"."stg_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select *
    from "de_db"."public"."taxi_zones_raw"
),

renamed as (
    select
        "LocationID"::int as location_id,
        "Borough"::text   as borough,
        "Zone"::text      as zone,
        "service_zone"::text as service_zone
    from source
)

select * from renamed
  );
  
[0m11:02:44.648506 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m11:02:44.649506 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:02:44.649506 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:02:44.665507 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m11:02:44.675504 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:02:44.676505 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m11:02:44.678507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:44.678507 [debug] [Thread-2 (]: SQL status: SELECT 265 in 0.030 seconds
[0m11:02:44.683022 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:02:44.688249 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m11:02:44.689250 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m11:02:44.690251 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m11:02:44.692391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:44.692907 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:02:44.707898 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m11:02:44.711899 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m11:02:44.712899 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:02:44.712899 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m11:02:44.713899 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m11:02:44.715898 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:44.717899 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m11:02:44.717899 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m11:02:44.718898 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m11:02:44.751755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m11:02:44.758516 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m11:02:44.762906 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m11:02:44.762906 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m11:02:44.814411 [debug] [Thread-2 (]: SQL status: COMMIT in 0.095 seconds
[0m11:02:44.816995 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_taxi_zones__dbt_backup"
[0m11:02:44.818047 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m11:02:44.818557 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
drop table if exists "de_db"."public"."stg_taxi_zones__dbt_backup" cascade
[0m11:02:44.845964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.082 seconds
[0m11:02:44.848503 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m11:02:44.851208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4F23ED0>]}
[0m11:02:44.852074 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.27s]
[0m11:02:44.853147 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m11:02:44.856217 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.037 seconds
[0m11:02:44.858419 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: Close
[0m11:02:44.858960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4E72CD0>]}
[0m11:02:44.860175 [info ] [Thread-2 (]: 2 of 8 OK created sql table model public.stg_taxi_zones ........................ [[32mSELECT 265[0m in 0.28s]
[0m11:02:44.861297 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_taxi_zones
[0m11:02:44.862427 [debug] [Thread-4 (]: Began running node model.my_dbt.dim_taxi_zones
[0m11:02:44.863051 [info ] [Thread-4 (]: 4 of 8 START sql table model public.dim_taxi_zones ............................. [RUN]
[0m11:02:44.863653 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.dim_taxi_zones'
[0m11:02:44.864205 [debug] [Thread-4 (]: Began compiling node model.my_dbt.dim_taxi_zones
[0m11:02:44.867037 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.dim_taxi_zones"
[0m11:02:44.868013 [debug] [Thread-4 (]: Began executing node model.my_dbt.dim_taxi_zones
[0m11:02:44.873011 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.dim_taxi_zones"
[0m11:02:44.874011 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m11:02:44.875011 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */

  
    

  create  table "de_db"."public"."dim_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with zones as (
    select *
    from "de_db"."public"."stg_taxi_zones"
)

select
    location_id,
    borough,
    zone,
    service_zone
from zones
  );
  
[0m11:02:44.875011 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:02:44.948833 [debug] [Thread-4 (]: SQL status: SELECT 265 in 0.074 seconds
[0m11:02:44.952829 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m11:02:44.953830 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones" rename to "dim_taxi_zones__dbt_backup"
[0m11:02:44.954831 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:44.959091 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m11:02:44.959665 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones__dbt_tmp" rename to "dim_taxi_zones"
[0m11:02:44.961435 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:44.963129 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m11:02:44.963637 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m11:02:44.964150 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m11:02:45.284248 [debug] [Thread-4 (]: SQL status: COMMIT in 0.319 seconds
[0m11:02:45.287373 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."dim_taxi_zones__dbt_backup"
[0m11:02:45.289010 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m11:02:45.289010 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
drop table if exists "de_db"."public"."dim_taxi_zones__dbt_backup" cascade
[0m11:02:45.384452 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.094 seconds
[0m11:02:45.385477 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: Close
[0m11:02:45.387261 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4F67290>]}
[0m11:02:45.388261 [info ] [Thread-4 (]: 4 of 8 OK created sql table model public.dim_taxi_zones ........................ [[32mSELECT 265[0m in 0.52s]
[0m11:02:45.389260 [debug] [Thread-4 (]: Finished running node model.my_dbt.dim_taxi_zones
[0m11:03:03.645628 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 18.995 seconds
[0m11:03:03.649236 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m11:03:03.649773 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m11:03:03.652373 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:03:03.657582 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m11:03:03.658198 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m11:03:03.659561 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:03:03.661525 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m11:03:03.662037 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m11:03:03.662130 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m11:03:03.723840 [debug] [Thread-3 (]: SQL status: COMMIT in 0.061 seconds
[0m11:03:03.726787 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m11:03:03.727669 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m11:03:03.728078 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m11:03:03.743384 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.015 seconds
[0m11:03:03.745991 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m11:03:03.747460 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B53985D0>]}
[0m11:03:03.748524 [info ] [Thread-3 (]: 3 of 8 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 19.17s]
[0m11:03:03.750133 [debug] [Thread-3 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m11:03:03.752853 [debug] [Thread-2 (]: Began running node model.my_dbt.fct_yellow_trips
[0m11:03:03.754052 [info ] [Thread-2 (]: 5 of 8 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m11:03:03.755050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_taxi_zones, now model.my_dbt.fct_yellow_trips)
[0m11:03:03.757053 [debug] [Thread-2 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m11:03:03.760749 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m11:03:03.763745 [debug] [Thread-2 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m11:03:03.771574 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m11:03:03.775571 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m11:03:03.777573 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m11:03:03.778574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:04:12.277496 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 68.499 seconds
[0m11:04:12.281529 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m11:04:12.282175 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m11:04:12.283701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:12.286965 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m11:04:12.287508 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m11:04:12.289752 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:04:12.291438 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m11:04:12.291968 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m11:04:12.291968 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m11:04:12.551050 [debug] [Thread-2 (]: SQL status: COMMIT in 0.258 seconds
[0m11:04:12.553077 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m11:04:12.555051 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m11:04:12.555051 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m11:04:12.750943 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.195 seconds
[0m11:04:12.752266 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: Close
[0m11:04:12.753391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4DFE890>]}
[0m11:04:12.754458 [info ] [Thread-2 (]: 5 of 8 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 69.00s]
[0m11:04:12.755492 [debug] [Thread-2 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m11:04:12.756590 [debug] [Thread-4 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m11:04:12.756590 [debug] [Thread-3 (]: Began running node model.my_dbt.mart_daily_revenue
[0m11:04:12.757528 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_payment_type
[0m11:04:12.757528 [info ] [Thread-4 (]: 6 of 8 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m11:04:12.758555 [info ] [Thread-3 (]: 7 of 8 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m11:04:12.759527 [info ] [Thread-1 (]: 8 of 8 START sql table model public.mart_payment_type .......................... [RUN]
[0m11:04:12.759527 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt.dim_taxi_zones, now model.my_dbt.fct_yellow_trips_enriched)
[0m11:04:12.760490 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_daily_revenue)
[0m11:04:12.760490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.hello, now model.my_dbt.mart_payment_type)
[0m11:04:12.761489 [debug] [Thread-4 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m11:04:12.761489 [debug] [Thread-3 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m11:04:12.762489 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_payment_type
[0m11:04:12.765811 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m11:04:12.768835 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m11:04:12.771076 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m11:04:12.772076 [debug] [Thread-4 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m11:04:12.773074 [debug] [Thread-3 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m11:04:12.780178 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m11:04:12.780178 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_payment_type
[0m11:04:12.784179 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m11:04:12.789551 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m11:04:12.790552 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m11:04:12.790552 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m11:04:12.791548 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m11:04:12.791548 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:04:12.792577 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m11:04:12.792577 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m11:04:12.793788 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m11:04:12.794360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:04:12.795008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:13.976843 [debug] [Thread-1 (]: SQL status: SELECT 6 in 1.182 seconds
[0m11:04:13.982844 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m11:04:13.983842 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m11:04:13.986841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:13.991848 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m11:04:13.992845 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m11:04:13.995847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:13.998852 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m11:04:13.999852 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m11:04:14.000841 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m11:04:14.241725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.241 seconds
[0m11:04:14.246722 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m11:04:14.248722 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m11:04:14.248722 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m11:04:14.415817 [debug] [Thread-3 (]: SQL status: SELECT 33 in 1.621 seconds
[0m11:04:14.416388 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.166 seconds
[0m11:04:14.420496 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m11:04:14.423305 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: Close
[0m11:04:14.423818 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m11:04:14.425020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B53D3450>]}
[0m11:04:14.426114 [info ] [Thread-1 (]: 8 of 8 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 1.66s]
[0m11:04:14.426786 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_payment_type
[0m11:04:14.427306 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:14.432673 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m11:04:14.433819 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m11:04:14.436671 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:04:14.438388 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m11:04:14.439439 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m11:04:14.439491 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m11:04:14.732390 [debug] [Thread-3 (]: SQL status: COMMIT in 0.292 seconds
[0m11:04:14.735491 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m11:04:14.736213 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m11:04:14.736806 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m11:04:15.038212 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.301 seconds
[0m11:04:15.040456 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: Close
[0m11:04:15.041619 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4FAE350>]}
[0m11:04:15.042654 [info ] [Thread-3 (]: 7 of 8 OK created sql table model public.mart_daily_revenue .................... [[32mSELECT 33[0m in 2.28s]
[0m11:04:15.043830 [debug] [Thread-3 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m11:07:15.517904 [debug] [Thread-4 (]: SQL status: SELECT 3475226 in 182.726 seconds
[0m11:07:15.521903 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m11:07:15.522904 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched" rename to "fct_yellow_trips_enriched__dbt_backup"
[0m11:07:15.524902 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:07:15.527902 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m11:07:15.528903 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m11:07:15.529902 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:07:15.531902 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m11:07:15.531902 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m11:07:15.532903 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m11:07:15.611574 [debug] [Thread-4 (]: SQL status: COMMIT in 0.079 seconds
[0m11:07:15.616574 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m11:07:15.617575 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m11:07:15.617575 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m11:07:15.884325 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.265 seconds
[0m11:07:15.885405 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m11:07:15.886846 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21aad7cb-1205-4328-bfb8-f663eb9ea517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B4E64090>]}
[0m11:07:15.887358 [info ] [Thread-4 (]: 6 of 8 OK created sql table model public.fct_yellow_trips_enriched ............. [[32mSELECT 3475226[0m in 183.13s]
[0m11:07:15.888356 [debug] [Thread-4 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m11:07:15.890356 [debug] [MainThread]: On master: COMMIT
[0m11:07:15.890356 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:15.891357 [debug] [MainThread]: On master: COMMIT
[0m11:07:15.891357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:15.906356 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m11:07:15.906356 [debug] [MainThread]: On master: Close
[0m11:07:15.907356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:15.907356 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m11:07:15.907356 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m11:07:15.908359 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m11:07:15.908359 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m11:07:15.909356 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m11:07:15.909356 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m11:07:15.909356 [info ] [MainThread]: 
[0m11:07:15.910357 [info ] [MainThread]: Finished running 8 table models in 0 hours 4 minutes and 31.61 seconds (271.61s).
[0m11:07:15.912357 [debug] [MainThread]: Command end result
[0m11:07:15.934662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m11:07:15.938663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m11:07:15.944662 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m11:07:15.945664 [info ] [MainThread]: 
[0m11:07:15.946661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:15.946923 [info ] [MainThread]: 
[0m11:07:15.947956 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m11:07:15.948953 [debug] [MainThread]: Command `dbt run` succeeded at 11:07:15.948953 after 272.50 seconds
[0m11:07:15.948953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AC5B8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B33AA390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B33AA190>]}
[0m11:07:15.949952 [debug] [MainThread]: Flushing usage events
[0m11:07:16.327478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:07:22.929549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8955ff1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8955fc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8955fc620>]}


============================== 19:07:22.943468 | c4b953ff-7d2a-4cc8-9d1c-2b8c6fe35bb7 ==============================
[0m19:07:22.943468 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:07:22.945703 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error': 'None', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'quiet': 'False'}
[0m19:07:22.978912 [info ] [MainThread]: dbt version: 1.11.2
[0m19:07:22.979900 [info ] [MainThread]: python version: 3.12.4
[0m19:07:22.980680 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:07:22.981450 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:07:23.075723 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m19:07:23.077327 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m19:07:23.079453 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m19:07:23.081960 [info ] [MainThread]: adapter type: postgres
[0m19:07:23.085600 [info ] [MainThread]: adapter version: 1.10.0
[0m19:07:23.218289 [info ] [MainThread]: Configuration:
[0m19:07:23.219512 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:07:23.220564 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:07:23.221433 [info ] [MainThread]: Required dependencies:
[0m19:07:23.223278 [debug] [MainThread]: Executing "git --help"
[0m19:07:23.225941 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:07:23.228656 [info ] [MainThread]: Connection:
[0m19:07:23.231025 [info ] [MainThread]:   host: host.docker.internal
[0m19:07:23.232481 [info ] [MainThread]:   port: 6543
[0m19:07:23.233722 [info ] [MainThread]:   user: de_user
[0m19:07:23.235237 [info ] [MainThread]:   database: de_db
[0m19:07:23.236466 [info ] [MainThread]:   schema: public
[0m19:07:23.237639 [info ] [MainThread]:   connect_timeout: 10
[0m19:07:23.238823 [info ] [MainThread]:   role: None
[0m19:07:23.239654 [info ] [MainThread]:   search_path: None
[0m19:07:23.240396 [info ] [MainThread]:   keepalives_idle: 0
[0m19:07:23.241503 [info ] [MainThread]:   sslmode: None
[0m19:07:23.243156 [info ] [MainThread]:   sslcert: None
[0m19:07:23.244917 [info ] [MainThread]:   sslkey: None
[0m19:07:23.246163 [info ] [MainThread]:   sslrootcert: None
[0m19:07:23.247055 [info ] [MainThread]:   application_name: dbt
[0m19:07:23.248017 [info ] [MainThread]:   retries: 1
[0m19:07:23.249086 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:07:23.380132 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:07:23.436846 [debug] [MainThread]: Using postgres connection "debug"
[0m19:07:23.440946 [debug] [MainThread]: On debug: select 1 as id
[0m19:07:23.442137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:23.462544 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m19:07:23.464601 [debug] [MainThread]: On debug: Close
[0m19:07:23.466739 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:07:23.469571 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:07:23.471674 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m19:07:23.475711 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.66913253, "process_in_blocks": "3544", "process_kernel_time": 0.369052, "process_mem_max_rss": "119284", "process_out_blocks": "0", "process_user_time": 3.136944}
[0m19:07:23.478937 [debug] [MainThread]: Command `dbt debug` failed at 19:07:23.478458 after 0.67 seconds
[0m19:07:23.480603 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:07:23.481779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8962ba420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8971088c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d89790f7d0>]}
[0m19:07:23.484682 [debug] [MainThread]: Flushing usage events
[0m19:07:23.616887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:07:24.073156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912ce63170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912fe175f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912cf1c560>]}


============================== 19:07:24.079715 | 7df44539-721f-44c0-b453-44182e3d1cf2 ==============================
[0m19:07:24.079715 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:07:24.081811 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:07:24.092190 [info ] [MainThread]: dbt version: 1.11.2
[0m19:07:24.093434 [info ] [MainThread]: python version: 3.12.4
[0m19:07:24.094714 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:07:24.095847 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:07:24.199444 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m19:07:24.200792 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m19:07:24.201957 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m19:07:24.203179 [info ] [MainThread]: adapter type: postgres
[0m19:07:24.204255 [info ] [MainThread]: adapter version: 1.10.0
[0m19:07:24.317995 [info ] [MainThread]: Configuration:
[0m19:07:24.319448 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:07:24.320644 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:07:24.321853 [info ] [MainThread]: Required dependencies:
[0m19:07:24.323030 [debug] [MainThread]: Executing "git --help"
[0m19:07:24.324920 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:07:24.326108 [info ] [MainThread]: Connection:
[0m19:07:24.327295 [info ] [MainThread]:   host: host.docker.internal
[0m19:07:24.328465 [info ] [MainThread]:   port: 6543
[0m19:07:24.329625 [info ] [MainThread]:   user: de_user
[0m19:07:24.330775 [info ] [MainThread]:   database: de_db
[0m19:07:24.331919 [info ] [MainThread]:   schema: public
[0m19:07:24.333017 [info ] [MainThread]:   connect_timeout: 10
[0m19:07:24.334361 [info ] [MainThread]:   role: None
[0m19:07:24.335674 [info ] [MainThread]:   search_path: None
[0m19:07:24.336840 [info ] [MainThread]:   keepalives_idle: 0
[0m19:07:24.337953 [info ] [MainThread]:   sslmode: None
[0m19:07:24.339087 [info ] [MainThread]:   sslcert: None
[0m19:07:24.340299 [info ] [MainThread]:   sslkey: None
[0m19:07:24.341445 [info ] [MainThread]:   sslrootcert: None
[0m19:07:24.342614 [info ] [MainThread]:   application_name: dbt
[0m19:07:24.343769 [info ] [MainThread]:   retries: 1
[0m19:07:24.345047 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:07:24.421794 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:07:24.448823 [debug] [MainThread]: Using postgres connection "debug"
[0m19:07:24.450091 [debug] [MainThread]: On debug: select 1 as id
[0m19:07:24.451507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:24.468654 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m19:07:24.470824 [debug] [MainThread]: On debug: Close
[0m19:07:24.472075 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:07:24.473433 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:07:24.474780 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m19:07:24.476633 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.48112708, "process_in_blocks": "0", "process_kernel_time": 0.282597, "process_mem_max_rss": "119540", "process_out_blocks": "0", "process_user_time": 2.511079}
[0m19:07:24.477732 [debug] [MainThread]: Command `dbt debug` failed at 19:07:24.477615 after 0.48 seconds
[0m19:07:24.479063 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:07:24.480302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912e000cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912cf8f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912c36d580>]}
[0m19:07:24.481605 [debug] [MainThread]: Flushing usage events
[0m19:07:24.534493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:30.926979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c941bda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c95c4efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c940ec980>]}


============================== 19:09:30.935929 | 96c4a6a8-785a-42df-9823-ec307e7bab84 ==============================
[0m19:09:30.935929 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:09:30.937872 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'debug': 'False', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt_profiles', 'warn_error': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:09:30.950110 [info ] [MainThread]: dbt version: 1.11.2
[0m19:09:30.952054 [info ] [MainThread]: python version: 3.12.4
[0m19:09:30.953837 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:09:30.955099 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:09:31.052729 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m19:09:31.054319 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m19:09:31.055185 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m19:09:31.058183 [info ] [MainThread]: adapter type: postgres
[0m19:09:31.061332 [info ] [MainThread]: adapter version: 1.10.0
[0m19:09:31.220526 [info ] [MainThread]: Configuration:
[0m19:09:31.221902 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:09:31.223655 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:09:31.225027 [info ] [MainThread]: Required dependencies:
[0m19:09:31.225905 [debug] [MainThread]: Executing "git --help"
[0m19:09:31.227949 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:09:31.229879 [info ] [MainThread]: Connection:
[0m19:09:31.231144 [info ] [MainThread]:   host: host.docker.internal
[0m19:09:31.232009 [info ] [MainThread]:   port: 6543
[0m19:09:31.232879 [info ] [MainThread]:   user: de_user
[0m19:09:31.234391 [info ] [MainThread]:   database: de_db
[0m19:09:31.235898 [info ] [MainThread]:   schema: public
[0m19:09:31.236993 [info ] [MainThread]:   connect_timeout: 10
[0m19:09:31.237969 [info ] [MainThread]:   role: None
[0m19:09:31.239351 [info ] [MainThread]:   search_path: None
[0m19:09:31.245815 [info ] [MainThread]:   keepalives_idle: 0
[0m19:09:31.246994 [info ] [MainThread]:   sslmode: None
[0m19:09:31.247777 [info ] [MainThread]:   sslcert: None
[0m19:09:31.248573 [info ] [MainThread]:   sslkey: None
[0m19:09:31.249850 [info ] [MainThread]:   sslrootcert: None
[0m19:09:31.251821 [info ] [MainThread]:   application_name: dbt
[0m19:09:31.252838 [info ] [MainThread]:   retries: 1
[0m19:09:31.253765 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:09:31.343463 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:09:31.380030 [debug] [MainThread]: Using postgres connection "debug"
[0m19:09:31.381672 [debug] [MainThread]: On debug: select 1 as id
[0m19:09:31.383118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:31.409625 [debug] [MainThread]: SQL status: SELECT 1 in 0.026 seconds
[0m19:09:31.412940 [debug] [MainThread]: On debug: Close
[0m19:09:31.414165 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:09:31.416005 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:09:31.417962 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m19:09:31.421286 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5887695, "process_in_blocks": "0", "process_kernel_time": 0.626186, "process_mem_max_rss": "119468", "process_out_blocks": "0", "process_user_time": 4.503567}
[0m19:09:31.423509 [debug] [MainThread]: Command `dbt debug` failed at 19:09:31.423278 after 0.59 seconds
[0m19:09:31.424736 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:09:31.426276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c93f20cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c94606630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701c94490e00>]}
[0m19:09:31.428635 [debug] [MainThread]: Flushing usage events
[0m19:09:31.592926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:32.167872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f8256bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f8256ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f8256bc50>]}


============================== 19:09:32.177303 | b7d7b23a-07f5-4049-a7f1-71491052f687 ==============================
[0m19:09:32.177303 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:09:32.178789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'empty': 'None', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m19:09:32.190602 [info ] [MainThread]: dbt version: 1.11.2
[0m19:09:32.192051 [info ] [MainThread]: python version: 3.12.4
[0m19:09:32.192937 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:09:32.193795 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:09:32.278596 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m19:09:32.280384 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m19:09:32.281571 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m19:09:32.283091 [info ] [MainThread]: adapter type: postgres
[0m19:09:32.284879 [info ] [MainThread]: adapter version: 1.10.0
[0m19:09:32.454342 [info ] [MainThread]: Configuration:
[0m19:09:32.455807 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:09:32.457356 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:09:32.458519 [info ] [MainThread]: Required dependencies:
[0m19:09:32.460265 [debug] [MainThread]: Executing "git --help"
[0m19:09:32.463106 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:09:32.464527 [info ] [MainThread]: Connection:
[0m19:09:32.466251 [info ] [MainThread]:   host: host.docker.internal
[0m19:09:32.467482 [info ] [MainThread]:   port: 6543
[0m19:09:32.468731 [info ] [MainThread]:   user: de_user
[0m19:09:32.469791 [info ] [MainThread]:   database: de_db
[0m19:09:32.473212 [info ] [MainThread]:   schema: public
[0m19:09:32.474610 [info ] [MainThread]:   connect_timeout: 10
[0m19:09:32.475673 [info ] [MainThread]:   role: None
[0m19:09:32.477195 [info ] [MainThread]:   search_path: None
[0m19:09:32.478390 [info ] [MainThread]:   keepalives_idle: 0
[0m19:09:32.479582 [info ] [MainThread]:   sslmode: None
[0m19:09:32.480633 [info ] [MainThread]:   sslcert: None
[0m19:09:32.482197 [info ] [MainThread]:   sslkey: None
[0m19:09:32.483776 [info ] [MainThread]:   sslrootcert: None
[0m19:09:32.485264 [info ] [MainThread]:   application_name: dbt
[0m19:09:32.486292 [info ] [MainThread]:   retries: 1
[0m19:09:32.487793 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:09:32.583402 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:09:32.615090 [debug] [MainThread]: Using postgres connection "debug"
[0m19:09:32.616574 [debug] [MainThread]: On debug: select 1 as id
[0m19:09:32.617997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:32.637171 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m19:09:32.639531 [debug] [MainThread]: On debug: Close
[0m19:09:32.640559 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:09:32.642286 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:09:32.643974 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m19:09:32.646695 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5686836, "process_in_blocks": "0", "process_kernel_time": 0.565597, "process_mem_max_rss": "119380", "process_out_blocks": "0", "process_user_time": 3.598511}
[0m19:09:32.648559 [debug] [MainThread]: Command `dbt debug` failed at 19:09:32.648229 after 0.57 seconds
[0m19:09:32.650021 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:09:32.651304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f83a2fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f824669f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f8256bc50>]}
[0m19:09:32.652521 [debug] [MainThread]: Flushing usage events
[0m19:09:32.708018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:37.020663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacca5b6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacca0c20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacca442420>]}


============================== 19:11:37.030898 | 856dad19-2bce-4b49-8278-c70d7b28d3ca ==============================
[0m19:11:37.030898 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:11:37.032699 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'printer_width': '80', 'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt_profiles', 'empty': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False'}
[0m19:11:37.034160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7260b52bbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7260b4570350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7260b45702f0>]}


============================== 19:11:37.043882 | adc33cf8-6849-4b0b-bf4f-a0743c9f3375 ==============================
[0m19:11:37.043882 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:11:37.045828 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/my_dbt/logs', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'partial_parse': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m19:11:37.050050 [info ] [MainThread]: dbt version: 1.11.2
[0m19:11:37.051424 [info ] [MainThread]: python version: 3.12.4
[0m19:11:37.053386 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:11:37.055359 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:11:37.061092 [info ] [MainThread]: dbt version: 1.11.2
[0m19:11:37.062676 [info ] [MainThread]: python version: 3.12.4
[0m19:11:37.063870 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:11:37.065034 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:11:37.147627 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m19:11:37.149452 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m19:11:37.151023 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m19:11:37.152760 [info ] [MainThread]: adapter type: postgres
[0m19:11:37.154580 [info ] [MainThread]: adapter version: 1.10.0
[0m19:11:37.160636 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m19:11:37.162694 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m19:11:37.163752 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m19:11:37.165551 [info ] [MainThread]: adapter type: postgres
[0m19:11:37.166850 [info ] [MainThread]: adapter version: 1.10.0
[0m19:11:37.300817 [info ] [MainThread]: Configuration:
[0m19:11:37.303304 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:11:37.305221 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:11:37.306620 [info ] [MainThread]: Required dependencies:
[0m19:11:37.307670 [debug] [MainThread]: Executing "git --help"
[0m19:11:37.310170 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:11:37.311673 [info ] [MainThread]: Connection:
[0m19:11:37.313039 [info ] [MainThread]:   host: host.docker.internal
[0m19:11:37.314383 [info ] [MainThread]:   port: 6543
[0m19:11:37.314215 [info ] [MainThread]: Configuration:
[0m19:11:37.315473 [info ] [MainThread]:   user: de_user
[0m19:11:37.315643 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:11:37.317041 [info ] [MainThread]:   database: de_db
[0m19:11:37.317848 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:11:37.318480 [info ] [MainThread]:   schema: public
[0m19:11:37.319213 [info ] [MainThread]: Required dependencies:
[0m19:11:37.319821 [info ] [MainThread]:   connect_timeout: 10
[0m19:11:37.320576 [debug] [MainThread]: Executing "git --help"
[0m19:11:37.320865 [info ] [MainThread]:   role: None
[0m19:11:37.321948 [info ] [MainThread]:   search_path: None
[0m19:11:37.323242 [info ] [MainThread]:   keepalives_idle: 0
[0m19:11:37.323085 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:11:37.324935 [info ] [MainThread]: Connection:
[0m19:11:37.324805 [info ] [MainThread]:   sslmode: None
[0m19:11:37.326111 [info ] [MainThread]:   sslcert: None
[0m19:11:37.326098 [info ] [MainThread]:   host: host.docker.internal
[0m19:11:37.327187 [info ] [MainThread]:   port: 6543
[0m19:11:37.327188 [info ] [MainThread]:   sslkey: None
[0m19:11:37.328523 [info ] [MainThread]:   user: de_user
[0m19:11:37.328658 [info ] [MainThread]:   sslrootcert: None
[0m19:11:37.330137 [info ] [MainThread]:   database: de_db
[0m19:11:37.330278 [info ] [MainThread]:   application_name: dbt
[0m19:11:37.332513 [info ] [MainThread]:   schema: public
[0m19:11:37.333042 [info ] [MainThread]:   retries: 1
[0m19:11:37.333944 [info ] [MainThread]:   connect_timeout: 10
[0m19:11:37.334875 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:11:37.335198 [info ] [MainThread]:   role: None
[0m19:11:37.336669 [info ] [MainThread]:   search_path: None
[0m19:11:37.338223 [info ] [MainThread]:   keepalives_idle: 0
[0m19:11:37.339349 [info ] [MainThread]:   sslmode: None
[0m19:11:37.340591 [info ] [MainThread]:   sslcert: None
[0m19:11:37.342762 [info ] [MainThread]:   sslkey: None
[0m19:11:37.344368 [info ] [MainThread]:   sslrootcert: None
[0m19:11:37.346113 [info ] [MainThread]:   application_name: dbt
[0m19:11:37.347954 [info ] [MainThread]:   retries: 1
[0m19:11:37.349169 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:11:37.448334 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:11:37.487869 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:11:37.517503 [debug] [MainThread]: Using postgres connection "debug"
[0m19:11:37.519457 [debug] [MainThread]: On debug: select 1 as id
[0m19:11:37.522215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:37.551341 [debug] [MainThread]: Using postgres connection "debug"
[0m19:11:37.553536 [debug] [MainThread]: On debug: select 1 as id
[0m19:11:37.555828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:37.558681 [debug] [MainThread]: SQL status: SELECT 1 in 0.036 seconds
[0m19:11:37.567662 [debug] [MainThread]: On debug: Close
[0m19:11:37.570789 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:11:37.575217 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:11:37.577132 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m19:11:37.580974 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6477058, "process_in_blocks": "0", "process_kernel_time": 0.347881, "process_mem_max_rss": "119312", "process_out_blocks": "0", "process_user_time": 2.896313}
[0m19:11:37.586423 [debug] [MainThread]: Command `dbt debug` failed at 19:11:37.586078 after 0.65 seconds
[0m19:11:37.589498 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:11:37.592090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacc90b4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daccbcbb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacc9f0cd70>]}
[0m19:11:37.594537 [debug] [MainThread]: SQL status: SELECT 1 in 0.039 seconds
[0m19:11:37.594939 [debug] [MainThread]: Flushing usage events
[0m19:11:37.598578 [debug] [MainThread]: On debug: Close
[0m19:11:37.602981 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:11:37.606129 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:11:37.608870 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m19:11:37.615214 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6721794, "process_in_blocks": "0", "process_kernel_time": 0.305225, "process_mem_max_rss": "119020", "process_out_blocks": "0", "process_user_time": 2.96792}
[0m19:11:37.619440 [debug] [MainThread]: Command `dbt debug` failed at 19:11:37.618643 after 0.68 seconds
[0m19:11:37.625040 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:11:37.627861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7260b27c3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7260b3cb09e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7260b3cb3980>]}
[0m19:11:37.631816 [debug] [MainThread]: Flushing usage events
[0m19:11:37.709002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:37.709342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:58:30.593366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a817f2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a8386f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a8186ef60>]}


============================== 19:58:30.601405 | bdfdfb0e-f7c8-437d-9866-1a38d87b6ac1 ==============================
[0m19:58:30.601405 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:58:30.602726 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/my_dbt/logs'}
[0m19:58:30.641306 [info ] [MainThread]: dbt version: 1.11.2
[0m19:58:30.643831 [info ] [MainThread]: python version: 3.12.4
[0m19:58:30.645061 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:58:30.646222 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:58:30.765023 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m19:58:30.766277 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m19:58:30.767282 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m19:58:30.768626 [info ] [MainThread]: adapter type: postgres
[0m19:58:30.771836 [info ] [MainThread]: adapter version: 1.10.0
[0m19:58:30.899478 [info ] [MainThread]: Configuration:
[0m19:58:30.900852 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:58:30.902459 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:58:30.903972 [info ] [MainThread]: Required dependencies:
[0m19:58:30.905041 [debug] [MainThread]: Executing "git --help"
[0m19:58:30.906954 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:58:30.908639 [info ] [MainThread]: Connection:
[0m19:58:30.910155 [info ] [MainThread]:   host: host.docker.internal
[0m19:58:30.911390 [info ] [MainThread]:   port: 6543
[0m19:58:30.912492 [info ] [MainThread]:   user: de_user
[0m19:58:30.913621 [info ] [MainThread]:   database: de_db
[0m19:58:30.914713 [info ] [MainThread]:   schema: public
[0m19:58:30.915690 [info ] [MainThread]:   connect_timeout: 10
[0m19:58:30.916730 [info ] [MainThread]:   role: None
[0m19:58:30.917717 [info ] [MainThread]:   search_path: None
[0m19:58:30.918767 [info ] [MainThread]:   keepalives_idle: 0
[0m19:58:30.919823 [info ] [MainThread]:   sslmode: None
[0m19:58:30.920810 [info ] [MainThread]:   sslcert: None
[0m19:58:30.921756 [info ] [MainThread]:   sslkey: None
[0m19:58:30.922866 [info ] [MainThread]:   sslrootcert: None
[0m19:58:30.924172 [info ] [MainThread]:   application_name: dbt
[0m19:58:30.926084 [info ] [MainThread]:   retries: 1
[0m19:58:30.927558 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:58:31.008418 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:58:31.049392 [debug] [MainThread]: Using postgres connection "debug"
[0m19:58:31.050842 [debug] [MainThread]: On debug: select 1 as id
[0m19:58:31.053893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:58:31.075341 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m19:58:31.077505 [debug] [MainThread]: On debug: Close
[0m19:58:31.080375 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:58:31.082363 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:58:31.083929 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m19:58:31.087459 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.56949794, "process_in_blocks": "0", "process_kernel_time": 0.329854, "process_mem_max_rss": "119668", "process_out_blocks": "448", "process_user_time": 2.252665}
[0m19:58:31.090811 [debug] [MainThread]: Command `dbt debug` failed at 19:58:31.089600 after 0.57 seconds
[0m19:58:31.094389 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:58:31.096864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a8386f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a80c6d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5a81f5f320>]}
[0m19:58:31.098308 [debug] [MainThread]: Flushing usage events
[0m19:58:31.168458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:34.510199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742424750c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742423b2a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424248a1580>]}


============================== 20:00:34.517590 | 1703f131-7e7a-42d4-b70a-a9124897ebc1 ==============================
[0m20:00:34.517590 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:00:34.519015 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'empty': 'None', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m20:00:34.530111 [info ] [MainThread]: dbt version: 1.11.2
[0m20:00:34.531563 [info ] [MainThread]: python version: 3.12.4
[0m20:00:34.532862 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:00:34.533977 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m20:00:34.628590 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m20:00:34.630047 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m20:00:34.631541 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m20:00:34.632824 [info ] [MainThread]: adapter type: postgres
[0m20:00:34.634175 [info ] [MainThread]: adapter version: 1.10.0
[0m20:00:34.751108 [info ] [MainThread]: Configuration:
[0m20:00:34.752413 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:00:34.753427 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:00:34.754429 [info ] [MainThread]: Required dependencies:
[0m20:00:34.755427 [debug] [MainThread]: Executing "git --help"
[0m20:00:34.757362 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m20:00:34.758661 [info ] [MainThread]: Connection:
[0m20:00:34.759725 [info ] [MainThread]:   host: host.docker.internal
[0m20:00:34.760812 [info ] [MainThread]:   port: 6543
[0m20:00:34.762053 [info ] [MainThread]:   user: de_user
[0m20:00:34.763298 [info ] [MainThread]:   database: de_db
[0m20:00:34.764742 [info ] [MainThread]:   schema: public
[0m20:00:34.765895 [info ] [MainThread]:   connect_timeout: 10
[0m20:00:34.766860 [info ] [MainThread]:   role: None
[0m20:00:34.767839 [info ] [MainThread]:   search_path: None
[0m20:00:34.768962 [info ] [MainThread]:   keepalives_idle: 0
[0m20:00:34.770044 [info ] [MainThread]:   sslmode: None
[0m20:00:34.771078 [info ] [MainThread]:   sslcert: None
[0m20:00:34.772137 [info ] [MainThread]:   sslkey: None
[0m20:00:34.773517 [info ] [MainThread]:   sslrootcert: None
[0m20:00:34.775013 [info ] [MainThread]:   application_name: dbt
[0m20:00:34.776087 [info ] [MainThread]:   retries: 1
[0m20:00:34.777298 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:00:34.855179 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:00:34.886360 [debug] [MainThread]: Using postgres connection "debug"
[0m20:00:34.887404 [debug] [MainThread]: On debug: select 1 as id
[0m20:00:34.888269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:34.907774 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m20:00:34.909657 [debug] [MainThread]: On debug: Close
[0m20:00:34.911028 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:00:34.913485 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:00:34.914795 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m20:00:34.916556 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.47577667, "process_in_blocks": "0", "process_kernel_time": 0.314102, "process_mem_max_rss": "119480", "process_out_blocks": "0", "process_user_time": 2.04972}
[0m20:00:34.917812 [debug] [MainThread]: Command `dbt debug` failed at 20:00:34.917678 after 0.48 seconds
[0m20:00:34.918834 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:00:34.919899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424245d1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424248a1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7424248a3530>]}
[0m20:00:34.920889 [debug] [MainThread]: Flushing usage events
[0m20:00:35.008946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:38.551762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f7823680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f9884050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f85113a0>]}


============================== 20:02:38.558782 | 63b8933a-edef-44a2-84b9-726ce928728b ==============================
[0m20:02:38.558782 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:02:38.560278 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'printer_width': '80', 'empty': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'no_print': 'None'}
[0m20:02:38.570757 [info ] [MainThread]: dbt version: 1.11.2
[0m20:02:38.572407 [info ] [MainThread]: python version: 3.12.4
[0m20:02:38.573793 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:02:38.575052 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m20:02:38.675186 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m20:02:38.676620 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m20:02:38.677839 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m20:02:38.679310 [info ] [MainThread]: adapter type: postgres
[0m20:02:38.680808 [info ] [MainThread]: adapter version: 1.10.0
[0m20:02:38.797104 [info ] [MainThread]: Configuration:
[0m20:02:38.798552 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:02:38.799896 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:02:38.801040 [info ] [MainThread]: Required dependencies:
[0m20:02:38.802215 [debug] [MainThread]: Executing "git --help"
[0m20:02:38.804032 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m20:02:38.805265 [info ] [MainThread]: Connection:
[0m20:02:38.806385 [info ] [MainThread]:   host: host.docker.internal
[0m20:02:38.807601 [info ] [MainThread]:   port: 6543
[0m20:02:38.808784 [info ] [MainThread]:   user: de_user
[0m20:02:38.809940 [info ] [MainThread]:   database: de_db
[0m20:02:38.811048 [info ] [MainThread]:   schema: public
[0m20:02:38.812095 [info ] [MainThread]:   connect_timeout: 10
[0m20:02:38.813155 [info ] [MainThread]:   role: None
[0m20:02:38.814230 [info ] [MainThread]:   search_path: None
[0m20:02:38.815271 [info ] [MainThread]:   keepalives_idle: 0
[0m20:02:38.816498 [info ] [MainThread]:   sslmode: None
[0m20:02:38.817611 [info ] [MainThread]:   sslcert: None
[0m20:02:38.818789 [info ] [MainThread]:   sslkey: None
[0m20:02:38.819969 [info ] [MainThread]:   sslrootcert: None
[0m20:02:38.821074 [info ] [MainThread]:   application_name: dbt
[0m20:02:38.822161 [info ] [MainThread]:   retries: 1
[0m20:02:38.823401 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:02:38.903064 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:02:38.932409 [debug] [MainThread]: Using postgres connection "debug"
[0m20:02:38.933479 [debug] [MainThread]: On debug: select 1 as id
[0m20:02:38.934392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:02:38.952517 [debug] [MainThread]: SQL status: SELECT 1 in 0.018 seconds
[0m20:02:38.954783 [debug] [MainThread]: On debug: Close
[0m20:02:38.956765 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:02:38.959093 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:02:38.961374 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m20:02:38.963519 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.48756886, "process_in_blocks": "0", "process_kernel_time": 0.253195, "process_mem_max_rss": "119124", "process_out_blocks": "0", "process_user_time": 2.113979}
[0m20:02:38.964851 [debug] [MainThread]: Command `dbt debug` failed at 20:02:38.964720 after 0.49 seconds
[0m20:02:38.965825 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:02:38.966913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f8572a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f7674fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9f74d26f0>]}
[0m20:02:38.967929 [debug] [MainThread]: Flushing usage events
[0m20:02:39.064077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:40.150163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175500DA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175500D3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175500D3C90>]}


============================== 15:03:40.154801 | cdbc39f4-1030-4a4f-8a5a-2d00299ffc35 ==============================
[0m15:03:40.154801 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:03:40.154801 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:03:40.328401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdbc39f4-1030-4a4f-8a5a-2d00299ffc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175500DAB50>]}
[0m15:03:40.382939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdbc39f4-1030-4a4f-8a5a-2d00299ffc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001754C91BDD0>]}
[0m15:03:40.384942 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:03:40.597881 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:03:40.720805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:40.721834 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:03:40.721834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:40.762033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdbc39f4-1030-4a4f-8a5a-2d00299ffc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001755139FAD0>]}
[0m15:03:40.848173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:03:40.850401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:03:40.893363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdbc39f4-1030-4a4f-8a5a-2d00299ffc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017551961250>]}
[0m15:03:40.894428 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m15:03:40.894850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdbc39f4-1030-4a4f-8a5a-2d00299ffc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001755152B850>]}
[0m15:03:40.897528 [info ] [MainThread]: 
[0m15:03:40.898086 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:03:40.898599 [info ] [MainThread]: 
[0m15:03:40.899599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:03:40.904816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m15:03:41.051918 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m15:03:41.051918 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:03:41.052891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:41.086785 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.034 seconds
[0m15:03:41.088781 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m15:03:41.090645 [debug] [ThreadPool]: On list_de_db_public: Close
[0m15:03:41.101237 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:41.102296 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:03:41.102697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:41.131191 [debug] [MainThread]: SQL status: SELECT 0 in 0.029 seconds
[0m15:03:41.132155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdbc39f4-1030-4a4f-8a5a-2d00299ffc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017551CAD410>]}
[0m15:03:41.133156 [debug] [MainThread]: On master: ROLLBACK
[0m15:03:41.134886 [debug] [MainThread]: On master: COMMIT
[0m15:03:41.134886 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:41.135894 [debug] [MainThread]: On master: COMMIT
[0m15:03:41.137933 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:03:41.137933 [debug] [MainThread]: On master: Close
[0m15:03:41.141934 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m15:03:41.142960 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m15:03:41.142960 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m15:03:41.143655 [debug] [Thread-4 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m15:03:41.144192 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_taxi_zones_location_id .......................... [RUN]
[0m15:03:41.144192 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m15:03:41.145191 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m15:03:41.145191 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m15:03:41.146190 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf'
[0m15:03:41.147217 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001'
[0m15:03:41.147217 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m15:03:41.148316 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786'
[0m15:03:41.148828 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m15:03:41.148828 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m15:03:41.149827 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m15:03:41.149827 [debug] [Thread-4 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m15:03:41.162854 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m15:03:41.168113 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m15:03:41.171138 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m15:03:41.174139 [debug] [Thread-4 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m15:03:41.175351 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m15:03:41.176390 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m15:03:41.177359 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m15:03:41.191159 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m15:03:41.191159 [debug] [Thread-4 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m15:03:41.195495 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m15:03:41.197494 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m15:03:41.200492 [debug] [Thread-4 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m15:03:41.201491 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf"
[0m15:03:41.202492 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m15:03:41.202492 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "de_db"."public"."stg_taxi_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m15:03:41.203492 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m15:03:41.203492 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m15:03:41.204492 [debug] [Thread-4 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m15:03:41.204492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:03:41.204492 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m15:03:41.205492 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:03:41.205492 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m15:03:41.206492 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:03:41.207570 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:03:41.238650 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.034 seconds
[0m15:03:41.243056 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf: ROLLBACK
[0m15:03:41.245166 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf: Close
[0m15:03:41.246271 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_taxi_zones_location_id ................................ [[32mPASS[0m in 0.10s]
[0m15:03:41.247364 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf
[0m15:03:41.247876 [debug] [Thread-1 (]: Began running node test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c
[0m15:03:41.247876 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_taxi_zones_location_id ............................ [RUN]
[0m15:03:41.249426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt.not_null_stg_taxi_zones_location_id.5b95dc00bf, now test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c)
[0m15:03:41.249939 [debug] [Thread-1 (]: Began compiling node test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c
[0m15:03:41.257305 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m15:03:41.258158 [debug] [Thread-1 (]: Began executing node test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c
[0m15:03:41.261456 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m15:03:41.262457 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c"
[0m15:03:41.262457 [debug] [Thread-1 (]: On test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "de_db"."public"."stg_taxi_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:03:41.263734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:41.279734 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m15:03:41.281733 [debug] [Thread-1 (]: On test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c: ROLLBACK
[0m15:03:41.282734 [debug] [Thread-1 (]: On test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c: Close
[0m15:03:41.284733 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_taxi_zones_location_id .................................. [[32mPASS[0m in 0.03s]
[0m15:03:41.285732 [debug] [Thread-1 (]: Finished running node test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c
[0m15:03:42.776225 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.571 seconds
[0m15:03:42.776744 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.570 seconds
[0m15:03:42.777259 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.569 seconds
[0m15:03:42.778800 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m15:03:42.779856 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m15:03:42.781397 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m15:03:42.782430 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m15:03:42.782943 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m15:03:42.782943 [debug] [Thread-4 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m15:03:42.783451 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 1.64s]
[0m15:03:42.784482 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 1.64s]
[0m15:03:42.785512 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m15:03:42.785001 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 1.64s]
[0m15:03:42.786542 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m15:03:42.787573 [debug] [Thread-4 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m15:03:42.788600 [debug] [MainThread]: On master: COMMIT
[0m15:03:42.789114 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:42.789627 [debug] [MainThread]: On master: COMMIT
[0m15:03:42.789627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:03:42.801051 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m15:03:42.801568 [debug] [MainThread]: On master: Close
[0m15:03:42.802082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:42.802603 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m15:03:42.803113 [debug] [MainThread]: Connection 'test.my_dbt.unique_stg_taxi_zones_location_id.ff20549a5c' was properly closed.
[0m15:03:42.803113 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m15:03:42.803630 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m15:03:42.804164 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m15:03:42.804682 [info ] [MainThread]: 
[0m15:03:42.805198 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m15:03:42.806753 [debug] [MainThread]: Command end result
[0m15:03:42.830210 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:03:42.832209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:03:42.839207 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:03:42.839207 [info ] [MainThread]: 
[0m15:03:42.840208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:42.841208 [info ] [MainThread]: 
[0m15:03:42.841298 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:03:42.842811 [debug] [MainThread]: Command `dbt test` succeeded at 15:03:42.842811 after 2.76 seconds
[0m15:03:42.843810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017549278C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017549581690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175495808D0>]}
[0m15:03:42.843810 [debug] [MainThread]: Flushing usage events
[0m15:03:43.133731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:48.075452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B1C4F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B2422E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B242A610>]}


============================== 15:03:48.079476 | 6a4139d4-627f-4682-be6d-8226d2f3a998 ==============================
[0m15:03:48.079476 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:03:48.080642 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:03:48.251358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B35BD550>]}
[0m15:03:48.306622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141AEC88510>]}
[0m15:03:48.308243 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:03:48.535277 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:03:48.656847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:48.656847 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:03:48.657813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:48.698265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B389C050>]}
[0m15:03:48.774559 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:03:48.776565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:03:48.801332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B3BC4110>]}
[0m15:03:48.801332 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m15:03:48.802332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B3AE56D0>]}
[0m15:03:48.804331 [info ] [MainThread]: 
[0m15:03:48.804331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:03:48.805439 [info ] [MainThread]: 
[0m15:03:48.805958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:03:48.809851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m15:03:48.925112 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m15:03:48.925112 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m15:03:48.926112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:48.942557 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m15:03:48.944150 [debug] [ThreadPool]: On list_de_db: Close
[0m15:03:48.945674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m15:03:48.951248 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m15:03:48.951798 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:03:48.951798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:48.985668 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.034 seconds
[0m15:03:48.987230 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m15:03:48.988836 [debug] [ThreadPool]: On list_de_db_public: Close
[0m15:03:49.000041 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:49.000668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:03:49.001215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:49.033233 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m15:03:49.033903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B1C02350>]}
[0m15:03:49.034937 [debug] [MainThread]: On master: ROLLBACK
[0m15:03:49.036847 [debug] [MainThread]: On master: COMMIT
[0m15:03:49.037389 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:49.037805 [debug] [MainThread]: On master: COMMIT
[0m15:03:49.039958 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:03:49.040573 [debug] [MainThread]: On master: Close
[0m15:03:49.044590 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m15:03:49.045401 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_taxi_zones
[0m15:03:49.045910 [debug] [Thread-3 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m15:03:49.046453 [info ] [Thread-1 (]: 1 of 8 START sql table model public.hello ...................................... [RUN]
[0m15:03:49.046898 [info ] [Thread-2 (]: 2 of 8 START sql table model public.stg_taxi_zones ............................. [RUN]
[0m15:03:49.048014 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m15:03:49.047478 [info ] [Thread-3 (]: 3 of 8 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m15:03:49.048577 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_taxi_zones'
[0m15:03:49.048577 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m15:03:49.049563 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m15:03:49.049563 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_taxi_zones
[0m15:03:49.056175 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m15:03:49.057200 [debug] [Thread-3 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m15:03:49.060175 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_taxi_zones"
[0m15:03:49.062175 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m15:03:49.063209 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m15:03:49.064194 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_taxi_zones
[0m15:03:49.095643 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m15:03:49.096970 [debug] [Thread-3 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m15:03:49.100490 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_taxi_zones"
[0m15:03:49.105389 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m15:03:49.105935 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:03:49.107159 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m15:03:49.107707 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:03:49.107707 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:03:49.108303 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:03:49.108820 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */

  
    

  create  table "de_db"."public"."stg_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select *
    from "de_db"."public"."taxi_zones_raw"
),

renamed as (
    select
        "LocationID"::int as location_id,
        "Borough"::text   as borough,
        "Zone"::text      as zone,
        "service_zone"::text as service_zone
    from source
)

select * from renamed
  );
  
[0m15:03:49.109843 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m15:03:49.110392 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:03:49.110937 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:03:49.135891 [debug] [Thread-2 (]: SQL status: SELECT 265 in 0.026 seconds
[0m15:03:49.144071 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:03:49.145167 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m15:03:49.147085 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:49.150086 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:03:49.150086 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m15:03:49.151086 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m15:03:49.155088 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:03:49.156088 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m15:03:49.156088 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:49.170193 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m15:03:49.171195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m15:03:49.171195 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:03:49.174264 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:03:49.175223 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m15:03:49.175223 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m15:03:49.177491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:49.179104 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m15:03:49.179646 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:03:49.180189 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m15:03:49.200433 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m15:03:49.206890 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_taxi_zones__dbt_backup"
[0m15:03:49.210981 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:03:49.211516 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
drop table if exists "de_db"."public"."stg_taxi_zones__dbt_backup" cascade
[0m15:03:49.212783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m15:03:49.215114 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m15:03:49.215952 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:03:49.216804 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m15:03:49.218736 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:03:49.221325 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: Close
[0m15:03:49.223577 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:03:49.224090 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B3E99790>]}
[0m15:03:49.225754 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m15:03:49.226300 [info ] [Thread-2 (]: 2 of 8 OK created sql table model public.stg_taxi_zones ........................ [[32mSELECT 265[0m in 0.17s]
[0m15:03:49.227264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B3E9C710>]}
[0m15:03:49.228265 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_taxi_zones
[0m15:03:49.229779 [debug] [Thread-4 (]: Began running node model.my_dbt.dim_taxi_zones
[0m15:03:49.228835 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.18s]
[0m15:03:49.230779 [info ] [Thread-4 (]: 4 of 8 START sql table model public.dim_taxi_zones ............................. [RUN]
[0m15:03:49.230779 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m15:03:49.231780 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.dim_taxi_zones'
[0m15:03:49.232781 [debug] [Thread-4 (]: Began compiling node model.my_dbt.dim_taxi_zones
[0m15:03:49.235322 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.dim_taxi_zones"
[0m15:03:49.236309 [debug] [Thread-4 (]: Began executing node model.my_dbt.dim_taxi_zones
[0m15:03:49.240318 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.dim_taxi_zones"
[0m15:03:49.241293 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:03:49.241293 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */

  
    

  create  table "de_db"."public"."dim_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with zones as (
    select *
    from "de_db"."public"."stg_taxi_zones"
)

select
    location_id,
    borough,
    zone,
    service_zone
from zones
  );
  
[0m15:03:49.242319 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:03:49.303909 [debug] [Thread-4 (]: SQL status: SELECT 265 in 0.062 seconds
[0m15:03:49.307620 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:03:49.308097 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones" rename to "dim_taxi_zones__dbt_backup"
[0m15:03:49.309652 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:49.312970 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:03:49.313518 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones__dbt_tmp" rename to "dim_taxi_zones"
[0m15:03:49.315163 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:03:49.316408 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m15:03:49.316944 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:03:49.316944 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m15:03:49.343802 [debug] [Thread-4 (]: SQL status: COMMIT in 0.026 seconds
[0m15:03:49.346901 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."dim_taxi_zones__dbt_backup"
[0m15:03:49.347763 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:03:49.348223 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
drop table if exists "de_db"."public"."dim_taxi_zones__dbt_backup" cascade
[0m15:03:49.368904 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.021 seconds
[0m15:03:49.370961 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: Close
[0m15:03:49.371156 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B3F31810>]}
[0m15:03:49.372216 [info ] [Thread-4 (]: 4 of 8 OK created sql table model public.dim_taxi_zones ........................ [[32mSELECT 265[0m in 0.14s]
[0m15:03:49.372953 [debug] [Thread-4 (]: Finished running node model.my_dbt.dim_taxi_zones
[0m15:04:04.855191 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 15.744 seconds
[0m15:04:04.859402 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:04:04.859940 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m15:04:04.862100 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:04:04.866176 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:04:04.866176 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m15:04:04.868634 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:04.870158 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m15:04:04.870158 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:04:04.870158 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m15:04:04.979769 [debug] [Thread-3 (]: SQL status: COMMIT in 0.108 seconds
[0m15:04:04.981735 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m15:04:04.982737 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:04:04.983735 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m15:04:05.192518 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.209 seconds
[0m15:04:05.194080 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m15:04:05.194682 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B443A5D0>]}
[0m15:04:05.195195 [info ] [Thread-3 (]: 3 of 8 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 16.15s]
[0m15:04:05.196193 [debug] [Thread-3 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m15:04:05.197192 [debug] [Thread-2 (]: Began running node model.my_dbt.fct_yellow_trips
[0m15:04:05.197192 [info ] [Thread-2 (]: 5 of 8 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m15:04:05.198192 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_taxi_zones, now model.my_dbt.fct_yellow_trips)
[0m15:04:05.199195 [debug] [Thread-2 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m15:04:05.202280 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m15:04:05.203338 [debug] [Thread-2 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m15:04:05.207587 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m15:04:05.208725 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:04:05.209453 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m15:04:05.209505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:30.214468 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 25.005 seconds
[0m15:04:30.219467 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:04:30.220467 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m15:04:30.222467 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:04:30.227469 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:04:30.227469 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m15:04:30.230467 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:04:30.232467 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m15:04:30.233467 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:04:30.233467 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m15:04:30.323129 [debug] [Thread-2 (]: SQL status: COMMIT in 0.088 seconds
[0m15:04:30.325715 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m15:04:30.326753 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:04:30.327269 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m15:04:30.537070 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.209 seconds
[0m15:04:30.538808 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: Close
[0m15:04:30.539463 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B4439810>]}
[0m15:04:30.540000 [info ] [Thread-2 (]: 5 of 8 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 25.34s]
[0m15:04:30.541061 [debug] [Thread-2 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m15:04:30.542099 [debug] [Thread-4 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m15:04:30.542099 [debug] [Thread-3 (]: Began running node model.my_dbt.mart_daily_revenue
[0m15:04:30.542625 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_payment_type
[0m15:04:30.543162 [info ] [Thread-4 (]: 6 of 8 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m15:04:30.543819 [info ] [Thread-3 (]: 7 of 8 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m15:04:30.545387 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt.dim_taxi_zones, now model.my_dbt.fct_yellow_trips_enriched)
[0m15:04:30.544367 [info ] [Thread-1 (]: 8 of 8 START sql table model public.mart_payment_type .......................... [RUN]
[0m15:04:30.545964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_daily_revenue)
[0m15:04:30.546469 [debug] [Thread-4 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m15:04:30.546672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.hello, now model.my_dbt.mart_payment_type)
[0m15:04:30.547221 [debug] [Thread-3 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m15:04:30.549909 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m15:04:30.550423 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_payment_type
[0m15:04:30.552752 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m15:04:30.555479 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m15:04:30.556480 [debug] [Thread-4 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m15:04:30.560567 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m15:04:30.560567 [debug] [Thread-3 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m15:04:30.561541 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_payment_type
[0m15:04:30.566567 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m15:04:30.571271 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m15:04:30.572260 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:04:30.573260 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m15:04:30.573260 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:04:30.573260 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:04:30.574260 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:04:30.574260 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m15:04:30.575260 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m15:04:30.575260 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:30.576754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:31.340675 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.764 seconds
[0m15:04:31.344817 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:04:31.345384 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m15:04:31.410564 [debug] [Thread-3 (]: SQL status: SELECT 33 in 0.834 seconds
[0m15:04:31.411485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m15:04:31.414536 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:04:31.418225 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:04:31.418803 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m15:04:31.419409 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m15:04:31.421296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:31.421811 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:04:31.422810 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m15:04:31.425809 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:04:31.426839 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:04:31.426839 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m15:04:31.427836 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m15:04:31.429501 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:31.431195 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m15:04:31.431729 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:04:31.432234 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m15:04:31.491971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.063 seconds
[0m15:04:31.494656 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m15:04:31.495633 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:04:31.496178 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m15:04:31.504502 [debug] [Thread-3 (]: SQL status: COMMIT in 0.072 seconds
[0m15:04:31.507040 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m15:04:31.508012 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:04:31.508012 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m15:04:31.548848 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.052 seconds
[0m15:04:31.550505 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: Close
[0m15:04:31.551737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B3FC9790>]}
[0m15:04:31.552285 [info ] [Thread-1 (]: 8 of 8 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 1.00s]
[0m15:04:31.553329 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_payment_type
[0m15:04:31.582480 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.073 seconds
[0m15:04:31.584817 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: Close
[0m15:04:31.585662 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B36C1450>]}
[0m15:04:31.586745 [info ] [Thread-3 (]: 7 of 8 OK created sql table model public.mart_daily_revenue .................... [[32mSELECT 33[0m in 1.04s]
[0m15:04:31.588053 [debug] [Thread-3 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m15:05:18.712787 [debug] [Thread-4 (]: SQL status: SELECT 3475226 in 48.139 seconds
[0m15:05:18.715804 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:05:18.716805 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched" rename to "fct_yellow_trips_enriched__dbt_backup"
[0m15:05:18.719647 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:05:18.722848 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:05:18.723407 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m15:05:18.725040 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:18.726646 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m15:05:18.727184 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:05:18.727737 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m15:05:19.233523 [debug] [Thread-4 (]: SQL status: COMMIT in 0.506 seconds
[0m15:05:19.238521 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m15:05:19.241524 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:05:19.242525 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m15:05:19.519867 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.277 seconds
[0m15:05:19.521492 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m15:05:19.522009 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a4139d4-627f-4682-be6d-8226d2f3a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B4487D10>]}
[0m15:05:19.522530 [info ] [Thread-4 (]: 6 of 8 OK created sql table model public.fct_yellow_trips_enriched ............. [[32mSELECT 3475226[0m in 48.98s]
[0m15:05:19.523553 [debug] [Thread-4 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m15:05:19.525308 [debug] [MainThread]: On master: COMMIT
[0m15:05:19.525826 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:19.525826 [debug] [MainThread]: On master: COMMIT
[0m15:05:19.526368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:19.551883 [debug] [MainThread]: SQL status: COMMIT in 0.026 seconds
[0m15:05:19.552884 [debug] [MainThread]: On master: Close
[0m15:05:19.552884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:19.552884 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m15:05:19.553884 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m15:05:19.553884 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m15:05:19.554884 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m15:05:19.554884 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m15:05:19.555511 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m15:05:19.556051 [info ] [MainThread]: 
[0m15:05:19.557028 [info ] [MainThread]: Finished running 8 table models in 0 hours 1 minutes and 30.75 seconds (90.75s).
[0m15:05:19.558590 [debug] [MainThread]: Command end result
[0m15:05:19.579276 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:05:19.582277 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:05:19.588278 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:05:19.588278 [info ] [MainThread]: 
[0m15:05:19.589277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:19.589277 [info ] [MainThread]: 
[0m15:05:19.590278 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m15:05:19.591277 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:19.591277 after 91.58 seconds
[0m15:05:19.591277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141AB648C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141B247B450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141AB9CDE90>]}
[0m15:05:19.592276 [debug] [MainThread]: Flushing usage events
[0m15:05:19.962961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:28.264714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0BFFA9C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0BFFA3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0BFFA3E90>]}


============================== 15:05:28.270716 | 6dbaee36-8503-4f13-a2dc-b1f45da06dd4 ==============================
[0m15:05:28.270716 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:05:28.285717 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:05:28.390274 [info ] [MainThread]: dbt version: 1.11.2
[0m15:05:28.391273 [info ] [MainThread]: python version: 3.11.9
[0m15:05:28.392273 [info ] [MainThread]: python path: C:\Users\jkimd\AppData\Local\Programs\Python\Python311\python.exe
[0m15:05:28.392273 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m15:05:28.451812 [info ] [MainThread]: Using profiles dir at C:\Users\jkimd\.dbt
[0m15:05:28.452812 [info ] [MainThread]: Using profiles.yml file at C:\Users\jkimd\.dbt\profiles.yml
[0m15:05:28.453811 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\dbt_project.yml
[0m15:05:28.455317 [info ] [MainThread]: adapter type: postgres
[0m15:05:28.455324 [info ] [MainThread]: adapter version: 1.10.0
[0m15:05:28.553915 [info ] [MainThread]: Configuration:
[0m15:05:28.555477 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:05:28.556430 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:05:28.556430 [info ] [MainThread]: Required dependencies:
[0m15:05:28.557428 [debug] [MainThread]: Executing "git --help"
[0m15:05:28.576314 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:05:28.577313 [debug] [MainThread]: STDERR: "b''"
[0m15:05:28.577313 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:05:28.578317 [info ] [MainThread]: Connection:
[0m15:05:28.579315 [info ] [MainThread]:   host: 127.0.0.1
[0m15:05:28.579315 [info ] [MainThread]:   port: 6543
[0m15:05:28.580314 [info ] [MainThread]:   user: de_user
[0m15:05:28.581020 [info ] [MainThread]:   database: de_db
[0m15:05:28.581530 [info ] [MainThread]:   schema: public
[0m15:05:28.581530 [info ] [MainThread]:   connect_timeout: 10
[0m15:05:28.582527 [info ] [MainThread]:   role: None
[0m15:05:28.582527 [info ] [MainThread]:   search_path: None
[0m15:05:28.583530 [info ] [MainThread]:   keepalives_idle: 0
[0m15:05:28.583530 [info ] [MainThread]:   sslmode: None
[0m15:05:28.584532 [info ] [MainThread]:   sslcert: None
[0m15:05:28.585529 [info ] [MainThread]:   sslkey: None
[0m15:05:28.585529 [info ] [MainThread]:   sslrootcert: None
[0m15:05:28.586529 [info ] [MainThread]:   application_name: dbt
[0m15:05:28.586529 [info ] [MainThread]:   retries: 1
[0m15:05:28.587528 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:05:29.175894 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:05:29.267972 [debug] [MainThread]: Using postgres connection "debug"
[0m15:05:29.268970 [debug] [MainThread]: On debug: select 1 as id
[0m15:05:29.268970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:29.293743 [debug] [MainThread]: SQL status: SELECT 1 in 0.024 seconds
[0m15:05:29.295744 [debug] [MainThread]: On debug: Close
[0m15:05:29.296424 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:05:29.296970 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:05:29.297968 [debug] [MainThread]: Command `dbt debug` succeeded at 15:05:29.297968 after 1.12 seconds
[0m15:05:29.298969 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:05:29.298969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0BFFA8D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0C11B11D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0B9178C10>]}
[0m15:05:29.298969 [debug] [MainThread]: Flushing usage events
[0m15:05:29.624240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:54.029956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a806b08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a814805f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a806b0590>]}
[0m20:17:54.030153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a304e98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a306d06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a30e21220>]}


============================== 20:17:54.038115 | 49993812-1b62-47c7-8b7a-262b8f7143b9 ==============================
[0m20:17:54.038115 [info ] [MainThread]: Running with dbt=1.11.2


============================== 20:17:54.037880 | c651e0a4-954a-4de4-881c-4ced6370ac16 ==============================
[0m20:17:54.037880 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:17:54.039559 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'empty': 'None', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'use_colors': 'True'}
[0m20:17:54.039830 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'False', 'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles --select stg_yellow_tripdata+ fct_yellow_trips_enriched', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'target_path': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False'}
[0m20:17:54.077573 [info ] [MainThread]: dbt version: 1.11.2
[0m20:17:54.078815 [info ] [MainThread]: python version: 3.12.4
[0m20:17:54.079911 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:17:54.080992 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m20:17:54.177311 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m20:17:54.178533 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m20:17:54.179583 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m20:17:54.181145 [info ] [MainThread]: adapter type: postgres
[0m20:17:54.182241 [info ] [MainThread]: adapter version: 1.10.0
[0m20:17:54.306105 [info ] [MainThread]: Configuration:
[0m20:17:54.307446 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:17:54.308824 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:17:54.310005 [info ] [MainThread]: Required dependencies:
[0m20:17:54.311083 [debug] [MainThread]: Executing "git --help"
[0m20:17:54.313073 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m20:17:54.314331 [info ] [MainThread]: Connection:
[0m20:17:54.315415 [info ] [MainThread]:   host: host.docker.internal
[0m20:17:54.316341 [info ] [MainThread]:   port: 6543
[0m20:17:54.317610 [info ] [MainThread]:   user: de_user
[0m20:17:54.319036 [info ] [MainThread]:   database: de_db
[0m20:17:54.320168 [info ] [MainThread]:   schema: public
[0m20:17:54.321502 [info ] [MainThread]:   connect_timeout: 10
[0m20:17:54.323202 [info ] [MainThread]:   role: None
[0m20:17:54.324510 [info ] [MainThread]:   search_path: None
[0m20:17:54.325456 [info ] [MainThread]:   keepalives_idle: 0
[0m20:17:54.326557 [info ] [MainThread]:   sslmode: None
[0m20:17:54.327610 [info ] [MainThread]:   sslcert: None
[0m20:17:54.328526 [info ] [MainThread]:   sslkey: None
[0m20:17:54.329481 [info ] [MainThread]:   sslrootcert: None
[0m20:17:54.330320 [info ] [MainThread]:   application_name: dbt
[0m20:17:54.331452 [info ] [MainThread]:   retries: 1
[0m20:17:54.332599 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:17:54.385513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a804bc200>]}
[0m20:17:54.421827 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:17:54.460036 [debug] [MainThread]: Using postgres connection "debug"
[0m20:17:54.462591 [debug] [MainThread]: On debug: select 1 as id
[0m20:17:54.463997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:54.480309 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m20:17:54.482324 [debug] [MainThread]: On debug: Close
[0m20:17:54.483885 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:17:54.486353 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:17:54.487892 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m20:17:54.490323 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5443071, "process_in_blocks": "0", "process_kernel_time": 0.277916, "process_mem_max_rss": "118872", "process_out_blocks": "448", "process_user_time": 2.358316}
[0m20:17:54.491468 [debug] [MainThread]: Command `dbt debug` failed at 20:17:54.491322 after 0.55 seconds
[0m20:17:54.492391 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:17:54.494229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a307ef230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a30c0e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3a2f5b91f0>]}
[0m20:17:54.496347 [debug] [MainThread]: Flushing usage events
[0m20:17:54.510870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a8122eba0>]}
[0m20:17:54.512638 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:17:54.623587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:17:54.642794 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:17:54.822030 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:17:54.823984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7ef8c080>]}
[0m20:17:56.393295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7f760d10>]}
[0m20:17:56.526858 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m20:17:56.545143 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m20:17:56.599223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7e3fbdd0>]}
[0m20:17:56.600648 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m20:17:56.602133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7e380a40>]}
[0m20:17:56.605677 [info ] [MainThread]: 
[0m20:17:56.607605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:17:56.610097 [info ] [MainThread]: 
[0m20:17:56.611985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:17:56.621065 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m20:17:56.658115 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m20:17:56.659716 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m20:17:56.660922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:56.679242 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m20:17:56.682527 [debug] [ThreadPool]: On list_de_db: Close
[0m20:17:56.685770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_db, now list_de_db_public)
[0m20:17:56.693577 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m20:17:56.694980 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:17:56.696088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:56.716707 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.021 seconds
[0m20:17:56.720113 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m20:17:56.723357 [debug] [ThreadPool]: On list_de_db_public: Close
[0m20:17:56.751013 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:56.756434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:17:56.758287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:56.781969 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m20:17:56.785329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7e3b2b10>]}
[0m20:17:56.788111 [debug] [MainThread]: On master: ROLLBACK
[0m20:17:56.791895 [debug] [MainThread]: On master: COMMIT
[0m20:17:56.795490 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:56.798151 [debug] [MainThread]: On master: COMMIT
[0m20:17:56.802397 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m20:17:56.804168 [debug] [MainThread]: On master: Close
[0m20:17:56.815619 [debug] [Thread-1 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m20:17:56.816974 [info ] [Thread-1 (]: 1 of 5 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m20:17:56.818315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now model.my_dbt.stg_yellow_tripdata)
[0m20:17:56.820289 [debug] [Thread-1 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m20:17:56.829134 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m20:17:56.846434 [debug] [Thread-1 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m20:17:56.888621 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m20:17:56.904695 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m20:17:56.905695 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m20:17:56.906460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:04.783244 [debug] [Thread-1 (]: SQL status: SELECT 3475226 in 7.877 seconds
[0m20:18:04.795511 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m20:18:04.798251 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m20:18:04.803706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:18:04.809466 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m20:18:04.810901 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m20:18:04.815245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:18:04.834875 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m20:18:04.836792 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m20:18:04.841415 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m20:18:05.107734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.263 seconds
[0m20:18:05.116110 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m20:18:05.123792 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m20:18:05.125466 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m20:18:05.201838 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.074 seconds
[0m20:18:05.206308 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m20:18:05.210131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a82f99be0>]}
[0m20:18:05.213006 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 8.39s]
[0m20:18:05.217066 [debug] [Thread-1 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m20:18:05.218751 [debug] [Thread-3 (]: Began running node model.my_dbt.fct_yellow_trips
[0m20:18:05.220928 [info ] [Thread-3 (]: 2 of 5 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m20:18:05.222791 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips'
[0m20:18:05.224087 [debug] [Thread-3 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m20:18:05.229658 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m20:18:05.253167 [debug] [Thread-3 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m20:18:05.259947 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m20:18:05.279937 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m20:18:05.282625 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m20:18:05.283761 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:18:22.496033 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 17.129 seconds
[0m20:18:22.500931 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m20:18:22.502287 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m20:18:22.574532 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.071 seconds
[0m20:18:22.578601 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m20:18:22.579884 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m20:18:22.582915 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:18:22.585308 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m20:18:22.586632 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m20:18:22.587918 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m20:18:22.604180 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m20:18:22.607584 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m20:18:22.609444 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m20:18:22.610671 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m20:18:22.692390 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.081 seconds
[0m20:18:22.694752 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: Close
[0m20:18:22.696168 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7c58a150>]}
[0m20:18:22.697617 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 17.47s]
[0m20:18:22.699217 [debug] [Thread-3 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m20:18:22.701314 [debug] [Thread-2 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m20:18:22.701846 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_daily_revenue
[0m20:18:22.702309 [debug] [Thread-4 (]: Began running node model.my_dbt.mart_payment_type
[0m20:18:22.703499 [info ] [Thread-2 (]: 3 of 5 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m20:18:22.704994 [info ] [Thread-1 (]: 4 of 5 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m20:18:22.706378 [info ] [Thread-4 (]: 5 of 5 START sql table model public.mart_payment_type .......................... [RUN]
[0m20:18:22.707807 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips_enriched'
[0m20:18:22.708981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_daily_revenue)
[0m20:18:22.710297 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.mart_payment_type'
[0m20:18:22.711556 [debug] [Thread-2 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m20:18:22.712686 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m20:18:22.713906 [debug] [Thread-4 (]: Began compiling node model.my_dbt.mart_payment_type
[0m20:18:22.718968 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m20:18:22.722426 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m20:18:22.726103 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m20:18:22.741784 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m20:18:22.742439 [debug] [Thread-4 (]: Began executing node model.my_dbt.mart_payment_type
[0m20:18:22.742947 [debug] [Thread-2 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m20:18:22.747601 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m20:18:22.754141 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m20:18:22.759489 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m20:18:22.775054 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m20:18:22.775885 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m20:18:22.776486 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m20:18:22.777678 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m20:18:22.779284 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m20:18:22.781179 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m20:18:22.782867 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:18:22.784524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:22.786306 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:18:23.432203 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.646 seconds
[0m20:18:23.432794 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.648 seconds
[0m20:18:23.436701 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m20:18:23.441072 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m20:18:23.442554 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m20:18:23.444006 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m20:18:23.447644 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:18:23.448164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:18:23.452144 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m20:18:23.456427 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m20:18:23.457891 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m20:18:23.458947 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m20:18:23.462347 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:18:23.462967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:18:23.465217 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m20:18:23.468019 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m20:18:23.469316 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m20:18:23.470552 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m20:18:23.471685 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m20:18:23.472860 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m20:18:23.547649 [debug] [Thread-4 (]: SQL status: COMMIT in 0.073 seconds
[0m20:18:23.552395 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m20:18:23.553637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.079 seconds
[0m20:18:23.554547 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m20:18:23.557932 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m20:18:23.559291 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m20:18:23.560871 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m20:18:23.563364 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m20:18:23.599303 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.037 seconds
[0m20:18:23.601871 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: Close
[0m20:18:23.603320 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7c49b110>]}
[0m20:18:23.608595 [info ] [Thread-4 (]: 5 of 5 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 0.89s]
[0m20:18:23.610979 [debug] [Thread-4 (]: Finished running node model.my_dbt.mart_payment_type
[0m20:18:23.612010 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.046 seconds
[0m20:18:23.615071 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: Close
[0m20:18:23.616567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7c4b6e40>]}
[0m20:18:23.618600 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.mart_daily_revenue .................... [[32mSELECT 33[0m in 0.91s]
[0m20:18:23.620151 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m20:19:15.712040 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 52.841 seconds
[0m20:19:15.718111 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m20:19:15.720013 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched" rename to "fct_yellow_trips_enriched__dbt_backup"
[0m20:19:15.722551 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:19:15.726886 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m20:19:15.728153 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m20:19:15.731706 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:19:15.734396 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m20:19:15.736235 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m20:19:15.737709 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m20:19:15.753372 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m20:19:15.757429 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m20:19:15.759816 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m20:19:15.761134 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m20:19:15.923647 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.161 seconds
[0m20:19:15.926895 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m20:19:15.929042 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c651e0a4-954a-4de4-881c-4ced6370ac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7c482c90>]}
[0m20:19:15.931624 [info ] [Thread-2 (]: 3 of 5 OK created sql table model public.fct_yellow_trips_enriched ............. [[32mSELECT 3475226[0m in 53.22s]
[0m20:19:15.933359 [debug] [Thread-2 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m20:19:15.937596 [debug] [MainThread]: On master: COMMIT
[0m20:19:15.939163 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:15.941185 [debug] [MainThread]: On master: COMMIT
[0m20:19:15.942255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:15.959803 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m20:19:15.962482 [debug] [MainThread]: On master: Close
[0m20:19:15.965218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:15.969761 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m20:19:15.972705 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m20:19:15.975626 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m20:19:15.977640 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m20:19:15.980883 [info ] [MainThread]: 
[0m20:19:15.983333 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 19.37 seconds (79.37s).
[0m20:19:15.986968 [debug] [MainThread]: Command end result
[0m20:19:16.045193 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m20:19:16.064793 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m20:19:16.160100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m20:19:16.170116 [info ] [MainThread]: 
[0m20:19:16.181644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:16.186159 [info ] [MainThread]: 
[0m20:19:16.189652 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:19:16.196148 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 82.07672, "process_in_blocks": "800", "process_kernel_time": 0.408356, "process_mem_max_rss": "133728", "process_out_blocks": "0", "process_user_time": 4.630681}
[0m20:19:16.199332 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:16.198849 after 82.08 seconds
[0m20:19:16.209486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a807da330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7ebcf560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a7e3b63f0>]}
[0m20:19:16.214039 [debug] [MainThread]: Flushing usage events
[0m20:19:16.328859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:23.659132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b5688e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b568a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b48732c0>]}


============================== 20:19:23.675927 | 6e4e3641-5aec-4036-b9b6-8180db06226e ==============================
[0m20:19:23.675927 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:19:23.679134 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles --select stg_yellow_tripdata+ fct_yellow_trips_enriched', 'target_path': 'None', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'empty': 'None', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False'}
[0m20:19:24.364047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e4e3641-5aec-4036-b9b6-8180db06226e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b5f14740>]}
[0m20:19:24.591721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e4e3641-5aec-4036-b9b6-8180db06226e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b59ac1d0>]}
[0m20:19:24.598929 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:19:24.795354 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:19:25.394944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:25.399323 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:19:25.403032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:25.519148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4e3641-5aec-4036-b9b6-8180db06226e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b3da37a0>]}
[0m20:19:25.696470 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m20:19:25.709667 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m20:19:26.157301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4e3641-5aec-4036-b9b6-8180db06226e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b2975640>]}
[0m20:19:26.168463 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m20:19:26.174112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4e3641-5aec-4036-b9b6-8180db06226e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b3965df0>]}
[0m20:19:26.180377 [info ] [MainThread]: 
[0m20:19:26.191608 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:26.198270 [info ] [MainThread]: 
[0m20:19:26.202263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:19:26.218707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m20:19:26.311856 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m20:19:26.315540 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:19:26.319015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:26.417470 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.098 seconds
[0m20:19:26.453869 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m20:19:26.482874 [debug] [ThreadPool]: On list_de_db_public: Close
[0m20:19:26.530195 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:26.544687 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:19:26.551603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:26.652112 [debug] [MainThread]: SQL status: SELECT 0 in 0.100 seconds
[0m20:19:26.672241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4e3641-5aec-4036-b9b6-8180db06226e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b39016d0>]}
[0m20:19:26.682535 [debug] [MainThread]: On master: ROLLBACK
[0m20:19:26.699886 [debug] [MainThread]: On master: COMMIT
[0m20:19:26.703213 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:26.706018 [debug] [MainThread]: On master: COMMIT
[0m20:19:26.715483 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m20:19:26.718473 [debug] [MainThread]: On master: Close
[0m20:19:26.737254 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m20:19:26.740577 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:19:26.741744 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m20:19:26.743597 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m20:19:26.745769 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m20:19:26.747506 [info ] [Thread-3 (]: 3 of 3 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m20:19:26.749838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001)
[0m20:19:26.752241 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m20:19:26.756825 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786'
[0m20:19:26.759525 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m20:19:26.761859 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:19:26.764670 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m20:19:26.810176 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m20:19:26.812167 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:19:26.820300 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m20:19:26.842332 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m20:19:26.843445 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:19:26.850992 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m20:19:26.877327 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m20:19:26.878350 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:19:26.882714 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m20:19:26.902993 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m20:19:26.904157 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m20:19:26.905050 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m20:19:26.906688 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m20:19:26.908719 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m20:19:26.911778 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m20:19:26.914044 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:19:26.917854 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:19:26.920482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:27.350805 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.433 seconds
[0m20:19:27.359671 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m20:19:27.362935 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.442 seconds
[0m20:19:27.384596 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m20:19:27.397867 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m20:19:27.417850 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.67s]
[0m20:19:27.424814 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m20:19:27.431056 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.517 seconds
[0m20:19:27.433132 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m20:19:27.438969 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 0.69s]
[0m20:19:27.449084 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m20:19:27.453334 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m20:19:27.465935 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m20:19:27.472052 [info ] [Thread-3 (]: 3 of 3 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 0.72s]
[0m20:19:27.476726 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m20:19:27.481765 [debug] [MainThread]: On master: COMMIT
[0m20:19:27.484032 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:27.485408 [debug] [MainThread]: On master: COMMIT
[0m20:19:27.486968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:27.502002 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m20:19:27.503533 [debug] [MainThread]: On master: Close
[0m20:19:27.505653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:27.507819 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m20:19:27.510020 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m20:19:27.512290 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m20:19:27.513618 [info ] [MainThread]: 
[0m20:19:27.514831 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m20:19:27.518479 [debug] [MainThread]: Command end result
[0m20:19:27.556771 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m20:19:27.562971 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m20:19:27.578092 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m20:19:27.580629 [info ] [MainThread]: 
[0m20:19:27.583148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:27.585046 [info ] [MainThread]: 
[0m20:19:27.586486 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:19:27.589837 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.1943116, "process_in_blocks": "0", "process_kernel_time": 0.643038, "process_mem_max_rss": "128756", "process_out_blocks": "0", "process_user_time": 5.479802}
[0m20:19:27.591583 [debug] [MainThread]: Command `dbt test` succeeded at 20:19:27.591368 after 4.20 seconds
[0m20:19:27.592608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b48266c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b2d63c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d31b5f41a30>]}
[0m20:19:27.593763 [debug] [MainThread]: Flushing usage events
[0m20:19:27.649740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:19:59.280227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f7f10f3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f7f0e69b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f7f2bb0d40>]}


============================== 20:19:59.289265 | 68e30dac-11d9-4d0a-a86f-ceffc64167e0 ==============================
[0m20:19:59.289265 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:19:59.291180 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'log_cache_events': 'False'}
[0m20:19:59.303497 [info ] [MainThread]: dbt version: 1.11.2
[0m20:19:59.305082 [info ] [MainThread]: python version: 3.12.4
[0m20:19:59.306287 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:19:59.307323 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m20:19:59.402458 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m20:19:59.404263 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m20:19:59.405521 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m20:19:59.406964 [info ] [MainThread]: adapter type: postgres
[0m20:19:59.408163 [info ] [MainThread]: adapter version: 1.10.0
[0m20:19:59.540000 [info ] [MainThread]: Configuration:
[0m20:19:59.541740 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:19:59.543436 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:19:59.545206 [info ] [MainThread]: Required dependencies:
[0m20:19:59.546771 [debug] [MainThread]: Executing "git --help"
[0m20:19:59.549144 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m20:19:59.550944 [info ] [MainThread]: Connection:
[0m20:19:59.552558 [info ] [MainThread]:   host: host.docker.internal
[0m20:19:59.554404 [info ] [MainThread]:   port: 6543
[0m20:19:59.555939 [info ] [MainThread]:   user: de_user
[0m20:19:59.557253 [info ] [MainThread]:   database: de_db
[0m20:19:59.558775 [info ] [MainThread]:   schema: public
[0m20:19:59.560560 [info ] [MainThread]:   connect_timeout: 10
[0m20:19:59.561874 [info ] [MainThread]:   role: None
[0m20:19:59.562984 [info ] [MainThread]:   search_path: None
[0m20:19:59.564218 [info ] [MainThread]:   keepalives_idle: 0
[0m20:19:59.565660 [info ] [MainThread]:   sslmode: None
[0m20:19:59.567122 [info ] [MainThread]:   sslcert: None
[0m20:19:59.568414 [info ] [MainThread]:   sslkey: None
[0m20:19:59.569821 [info ] [MainThread]:   sslrootcert: None
[0m20:19:59.571427 [info ] [MainThread]:   application_name: dbt
[0m20:19:59.572884 [info ] [MainThread]:   retries: 1
[0m20:19:59.574173 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:19:59.661502 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:19:59.691293 [debug] [MainThread]: Using postgres connection "debug"
[0m20:19:59.693200 [debug] [MainThread]: On debug: select 1 as id
[0m20:19:59.694445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:59.713368 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m20:19:59.716166 [debug] [MainThread]: On debug: Close
[0m20:19:59.717560 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:19:59.719133 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:19:59.721186 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m20:19:59.723779 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5202281, "process_in_blocks": "0", "process_kernel_time": 0.259829, "process_mem_max_rss": "119736", "process_out_blocks": "0", "process_user_time": 2.506357}
[0m20:19:59.725513 [debug] [MainThread]: Command `dbt debug` failed at 20:19:59.725073 after 0.52 seconds
[0m20:19:59.727004 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:19:59.728269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f7f0583c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f7ef75a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f7f18a9790>]}
[0m20:19:59.729637 [debug] [MainThread]: Flushing usage events
[0m20:19:59.781480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:04.245553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c46941ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c46b459220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c4692284d0>]}


============================== 20:22:04.253406 | fcd05140-3fd7-4b01-b2d7-ccef1e9c196a ==============================
[0m20:22:04.253406 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:22:04.254789 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'use_experimental_parser': 'False', 'no_print': 'None', 'empty': 'None', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m20:22:04.264375 [info ] [MainThread]: dbt version: 1.11.2
[0m20:22:04.265737 [info ] [MainThread]: python version: 3.12.4
[0m20:22:04.266748 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m20:22:04.267726 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m20:22:04.372538 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m20:22:04.374258 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m20:22:04.376163 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m20:22:04.377859 [info ] [MainThread]: adapter type: postgres
[0m20:22:04.379580 [info ] [MainThread]: adapter version: 1.10.0
[0m20:22:04.509672 [info ] [MainThread]: Configuration:
[0m20:22:04.511030 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:22:04.512051 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:22:04.513176 [info ] [MainThread]: Required dependencies:
[0m20:22:04.514573 [debug] [MainThread]: Executing "git --help"
[0m20:22:04.516678 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m20:22:04.518100 [info ] [MainThread]: Connection:
[0m20:22:04.519842 [info ] [MainThread]:   host: host.docker.internal
[0m20:22:04.521497 [info ] [MainThread]:   port: 6543
[0m20:22:04.522980 [info ] [MainThread]:   user: de_user
[0m20:22:04.524191 [info ] [MainThread]:   database: de_db
[0m20:22:04.525647 [info ] [MainThread]:   schema: public
[0m20:22:04.526847 [info ] [MainThread]:   connect_timeout: 10
[0m20:22:04.527944 [info ] [MainThread]:   role: None
[0m20:22:04.529133 [info ] [MainThread]:   search_path: None
[0m20:22:04.530212 [info ] [MainThread]:   keepalives_idle: 0
[0m20:22:04.531505 [info ] [MainThread]:   sslmode: None
[0m20:22:04.532582 [info ] [MainThread]:   sslcert: None
[0m20:22:04.533653 [info ] [MainThread]:   sslkey: None
[0m20:22:04.534724 [info ] [MainThread]:   sslrootcert: None
[0m20:22:04.536199 [info ] [MainThread]:   application_name: dbt
[0m20:22:04.537537 [info ] [MainThread]:   retries: 1
[0m20:22:04.538828 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:22:04.624796 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:22:04.656977 [debug] [MainThread]: Using postgres connection "debug"
[0m20:22:04.658824 [debug] [MainThread]: On debug: select 1 as id
[0m20:22:04.660450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:04.681528 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m20:22:04.684048 [debug] [MainThread]: On debug: Close
[0m20:22:04.686145 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:22:04.687852 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:22:04.689110 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m20:22:04.692833 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5234727, "process_in_blocks": "0", "process_kernel_time": 0.248179, "process_mem_max_rss": "119432", "process_out_blocks": "0", "process_user_time": 2.281646}
[0m20:22:04.694467 [debug] [MainThread]: Command `dbt debug` failed at 20:22:04.694200 after 0.53 seconds
[0m20:22:04.696458 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:22:04.697648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c469113170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c46a119940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c46a11bb30>]}
[0m20:22:04.698745 [debug] [MainThread]: Flushing usage events
[0m20:22:04.760655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:17.245861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee8f76a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee9e1bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee9fb3530>]}


============================== 21:03:17.255290 | f5de64ed-70d6-422a-8590-257e3e801d4a ==============================
[0m21:03:17.255290 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:03:17.257004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'partial_parse': 'True', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt_profiles', 'version_check': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'write_json': 'True', 'debug': 'False', 'no_print': 'None'}
[0m21:03:17.273061 [info ] [MainThread]: dbt version: 1.11.2
[0m21:03:17.274152 [info ] [MainThread]: python version: 3.12.4
[0m21:03:17.275192 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m21:03:17.276628 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m21:03:17.386770 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m21:03:17.388567 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m21:03:17.389591 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m21:03:17.390845 [info ] [MainThread]: adapter type: postgres
[0m21:03:17.392258 [info ] [MainThread]: adapter version: 1.10.0
[0m21:03:17.540965 [info ] [MainThread]: Configuration:
[0m21:03:17.542904 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:03:17.544161 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:03:17.545256 [info ] [MainThread]: Required dependencies:
[0m21:03:17.546291 [debug] [MainThread]: Executing "git --help"
[0m21:03:17.549366 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m21:03:17.550588 [info ] [MainThread]: Connection:
[0m21:03:17.551867 [info ] [MainThread]:   host: host.docker.internal
[0m21:03:17.553911 [info ] [MainThread]:   port: 6543
[0m21:03:17.555188 [info ] [MainThread]:   user: de_user
[0m21:03:17.556190 [info ] [MainThread]:   database: de_db
[0m21:03:17.557310 [info ] [MainThread]:   schema: public
[0m21:03:17.559553 [info ] [MainThread]:   connect_timeout: 10
[0m21:03:17.560846 [info ] [MainThread]:   role: None
[0m21:03:17.561816 [info ] [MainThread]:   search_path: None
[0m21:03:17.563002 [info ] [MainThread]:   keepalives_idle: 0
[0m21:03:17.564886 [info ] [MainThread]:   sslmode: None
[0m21:03:17.566176 [info ] [MainThread]:   sslcert: None
[0m21:03:17.567193 [info ] [MainThread]:   sslkey: None
[0m21:03:17.568339 [info ] [MainThread]:   sslrootcert: None
[0m21:03:17.570385 [info ] [MainThread]:   application_name: dbt
[0m21:03:17.571827 [info ] [MainThread]:   retries: 1
[0m21:03:17.573033 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:03:17.664923 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:03:17.719613 [debug] [MainThread]: Using postgres connection "debug"
[0m21:03:17.720922 [debug] [MainThread]: On debug: select 1 as id
[0m21:03:17.722056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:17.746688 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m21:03:17.749130 [debug] [MainThread]: On debug: Close
[0m21:03:17.750809 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:03:17.754329 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:03:17.758910 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m21:03:17.762042 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.58542264, "process_in_blocks": "0", "process_kernel_time": 0.625648, "process_mem_max_rss": "119800", "process_out_blocks": "0", "process_user_time": 2.304808}
[0m21:03:17.764161 [debug] [MainThread]: Command `dbt debug` failed at 21:03:17.763931 after 0.59 seconds
[0m21:03:17.765403 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:03:17.766641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eea2890a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee8d37020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee8d57fb0>]}
[0m21:03:17.768291 [debug] [MainThread]: Flushing usage events
[0m21:03:17.906572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:00.117886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7832616ca720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7832616ca7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7832616ca3f0>]}


============================== 21:04:00.125429 | f6eea9d9-c246-4fcb-a1fd-0d9e19797599 ==============================
[0m21:04:00.125429 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:04:00.126941 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'target_path': 'None', 'fail_fast': 'False', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt_profiles', 'debug': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'static_parser': 'True'}
[0m21:04:00.137673 [info ] [MainThread]: dbt version: 1.11.2
[0m21:04:00.139455 [info ] [MainThread]: python version: 3.12.4
[0m21:04:00.140814 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m21:04:00.142007 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m21:04:00.248328 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m21:04:00.249871 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m21:04:00.251559 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m21:04:00.253239 [info ] [MainThread]: adapter type: postgres
[0m21:04:00.254472 [info ] [MainThread]: adapter version: 1.10.0
[0m21:04:00.436720 [info ] [MainThread]: Configuration:
[0m21:04:00.438486 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:04:00.439691 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:04:00.440700 [info ] [MainThread]: Required dependencies:
[0m21:04:00.442159 [debug] [MainThread]: Executing "git --help"
[0m21:04:00.444572 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m21:04:00.445661 [info ] [MainThread]: Connection:
[0m21:04:00.446660 [info ] [MainThread]:   host: host.docker.internal
[0m21:04:00.448272 [info ] [MainThread]:   port: 6543
[0m21:04:00.449710 [info ] [MainThread]:   user: de_user
[0m21:04:00.450791 [info ] [MainThread]:   database: de_db
[0m21:04:00.451745 [info ] [MainThread]:   schema: public
[0m21:04:00.452940 [info ] [MainThread]:   connect_timeout: 10
[0m21:04:00.454680 [info ] [MainThread]:   role: None
[0m21:04:00.455813 [info ] [MainThread]:   search_path: None
[0m21:04:00.456713 [info ] [MainThread]:   keepalives_idle: 0
[0m21:04:00.457530 [info ] [MainThread]:   sslmode: None
[0m21:04:00.458608 [info ] [MainThread]:   sslcert: None
[0m21:04:00.460837 [info ] [MainThread]:   sslkey: None
[0m21:04:00.461900 [info ] [MainThread]:   sslrootcert: None
[0m21:04:00.462877 [info ] [MainThread]:   application_name: dbt
[0m21:04:00.463943 [info ] [MainThread]:   retries: 1
[0m21:04:00.465859 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:04:00.572863 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:04:00.604566 [debug] [MainThread]: Using postgres connection "debug"
[0m21:04:00.606250 [debug] [MainThread]: On debug: select 1 as id
[0m21:04:00.607241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:00.624390 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m21:04:00.626077 [debug] [MainThread]: On debug: Close
[0m21:04:00.627229 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:04:00.629811 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:04:00.631142 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m21:04:00.632958 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5927971, "process_in_blocks": "0", "process_kernel_time": 0.280801, "process_mem_max_rss": "119688", "process_out_blocks": "0", "process_user_time": 2.274093}
[0m21:04:00.634055 [debug] [MainThread]: Command `dbt debug` failed at 21:04:00.633854 after 0.59 seconds
[0m21:04:00.634987 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:04:00.635738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7832629f9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783265a7eff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7832622c58b0>]}
[0m21:04:00.636521 [debug] [MainThread]: Flushing usage events
[0m21:04:00.709492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:23.601680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79baceb39820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacec74c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bad0ec7a10>]}


============================== 21:04:23.608213 | 995e49cf-bb25-426b-b6ad-a2febac0596e ==============================
[0m21:04:23.608213 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:04:23.609512 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles --select stg_yellow_tripdata+ fct_yellow_trips_enriched', 'profiles_dir': '/opt/airflow/dbt_profiles', 'static_parser': 'True', 'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m21:04:23.609552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86bd12300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86c330f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86bd11b50>]}


============================== 21:04:23.616259 | c7d615fd-ea2e-4d48-bf34-d6ff03983f45 ==============================
[0m21:04:23.616259 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:04:23.617657 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'empty': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles'}
[0m21:04:23.626562 [info ] [MainThread]: dbt version: 1.11.2
[0m21:04:23.627756 [info ] [MainThread]: python version: 3.12.4
[0m21:04:23.628839 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m21:04:23.629888 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m21:04:23.720705 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m21:04:23.722263 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m21:04:23.723489 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m21:04:23.724778 [info ] [MainThread]: adapter type: postgres
[0m21:04:23.725820 [info ] [MainThread]: adapter version: 1.10.0
[0m21:04:23.836772 [info ] [MainThread]: Configuration:
[0m21:04:23.838307 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:04:23.839411 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:04:23.840401 [info ] [MainThread]: Required dependencies:
[0m21:04:23.841381 [debug] [MainThread]: Executing "git --help"
[0m21:04:23.843213 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m21:04:23.844291 [info ] [MainThread]: Connection:
[0m21:04:23.845315 [info ] [MainThread]:   host: host.docker.internal
[0m21:04:23.846226 [info ] [MainThread]:   port: 6543
[0m21:04:23.847359 [info ] [MainThread]:   user: de_user
[0m21:04:23.848373 [info ] [MainThread]:   database: de_db
[0m21:04:23.849163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bad0851d60>]}
[0m21:04:23.849549 [info ] [MainThread]:   schema: public
[0m21:04:23.850642 [info ] [MainThread]:   connect_timeout: 10
[0m21:04:23.851790 [info ] [MainThread]:   role: None
[0m21:04:23.852848 [info ] [MainThread]:   search_path: None
[0m21:04:23.853998 [info ] [MainThread]:   keepalives_idle: 0
[0m21:04:23.855084 [info ] [MainThread]:   sslmode: None
[0m21:04:23.856210 [info ] [MainThread]:   sslcert: None
[0m21:04:23.857352 [info ] [MainThread]:   sslkey: None
[0m21:04:23.858473 [info ] [MainThread]:   sslrootcert: None
[0m21:04:23.859685 [info ] [MainThread]:   application_name: dbt
[0m21:04:23.860854 [info ] [MainThread]:   retries: 1
[0m21:04:23.862148 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:04:23.917970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacec88890>]}
[0m21:04:23.919502 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:04:23.937535 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:04:23.965478 [debug] [MainThread]: Using postgres connection "debug"
[0m21:04:23.966706 [debug] [MainThread]: On debug: select 1 as id
[0m21:04:23.967783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:23.983974 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m21:04:23.985697 [debug] [MainThread]: On debug: Close
[0m21:04:23.986678 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:04:23.989687 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:04:23.990804 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m21:04:23.992418 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.45421454, "process_in_blocks": "0", "process_kernel_time": 0.309972, "process_mem_max_rss": "119160", "process_out_blocks": "0", "process_user_time": 2.290573}
[0m21:04:23.993487 [debug] [MainThread]: Command `dbt debug` failed at 21:04:23.993367 after 0.46 seconds
[0m21:04:23.994448 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:04:23.995523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86c0af470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86c331430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc86bdfd9a0>]}
[0m21:04:23.996550 [debug] [MainThread]: Flushing usage events
[0m21:04:24.008034 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:04:24.106756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:24.312278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:24.313926 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:04:24.315157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:24.369355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacd6cf260>]}
[0m21:04:24.480487 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m21:04:24.487396 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m21:04:24.516779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacc7810d0>]}
[0m21:04:24.518370 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m21:04:24.519941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacd345400>]}
[0m21:04:24.523568 [info ] [MainThread]: 
[0m21:04:24.524822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:04:24.525904 [info ] [MainThread]: 
[0m21:04:24.527407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:04:24.533011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m21:04:24.567169 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m21:04:24.568476 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m21:04:24.569654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:24.584959 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m21:04:24.587281 [debug] [ThreadPool]: On list_de_db: Close
[0m21:04:24.589965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_db, now list_de_db_public)
[0m21:04:24.596344 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m21:04:24.597619 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:04:24.598613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:24.615386 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.017 seconds
[0m21:04:24.618301 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m21:04:24.621145 [debug] [ThreadPool]: On list_de_db_public: Close
[0m21:04:24.634974 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:24.636374 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:04:24.637656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:24.656778 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m21:04:24.659247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacc770a40>]}
[0m21:04:24.660608 [debug] [MainThread]: On master: ROLLBACK
[0m21:04:24.663223 [debug] [MainThread]: On master: COMMIT
[0m21:04:24.664501 [debug] [MainThread]: Using postgres connection "master"
[0m21:04:24.665630 [debug] [MainThread]: On master: COMMIT
[0m21:04:24.669643 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m21:04:24.670929 [debug] [MainThread]: On master: Close
[0m21:04:24.677172 [debug] [Thread-1 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m21:04:24.678670 [info ] [Thread-1 (]: 1 of 5 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m21:04:24.680198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now model.my_dbt.stg_yellow_tripdata)
[0m21:04:24.681492 [debug] [Thread-1 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m21:04:24.688745 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m21:04:24.700246 [debug] [Thread-1 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m21:04:24.734554 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m21:04:24.745003 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:04:24.746201 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m21:04:24.747362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:37.948064 [debug] [Thread-1 (]: SQL status: SELECT 3475226 in 13.117 seconds
[0m21:04:37.956886 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:04:37.958163 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m21:04:37.961736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:04:37.965413 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:04:37.966493 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m21:04:37.969189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:04:37.984432 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m21:04:37.985677 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:04:37.986707 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m21:04:38.058879 [debug] [Thread-1 (]: SQL status: COMMIT in 0.070 seconds
[0m21:04:38.070267 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m21:04:38.077446 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:04:38.078897 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m21:04:38.262944 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.183 seconds
[0m21:04:38.266664 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m21:04:38.269183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacf22da00>]}
[0m21:04:38.270670 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 13.59s]
[0m21:04:38.272038 [debug] [Thread-1 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m21:04:38.273910 [debug] [Thread-3 (]: Began running node model.my_dbt.fct_yellow_trips
[0m21:04:38.275371 [info ] [Thread-3 (]: 2 of 5 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m21:04:38.276744 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips'
[0m21:04:38.277907 [debug] [Thread-3 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m21:04:38.281303 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m21:04:38.290919 [debug] [Thread-3 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m21:04:38.295880 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m21:04:38.306190 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:04:38.307792 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m21:04:38.309042 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:05:00.066790 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 21.670 seconds
[0m21:05:00.071489 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:05:00.072831 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m21:05:00.075675 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:05:00.079803 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:05:00.081039 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m21:05:00.083724 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:05:00.086322 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m21:05:00.087668 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:05:00.088836 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m21:05:00.105688 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m21:05:00.112142 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m21:05:00.113817 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:05:00.114958 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m21:05:00.314551 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.198 seconds
[0m21:05:00.317062 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: Close
[0m21:05:00.318358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacbb4e090>]}
[0m21:05:00.320344 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 22.04s]
[0m21:05:00.323045 [debug] [Thread-3 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m21:05:00.325885 [debug] [Thread-2 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m21:05:00.326901 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_daily_revenue
[0m21:05:00.327643 [debug] [Thread-4 (]: Began running node model.my_dbt.mart_payment_type
[0m21:05:00.329381 [info ] [Thread-2 (]: 3 of 5 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m21:05:00.331416 [info ] [Thread-1 (]: 4 of 5 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m21:05:00.333712 [info ] [Thread-4 (]: 5 of 5 START sql table model public.mart_payment_type .......................... [RUN]
[0m21:05:00.335649 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips_enriched'
[0m21:05:00.337741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_daily_revenue)
[0m21:05:00.339381 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.mart_payment_type'
[0m21:05:00.341011 [debug] [Thread-2 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m21:05:00.342701 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m21:05:00.344582 [debug] [Thread-4 (]: Began compiling node model.my_dbt.mart_payment_type
[0m21:05:00.348771 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m21:05:00.352283 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m21:05:00.355758 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m21:05:00.362661 [debug] [Thread-4 (]: Began executing node model.my_dbt.mart_payment_type
[0m21:05:00.363271 [debug] [Thread-2 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m21:05:00.369764 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m21:05:00.370800 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m21:05:00.375513 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m21:05:00.380083 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m21:05:00.386427 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:05:00.387561 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:05:00.388480 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m21:05:00.389048 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:05:00.389953 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m21:05:00.391196 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:05:00.392415 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m21:05:00.393666 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:05:00.396254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:00.976692 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.583 seconds
[0m21:05:00.977192 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.581 seconds
[0m21:05:00.980781 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:05:00.984751 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:05:00.986209 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m21:05:00.987297 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m21:05:00.990204 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:05:00.990685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:05:00.993841 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:05:00.997733 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:05:00.998830 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m21:05:00.999852 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m21:05:01.003679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:05:01.004154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:05:01.006372 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m21:05:01.008823 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m21:05:01.009970 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:05:01.011093 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:05:01.012675 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m21:05:01.014087 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m21:05:01.082720 [debug] [Thread-4 (]: SQL status: COMMIT in 0.067 seconds
[0m21:05:01.086343 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m21:05:01.088383 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:05:01.089834 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m21:05:01.101135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.085 seconds
[0m21:05:01.104470 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m21:05:01.106159 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:05:01.107462 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m21:05:01.119435 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.028 seconds
[0m21:05:01.122255 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: Close
[0m21:05:01.123830 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacbb5d280>]}
[0m21:05:01.125593 [info ] [Thread-4 (]: 5 of 5 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 0.78s]
[0m21:05:01.127482 [debug] [Thread-4 (]: Finished running node model.my_dbt.mart_payment_type
[0m21:05:01.139241 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.031 seconds
[0m21:05:01.141768 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: Close
[0m21:05:01.143284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacbb5cb00>]}
[0m21:05:01.144814 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.mart_daily_revenue .................... [[32mSELECT 33[0m in 0.81s]
[0m21:05:01.146469 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m21:06:06.917302 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 66.346 seconds
[0m21:06:06.921686 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:06:06.922937 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched" rename to "fct_yellow_trips_enriched__dbt_backup"
[0m21:06:06.926118 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:06:06.930985 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:06:06.932265 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m21:06:06.935345 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:06:06.937722 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m21:06:06.938880 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:06:06.940013 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m21:06:06.987398 [debug] [Thread-2 (]: SQL status: COMMIT in 0.046 seconds
[0m21:06:06.990840 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m21:06:06.992570 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:06:06.993719 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m21:06:07.106094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca0a53ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca0b4d3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca0a53eed0>]}


============================== 21:06:07.117749 | 65f15ed1-ec04-4e02-a566-0f3f2c399095 ==============================
[0m21:06:07.117749 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:06:07.119324 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles', 'empty': 'None', 'log_cache_events': 'False', 'printer_width': '80'}
[0m21:06:07.130001 [info ] [MainThread]: dbt version: 1.11.2
[0m21:06:07.131221 [info ] [MainThread]: python version: 3.12.4
[0m21:06:07.132250 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m21:06:07.133277 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m21:06:07.223317 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m21:06:07.224731 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m21:06:07.225849 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m21:06:07.227211 [info ] [MainThread]: adapter type: postgres
[0m21:06:07.228372 [info ] [MainThread]: adapter version: 1.10.0
[0m21:06:07.262523 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.268 seconds
[0m21:06:07.265189 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m21:06:07.266667 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e49cf-bb25-426b-b6ad-a2febac0596e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacafe3bc0>]}
[0m21:06:07.268372 [info ] [Thread-2 (]: 3 of 5 OK created sql table model public.fct_yellow_trips_enriched ............. [[32mSELECT 3475226[0m in 66.93s]
[0m21:06:07.270146 [debug] [Thread-2 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m21:06:07.272984 [debug] [MainThread]: On master: COMMIT
[0m21:06:07.274259 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:07.275379 [debug] [MainThread]: On master: COMMIT
[0m21:06:07.276400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:06:07.291501 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m21:06:07.292714 [debug] [MainThread]: On master: Close
[0m21:06:07.293894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:07.294942 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m21:06:07.296150 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m21:06:07.297144 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m21:06:07.298149 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m21:06:07.299335 [info ] [MainThread]: 
[0m21:06:07.300541 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 42.77 seconds (102.77s).
[0m21:06:07.302886 [debug] [MainThread]: Command end result
[0m21:06:07.344132 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m21:06:07.351064 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m21:06:07.355835 [info ] [MainThread]: Configuration:
[0m21:06:07.357198 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:06:07.358404 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:06:07.359508 [info ] [MainThread]: Required dependencies:
[0m21:06:07.360598 [debug] [MainThread]: Executing "git --help"
[0m21:06:07.361967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m21:06:07.362514 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m21:06:07.363146 [info ] [MainThread]: 
[0m21:06:07.363682 [info ] [MainThread]: Connection:
[0m21:06:07.364265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:07.364894 [info ] [MainThread]:   host: host.docker.internal
[0m21:06:07.365313 [info ] [MainThread]: 
[0m21:06:07.366076 [info ] [MainThread]:   port: 6543
[0m21:06:07.366352 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:06:07.367227 [info ] [MainThread]:   user: de_user
[0m21:06:07.368239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 103.488785, "process_in_blocks": "0", "process_kernel_time": 0.312565, "process_mem_max_rss": "128488", "process_out_blocks": "0", "process_user_time": 3.101298}
[0m21:06:07.368409 [info ] [MainThread]:   database: de_db
[0m21:06:07.369528 [debug] [MainThread]: Command `dbt run` succeeded at 21:06:07.369405 after 103.49 seconds
[0m21:06:07.369464 [info ] [MainThread]:   schema: public
[0m21:06:07.370702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bace2e18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacedc8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bacc7262d0>]}
[0m21:06:07.370611 [info ] [MainThread]:   connect_timeout: 10
[0m21:06:07.371806 [info ] [MainThread]:   role: None
[0m21:06:07.371843 [debug] [MainThread]: Flushing usage events
[0m21:06:07.372871 [info ] [MainThread]:   search_path: None
[0m21:06:07.373950 [info ] [MainThread]:   keepalives_idle: 0
[0m21:06:07.375067 [info ] [MainThread]:   sslmode: None
[0m21:06:07.376100 [info ] [MainThread]:   sslcert: None
[0m21:06:07.377389 [info ] [MainThread]:   sslkey: None
[0m21:06:07.378562 [info ] [MainThread]:   sslrootcert: None
[0m21:06:07.379621 [info ] [MainThread]:   application_name: dbt
[0m21:06:07.380703 [info ] [MainThread]:   retries: 1
[0m21:06:07.381870 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:06:07.463721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:07.466331 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:06:07.507253 [debug] [MainThread]: Using postgres connection "debug"
[0m21:06:07.508486 [debug] [MainThread]: On debug: select 1 as id
[0m21:06:07.509523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:07.530603 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m21:06:07.532676 [debug] [MainThread]: On debug: Close
[0m21:06:07.533752 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:06:07.534892 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:06:07.535965 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m21:06:07.537783 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.52512133, "process_in_blocks": "0", "process_kernel_time": 0.283576, "process_mem_max_rss": "119540", "process_out_blocks": "0", "process_user_time": 2.048939}
[0m21:06:07.539220 [debug] [MainThread]: Command `dbt debug` failed at 21:06:07.539043 after 0.53 seconds
[0m21:06:07.540286 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:06:07.541354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca09a58860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca09a5adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca090c2c30>]}
[0m21:06:07.542445 [debug] [MainThread]: Flushing usage events
[0m21:06:07.598342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:11.440123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ae1a7a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ae14d42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ae15925a0>]}


============================== 21:06:11.446743 | 59bfe35e-d62b-4fef-88ab-cbf702318186 ==============================
[0m21:06:11.446743 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:06:11.448044 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt_profiles', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles --select stg_yellow_tripdata+ fct_yellow_trips_enriched'}
[0m21:06:11.662131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59bfe35e-d62b-4fef-88ab-cbf702318186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ae05ba240>]}
[0m21:06:11.729143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59bfe35e-d62b-4fef-88ab-cbf702318186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ae0893bf0>]}
[0m21:06:11.730832 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:06:11.817213 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:06:12.113912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:12.115151 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:06:12.116286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:12.164769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59bfe35e-d62b-4fef-88ab-cbf702318186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717adf9ef680>]}
[0m21:06:12.272541 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m21:06:12.279233 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m21:06:12.328176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59bfe35e-d62b-4fef-88ab-cbf702318186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ade539cd0>]}
[0m21:06:12.329727 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m21:06:12.331020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59bfe35e-d62b-4fef-88ab-cbf702318186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ade9a7fb0>]}
[0m21:06:12.334669 [info ] [MainThread]: 
[0m21:06:12.336389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:06:12.337887 [info ] [MainThread]: 
[0m21:06:12.339356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:06:12.344747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m21:06:12.390580 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m21:06:12.391906 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:06:12.393000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:12.417182 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.024 seconds
[0m21:06:12.420282 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m21:06:12.422902 [debug] [ThreadPool]: On list_de_db_public: Close
[0m21:06:12.436909 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:12.438289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:06:12.439502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:12.465371 [debug] [MainThread]: SQL status: SELECT 0 in 0.026 seconds
[0m21:06:12.467729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59bfe35e-d62b-4fef-88ab-cbf702318186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717adf93b380>]}
[0m21:06:13.868945 [debug] [MainThread]: On master: ROLLBACK
[0m21:06:13.885105 [debug] [MainThread]: On master: COMMIT
[0m21:06:13.886401 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:13.887333 [debug] [MainThread]: On master: COMMIT
[0m21:06:13.891022 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m21:06:13.892065 [debug] [MainThread]: On master: Close
[0m21:06:13.897817 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:06:13.898376 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:06:13.898885 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:06:13.899638 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m21:06:13.900770 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m21:06:13.901600 [info ] [Thread-3 (]: 3 of 3 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m21:06:13.902591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001)
[0m21:06:13.903676 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m21:06:13.904582 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786'
[0m21:06:13.905474 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:06:13.906634 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:06:13.907422 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:06:13.922859 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:06:13.928279 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:06:13.932944 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:06:13.939924 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:06:13.942090 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:06:13.948424 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:06:13.967070 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:06:13.970162 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:06:13.973618 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:06:13.979958 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:06:13.980863 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:06:13.981909 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:06:13.982447 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:06:13.983823 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:06:13.984909 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:06:13.985933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:13.986960 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:06:13.987956 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:06:14.220782 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.235 seconds
[0m21:06:14.233554 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m21:06:14.234171 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.247 seconds
[0m21:06:14.237328 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m21:06:14.237935 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m21:06:14.238566 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.251 seconds
[0m21:06:14.241023 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m21:06:14.240564 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 0.34s]
[0m21:06:14.244388 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m21:06:14.246595 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.34s]
[0m21:06:14.248319 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:06:14.252404 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:06:14.253176 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m21:06:14.257504 [info ] [Thread-3 (]: 3 of 3 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 0.35s]
[0m21:06:14.259993 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:06:14.264074 [debug] [MainThread]: On master: COMMIT
[0m21:06:14.265714 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:14.266792 [debug] [MainThread]: On master: COMMIT
[0m21:06:14.267629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:06:14.306820 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m21:06:14.308729 [debug] [MainThread]: On master: Close
[0m21:06:14.310370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:14.311941 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m21:06:14.313076 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m21:06:14.314323 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m21:06:14.315991 [info ] [MainThread]: 
[0m21:06:14.317345 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m21:06:14.319329 [debug] [MainThread]: Command end result
[0m21:06:14.359656 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m21:06:14.367490 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m21:06:14.382476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m21:06:14.384008 [info ] [MainThread]: 
[0m21:06:14.385340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:06:14.386760 [info ] [MainThread]: 
[0m21:06:14.388326 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:06:14.395993 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.0233402, "process_in_blocks": "0", "process_kernel_time": 0.480167, "process_mem_max_rss": "128720", "process_out_blocks": "0", "process_user_time": 2.604907}
[0m21:06:14.397966 [debug] [MainThread]: Command `dbt test` succeeded at 21:06:14.397758 after 3.03 seconds
[0m21:06:14.399073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ae4bcefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ae4bcef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717ae08ef800>]}
[0m21:06:14.399931 [debug] [MainThread]: Flushing usage events
[0m21:06:14.455440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:31.447105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0b3cfda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0b3e4cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0b46790a0>]}


============================== 21:06:31.459043 | 5f1e91ab-745e-4635-84fd-e008d1c2de18 ==============================
[0m21:06:31.459043 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:06:31.460568 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'empty': 'None', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt_profiles'}
[0m21:06:31.471175 [info ] [MainThread]: dbt version: 1.11.2
[0m21:06:31.472309 [info ] [MainThread]: python version: 3.12.4
[0m21:06:31.473476 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m21:06:31.474625 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m21:06:31.569863 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt_profiles
[0m21:06:31.571549 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt_profiles/profiles.yml
[0m21:06:31.572770 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/my_dbt/dbt_project.yml
[0m21:06:31.574035 [info ] [MainThread]: adapter type: postgres
[0m21:06:31.575164 [info ] [MainThread]: adapter version: 1.10.0
[0m21:06:31.702994 [info ] [MainThread]: Configuration:
[0m21:06:31.704486 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:06:31.705908 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:06:31.707012 [info ] [MainThread]: Required dependencies:
[0m21:06:31.708100 [debug] [MainThread]: Executing "git --help"
[0m21:06:31.709946 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m21:06:31.711257 [info ] [MainThread]: Connection:
[0m21:06:31.712495 [info ] [MainThread]:   host: host.docker.internal
[0m21:06:31.713584 [info ] [MainThread]:   port: 6543
[0m21:06:31.714651 [info ] [MainThread]:   user: de_user
[0m21:06:31.715710 [info ] [MainThread]:   database: de_db
[0m21:06:31.716759 [info ] [MainThread]:   schema: public
[0m21:06:31.717944 [info ] [MainThread]:   connect_timeout: 10
[0m21:06:31.718916 [info ] [MainThread]:   role: None
[0m21:06:31.720127 [info ] [MainThread]:   search_path: None
[0m21:06:31.721239 [info ] [MainThread]:   keepalives_idle: 0
[0m21:06:31.722444 [info ] [MainThread]:   sslmode: None
[0m21:06:31.723659 [info ] [MainThread]:   sslcert: None
[0m21:06:31.724631 [info ] [MainThread]:   sslkey: None
[0m21:06:31.725696 [info ] [MainThread]:   sslrootcert: None
[0m21:06:31.726687 [info ] [MainThread]:   application_name: dbt
[0m21:06:31.727867 [info ] [MainThread]:   retries: 1
[0m21:06:31.729198 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:06:31.813635 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:06:31.864766 [debug] [MainThread]: Using postgres connection "debug"
[0m21:06:31.866000 [debug] [MainThread]: On debug: select 1 as id
[0m21:06:31.866973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:31.890235 [debug] [MainThread]: SQL status: SELECT 1 in 0.023 seconds
[0m21:06:31.893463 [debug] [MainThread]: On debug: Close
[0m21:06:31.894708 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:06:31.897614 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:06:31.899660 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m21:06:31.902149 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.53645784, "process_in_blocks": "0", "process_kernel_time": 0.383351, "process_mem_max_rss": "119264", "process_out_blocks": "0", "process_user_time": 2.61232}
[0m21:06:31.904010 [debug] [MainThread]: Command `dbt debug` failed at 21:06:31.903807 after 0.54 seconds
[0m21:06:31.904980 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:06:31.906036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0b439f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0b2e4ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0b3235220>]}
[0m21:06:31.907204 [debug] [MainThread]: Flushing usage events
[0m21:06:31.959142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:15:46.472491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa7e68ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa81ed1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa7e6a4b0>]}


============================== 21:15:46.479698 | 2c9cc9bc-3f3d-4dec-9faa-de66153a645b ==============================
[0m21:15:46.479698 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:15:46.481209 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'False', 'use_colors': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles --select stg_yellow_tripdata+ fct_yellow_trips_enriched', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles'}
[0m21:15:46.707723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa70a7170>]}
[0m21:15:46.773017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa784ac90>]}
[0m21:15:46.774683 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:15:46.856691 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:15:47.173717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:47.175067 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:15:47.176486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:47.233430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa6a8bc80>]}
[0m21:15:47.349670 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m21:15:47.357831 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m21:15:47.414507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa51501a0>]}
[0m21:15:47.416320 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m21:15:47.418311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa61f1910>]}
[0m21:15:47.422186 [info ] [MainThread]: 
[0m21:15:47.423552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:15:47.425033 [info ] [MainThread]: 
[0m21:15:47.426609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:15:47.431761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m21:15:47.469225 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m21:15:47.470662 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m21:15:47.471789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:47.490348 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m21:15:47.492886 [debug] [ThreadPool]: On list_de_db: Close
[0m21:15:47.496016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_db, now list_de_db_public)
[0m21:15:47.502512 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m21:15:47.503722 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:15:47.504860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:47.525141 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.020 seconds
[0m21:15:47.528501 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m21:15:47.531522 [debug] [ThreadPool]: On list_de_db_public: Close
[0m21:15:47.545283 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:47.546788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:15:47.548287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:47.567601 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m21:15:47.570011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa49f07d0>]}
[0m21:15:47.571315 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:47.573936 [debug] [MainThread]: On master: COMMIT
[0m21:15:47.575130 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:47.576252 [debug] [MainThread]: On master: COMMIT
[0m21:15:47.579785 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m21:15:47.581021 [debug] [MainThread]: On master: Close
[0m21:15:47.586824 [debug] [Thread-1 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m21:15:47.588211 [info ] [Thread-1 (]: 1 of 5 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m21:15:47.589616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now model.my_dbt.stg_yellow_tripdata)
[0m21:15:47.590819 [debug] [Thread-1 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m21:15:47.597883 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m21:15:47.608635 [debug] [Thread-1 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m21:15:47.647360 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m21:15:47.659093 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:15:47.660485 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m21:15:47.661888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:55.192735 [debug] [Thread-1 (]: SQL status: SELECT 3475226 in 7.531 seconds
[0m21:15:55.202703 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:15:55.203995 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m21:15:55.207181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:15:55.210838 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:15:55.211961 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m21:15:55.214885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:15:55.231337 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m21:15:55.232820 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:15:55.234255 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m21:15:55.293533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.058 seconds
[0m21:15:55.301778 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m21:15:55.308973 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m21:15:55.310325 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m21:15:55.392501 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.081 seconds
[0m21:15:55.395880 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m21:15:55.398245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa7fb5a60>]}
[0m21:15:55.401020 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 7.81s]
[0m21:15:55.402529 [debug] [Thread-1 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m21:15:55.404375 [debug] [Thread-3 (]: Began running node model.my_dbt.fct_yellow_trips
[0m21:15:55.405506 [info ] [Thread-3 (]: 2 of 5 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m21:15:55.406592 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips'
[0m21:15:55.407526 [debug] [Thread-3 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m21:15:55.410426 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m21:15:55.419638 [debug] [Thread-3 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m21:15:55.424443 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m21:15:55.435938 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:15:55.437269 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m21:15:55.438397 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:16:18.625486 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 23.098 seconds
[0m21:16:18.635682 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:16:18.642720 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m21:16:18.647538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:16:18.653941 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:16:18.656128 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m21:16:18.662064 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:16:18.665787 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m21:16:18.667358 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:16:18.668172 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m21:16:18.688000 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m21:16:18.695111 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m21:16:18.701365 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m21:16:18.704202 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m21:16:18.992395 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.285 seconds
[0m21:16:19.000095 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: Close
[0m21:16:19.013218 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa3d8a060>]}
[0m21:16:19.025263 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 23.60s]
[0m21:16:19.030967 [debug] [Thread-3 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m21:16:19.036827 [debug] [Thread-2 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m21:16:19.037864 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_daily_revenue
[0m21:16:19.039755 [debug] [Thread-4 (]: Began running node model.my_dbt.mart_payment_type
[0m21:16:19.041511 [info ] [Thread-2 (]: 3 of 5 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m21:16:19.045005 [info ] [Thread-1 (]: 4 of 5 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m21:16:19.048189 [info ] [Thread-4 (]: 5 of 5 START sql table model public.mart_payment_type .......................... [RUN]
[0m21:16:19.050693 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips_enriched'
[0m21:16:19.053578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_daily_revenue)
[0m21:16:19.057324 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.mart_payment_type'
[0m21:16:19.060166 [debug] [Thread-2 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m21:16:19.063102 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m21:16:19.064703 [debug] [Thread-4 (]: Began compiling node model.my_dbt.mart_payment_type
[0m21:16:19.072401 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m21:16:19.078887 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m21:16:19.086030 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m21:16:19.100902 [debug] [Thread-4 (]: Began executing node model.my_dbt.mart_payment_type
[0m21:16:19.114398 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m21:16:19.117405 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m21:16:19.119708 [debug] [Thread-2 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m21:16:19.129098 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m21:16:19.140924 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m21:16:19.144598 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:16:19.146566 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m21:16:19.147561 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:16:19.149668 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:16:19.151534 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:16:19.153727 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m21:16:19.161056 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m21:16:19.163721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:19.166288 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:16:20.144688 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.995 seconds
[0m21:16:20.152135 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:16:20.154155 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m21:16:20.162949 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:16:20.165393 [debug] [Thread-1 (]: SQL status: SELECT 33 in 1.001 seconds
[0m21:16:20.171198 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:16:20.177844 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:16:20.178712 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m21:16:20.180243 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m21:16:20.184238 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:16:20.185023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:16:20.187424 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m21:16:20.192349 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:16:20.194647 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:16:20.195885 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m21:16:20.197107 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m21:16:20.201828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:16:20.205986 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m21:16:20.207614 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:16:20.208906 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m21:16:23.508750 [debug] [Thread-4 (]: SQL status: COMMIT in 3.309 seconds
[0m21:16:23.513003 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m21:16:23.515241 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m21:16:23.517055 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m21:16:23.597313 [debug] [Thread-1 (]: SQL status: COMMIT in 3.388 seconds
[0m21:16:23.600526 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m21:16:23.601965 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m21:16:23.603047 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m21:16:23.668767 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.150 seconds
[0m21:16:23.673115 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: Close
[0m21:16:23.673727 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.069 seconds
[0m21:16:23.675979 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa0b6aff0>]}
[0m21:16:23.678661 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: Close
[0m21:16:23.680429 [info ] [Thread-4 (]: 5 of 5 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 4.62s]
[0m21:16:23.682858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa3d73620>]}
[0m21:16:23.684406 [debug] [Thread-4 (]: Finished running node model.my_dbt.mart_payment_type
[0m21:16:23.686172 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.mart_daily_revenue .................... [[32mSELECT 33[0m in 4.63s]
[0m21:16:23.689076 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m21:17:42.785661 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 83.330 seconds
[0m21:17:42.791028 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:17:42.792479 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched" rename to "fct_yellow_trips_enriched__dbt_backup"
[0m21:17:42.796285 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:17:42.802430 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:17:42.804250 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m21:17:42.808001 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:17:42.811977 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m21:17:42.813681 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:17:42.815361 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m21:17:42.869697 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m21:17:42.874339 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m21:17:42.876692 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m21:17:42.878340 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m21:17:42.992889 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.113 seconds
[0m21:17:42.995296 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m21:17:42.996761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9cc9bc-3f3d-4dec-9faa-de66153a645b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa0b6c5c0>]}
[0m21:17:42.998322 [info ] [Thread-2 (]: 3 of 5 OK created sql table model public.fct_yellow_trips_enriched ............. [[32mSELECT 3475226[0m in 83.95s]
[0m21:17:43.000179 [debug] [Thread-2 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m21:17:43.002806 [debug] [MainThread]: On master: COMMIT
[0m21:17:43.004705 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:43.006167 [debug] [MainThread]: On master: COMMIT
[0m21:17:43.007513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:17:43.025086 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m21:17:43.027110 [debug] [MainThread]: On master: Close
[0m21:17:43.029000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:43.030465 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m21:17:43.032277 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m21:17:43.034084 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m21:17:43.035376 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m21:17:43.036958 [info ] [MainThread]: 
[0m21:17:43.038799 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 55.61 seconds (115.61s).
[0m21:17:43.041334 [debug] [MainThread]: Command end result
[0m21:17:43.087636 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m21:17:43.094640 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m21:17:43.113101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m21:17:43.114874 [info ] [MainThread]: 
[0m21:17:43.116812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:43.118219 [info ] [MainThread]: 
[0m21:17:43.119710 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:17:43.122780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 116.346436, "process_in_blocks": "0", "process_kernel_time": 0.382656, "process_mem_max_rss": "128952", "process_out_blocks": "448", "process_user_time": 3.412018}
[0m21:17:43.124249 [debug] [MainThread]: Command `dbt run` succeeded at 21:17:43.124057 after 116.35 seconds
[0m21:17:43.125718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa76fca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa81ed1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eefa6162750>]}
[0m21:17:43.127458 [debug] [MainThread]: Flushing usage events
[0m21:17:43.270902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:17:50.689889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6db54050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6d669340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6c16b740>]}


============================== 21:17:50.697173 | f1ce9ef7-40e3-4ad4-8a47-bc27c2f1ed97 ==============================
[0m21:17:50.697173 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:17:50.698604 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt_profiles', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles --select stg_yellow_tripdata+ fct_yellow_trips_enriched', 'empty': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'introspect': 'True'}
[0m21:17:50.937536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1ce9ef7-40e3-4ad4-8a47-bc27c2f1ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6b092a20>]}
[0m21:17:51.034299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1ce9ef7-40e3-4ad4-8a47-bc27c2f1ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6b33bbc0>]}
[0m21:17:51.036124 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:17:51.136986 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m21:17:51.428198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:51.429530 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:17:51.430600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:51.482035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1ce9ef7-40e3-4ad4-8a47-bc27c2f1ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6a32fb90>]}
[0m21:17:51.605355 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m21:17:51.612257 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m21:17:51.654432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1ce9ef7-40e3-4ad4-8a47-bc27c2f1ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c69355c10>]}
[0m21:17:51.656034 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m21:17:51.657500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ce9ef7-40e3-4ad4-8a47-bc27c2f1ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c697b3e90>]}
[0m21:17:51.661654 [info ] [MainThread]: 
[0m21:17:51.663023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:51.664673 [info ] [MainThread]: 
[0m21:17:51.666204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:17:51.672171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m21:17:51.705510 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m21:17:51.707096 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:17:51.708601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:51.729411 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.021 seconds
[0m21:17:51.732839 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m21:17:51.736125 [debug] [ThreadPool]: On list_de_db_public: Close
[0m21:17:51.749803 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:51.751323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:17:51.752937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:51.772727 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m21:17:51.775818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ce9ef7-40e3-4ad4-8a47-bc27c2f1ed97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c693a4890>]}
[0m21:17:51.777184 [debug] [MainThread]: On master: ROLLBACK
[0m21:17:51.780351 [debug] [MainThread]: On master: COMMIT
[0m21:17:51.781683 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:51.782868 [debug] [MainThread]: On master: COMMIT
[0m21:17:51.787481 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m21:17:51.788810 [debug] [MainThread]: On master: Close
[0m21:17:51.795497 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:17:51.796250 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:17:51.796775 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:17:51.797899 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m21:17:51.799289 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m21:17:51.800591 [info ] [Thread-3 (]: 3 of 3 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m21:17:51.802106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001)
[0m21:17:51.803680 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m21:17:51.804874 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786'
[0m21:17:51.806126 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:17:51.807601 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:17:51.809389 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:17:51.825570 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:17:51.831138 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:17:51.836036 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:17:51.843365 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:17:51.844375 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:17:51.850956 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:17:51.862741 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:17:51.865333 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:17:51.868665 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:17:51.875773 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m21:17:51.876830 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m21:17:51.877723 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:17:51.878672 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:17:51.879921 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:17:51.881159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:51.882392 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:17:51.883658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:17:51.886210 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:17:54.349121 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.463 seconds
[0m21:17:54.349725 [debug] [Thread-1 (]: SQL status: SELECT 1 in 2.469 seconds
[0m21:17:54.350130 [debug] [Thread-3 (]: SQL status: SELECT 1 in 2.467 seconds
[0m21:17:54.355154 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m21:17:54.358017 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m21:17:54.360655 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m21:17:54.363960 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m21:17:54.364932 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m21:17:54.368353 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 2.56s]
[0m21:17:54.369584 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m21:17:54.371848 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 2.57s]
[0m21:17:54.376506 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:17:54.378962 [info ] [Thread-3 (]: 3 of 3 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 2.57s]
[0m21:17:54.381110 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m21:17:54.384978 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m21:17:54.389858 [debug] [MainThread]: On master: COMMIT
[0m21:17:54.391877 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:54.393561 [debug] [MainThread]: On master: COMMIT
[0m21:17:54.394809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:17:54.411818 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m21:17:54.413819 [debug] [MainThread]: On master: Close
[0m21:17:54.415563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:54.416908 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m21:17:54.418852 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m21:17:54.420417 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m21:17:54.421736 [info ] [MainThread]: 
[0m21:17:54.423118 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m21:17:54.425705 [debug] [MainThread]: Command end result
[0m21:17:54.477734 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m21:17:54.485271 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m21:17:54.498011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m21:17:54.499030 [info ] [MainThread]: 
[0m21:17:54.500712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:54.502289 [info ] [MainThread]: 
[0m21:17:54.503413 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:17:54.504974 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.888416, "process_in_blocks": "0", "process_kernel_time": 0.249358, "process_mem_max_rss": "128612", "process_out_blocks": "0", "process_user_time": 2.988213}
[0m21:17:54.506850 [debug] [MainThread]: Command `dbt test` succeeded at 21:17:54.506469 after 3.89 seconds
[0m21:17:54.508787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6c3d8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6c548770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1c6be32720>]}
[0m21:17:54.510023 [debug] [MainThread]: Flushing usage events
[0m21:17:54.563556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:05.614864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93eb8eb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93ed9934a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93eb8eab40>]}


============================== 00:00:05.627786 | 8a675b44-f047-424f-b5c5-d8debc7f7750 ==============================
[0m00:00:05.627786 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:00:05.631208 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profiles --select stg_yellow_tripdata+ fct_yellow_trips_enriched', 'debug': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'profiles_dir': '/opt/airflow/dbt_profiles', 'no_print': 'None', 'empty': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m00:00:05.973267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93eaa43a40>]}
[0m00:00:06.066933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93ec035040>]}
[0m00:00:06.069555 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:00:06.192000 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:00:06.488274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:06.489726 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:00:06.490804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:06.551246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e8f0fcb0>]}
[0m00:00:06.676333 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m00:00:06.684827 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m00:00:06.727288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e8f64e30>]}
[0m00:00:06.729550 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m00:00:06.732711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e9fc7e90>]}
[0m00:00:06.736792 [info ] [MainThread]: 
[0m00:00:06.739967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:06.743007 [info ] [MainThread]: 
[0m00:00:06.745308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:06.752110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m00:00:06.840382 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m00:00:06.841708 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:06.842707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:06.863116 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m00:00:06.866102 [debug] [ThreadPool]: On list_de_db: Close
[0m00:00:06.870200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_db, now list_de_db_public)
[0m00:00:06.878799 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m00:00:06.880114 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:00:06.881137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:06.905876 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.025 seconds
[0m00:00:06.909788 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m00:00:06.912454 [debug] [ThreadPool]: On list_de_db_public: Close
[0m00:00:06.926949 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.928623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:00:06.930387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:06.957399 [debug] [MainThread]: SQL status: SELECT 0 in 0.027 seconds
[0m00:00:06.960478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93eb6d5940>]}
[0m00:00:06.963092 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:06.966490 [debug] [MainThread]: On master: COMMIT
[0m00:00:06.968283 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:06.969325 [debug] [MainThread]: On master: COMMIT
[0m00:00:06.974535 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m00:00:06.975922 [debug] [MainThread]: On master: Close
[0m00:00:06.985281 [debug] [Thread-1 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m00:00:06.987489 [info ] [Thread-1 (]: 1 of 5 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m00:00:06.989403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now model.my_dbt.stg_yellow_tripdata)
[0m00:00:06.991038 [debug] [Thread-1 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m00:00:07.000957 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m00:00:07.009268 [debug] [Thread-1 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m00:00:07.082511 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m00:00:07.090937 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:00:07.092233 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m00:00:07.093470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:24.985882 [debug] [Thread-1 (]: SQL status: SELECT 3475226 in 17.753 seconds
[0m00:00:25.000128 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:00:25.002842 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m00:00:25.007269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:00:25.012542 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:00:25.014534 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m00:00:25.019720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:00:25.042503 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m00:00:25.044550 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:00:25.046079 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m00:00:25.225840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.178 seconds
[0m00:00:25.236931 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m00:00:25.247850 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m00:00:25.250170 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m00:00:25.506385 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.254 seconds
[0m00:00:25.510821 [debug] [Thread-1 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m00:00:25.515882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93ed675ac0>]}
[0m00:00:25.518246 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 18.52s]
[0m00:00:25.520389 [debug] [Thread-1 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m00:00:25.523719 [debug] [Thread-3 (]: Began running node model.my_dbt.fct_yellow_trips
[0m00:00:25.525362 [info ] [Thread-3 (]: 2 of 5 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m00:00:25.527085 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips'
[0m00:00:25.528172 [debug] [Thread-3 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m00:00:25.534278 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m00:00:25.546930 [debug] [Thread-3 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m00:00:25.563098 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m00:00:25.575392 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:25.577347 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m00:00:25.578913 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:00:53.896589 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 28.175 seconds
[0m00:00:53.902152 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:53.903560 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m00:00:53.908073 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:00:53.914281 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:53.915751 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m00:00:53.919754 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:53.922538 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m00:00:53.923975 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:53.925504 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m00:00:53.983113 [debug] [Thread-3 (]: SQL status: COMMIT in 0.056 seconds
[0m00:00:53.987327 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m00:00:53.990707 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m00:00:53.992184 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m00:00:54.263456 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.269 seconds
[0m00:00:54.268201 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips: Close
[0m00:00:54.271393 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e7d05640>]}
[0m00:00:54.274188 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 28.74s]
[0m00:00:54.283269 [debug] [Thread-3 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m00:00:54.286662 [debug] [Thread-2 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m00:00:54.287551 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_daily_revenue
[0m00:00:54.288168 [debug] [Thread-4 (]: Began running node model.my_dbt.mart_payment_type
[0m00:00:54.289976 [info ] [Thread-2 (]: 3 of 5 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m00:00:54.301036 [info ] [Thread-1 (]: 4 of 5 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m00:00:54.304919 [info ] [Thread-4 (]: 5 of 5 START sql table model public.mart_payment_type .......................... [RUN]
[0m00:00:54.307463 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.fct_yellow_trips_enriched'
[0m00:00:54.310274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_daily_revenue)
[0m00:00:54.315828 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.mart_payment_type'
[0m00:00:54.319240 [debug] [Thread-2 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m00:00:54.321232 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m00:00:54.322965 [debug] [Thread-4 (]: Began compiling node model.my_dbt.mart_payment_type
[0m00:00:54.331314 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m00:00:54.336884 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m00:00:54.344494 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m00:00:54.351103 [debug] [Thread-2 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m00:00:54.352352 [debug] [Thread-4 (]: Began executing node model.my_dbt.mart_payment_type
[0m00:00:54.364332 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m00:00:54.368411 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m00:00:54.376156 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m00:00:54.382997 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m00:00:54.390840 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m00:00:54.393094 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:54.394968 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m00:00:54.398608 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m00:00:54.399629 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:54.402157 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:00:54.404487 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:00:54.408130 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m00:00:54.414120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:55.867168 [debug] [Thread-1 (]: SQL status: SELECT 33 in 1.453 seconds
[0m00:00:55.867997 [debug] [Thread-4 (]: SQL status: SELECT 6 in 1.464 seconds
[0m00:00:55.877697 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:55.886083 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:55.887495 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m00:00:55.889630 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m00:00:55.936952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m00:00:55.937771 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m00:00:55.944538 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:55.956134 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:55.958360 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m00:00:55.961123 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m00:00:55.978327 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m00:00:55.979176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m00:00:55.991263 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m00:00:56.001159 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m00:00:56.003727 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:56.006070 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:56.007849 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m00:00:56.009846 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m00:00:56.059105 [debug] [Thread-4 (]: SQL status: COMMIT in 0.044 seconds
[0m00:00:56.064326 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m00:00:56.064949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m00:00:56.066552 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m00:00:56.071907 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m00:00:56.073778 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m00:00:56.075848 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m00:00:56.078184 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m00:00:56.106507 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.029 seconds
[0m00:00:56.110375 [debug] [Thread-4 (]: On model.my_dbt.mart_payment_type: Close
[0m00:00:56.112740 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e7ecbaa0>]}
[0m00:00:56.114797 [info ] [Thread-4 (]: 5 of 5 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 1.80s]
[0m00:00:56.117038 [debug] [Thread-4 (]: Finished running node model.my_dbt.mart_payment_type
[0m00:00:56.124138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.044 seconds
[0m00:00:56.127626 [debug] [Thread-1 (]: On model.my_dbt.mart_daily_revenue: Close
[0m00:00:56.130548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e7ea8650>]}
[0m00:00:56.134525 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.mart_daily_revenue .................... [[32mSELECT 33[0m in 1.82s]
[0m00:00:56.136874 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m00:01:56.797552 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 62.112 seconds
[0m00:01:56.804387 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m00:01:56.806054 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched" rename to "fct_yellow_trips_enriched__dbt_backup"
[0m00:01:56.810411 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:01:56.819645 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m00:01:56.821205 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m00:01:56.825436 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:01:56.828887 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m00:01:56.830685 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m00:01:56.831862 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m00:01:56.850202 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m00:01:56.854482 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m00:01:56.856858 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m00:01:56.858636 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m00:01:57.249955 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.390 seconds
[0m00:01:57.254978 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m00:01:57.260960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a675b44-f047-424f-b5c5-d8debc7f7750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e9f36060>]}
[0m00:01:57.269556 [info ] [Thread-2 (]: 3 of 5 OK created sql table model public.fct_yellow_trips_enriched ............. [[32mSELECT 3475226[0m in 62.95s]
[0m00:01:57.277934 [debug] [Thread-2 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m00:01:57.289800 [debug] [MainThread]: On master: COMMIT
[0m00:01:57.295653 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:57.298831 [debug] [MainThread]: On master: COMMIT
[0m00:01:57.302441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:01:57.334287 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m00:01:57.335809 [debug] [MainThread]: On master: Close
[0m00:01:57.337650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:57.340587 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m00:01:57.342764 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m00:01:57.344354 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m00:01:57.345650 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m00:01:57.347092 [info ] [MainThread]: 
[0m00:01:57.348908 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 50.60 seconds (110.60s).
[0m00:01:57.352829 [debug] [MainThread]: Command end result
[0m00:01:57.393100 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m00:01:57.401750 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m00:01:57.423844 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m00:01:57.426054 [info ] [MainThread]: 
[0m00:01:57.428131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:57.430816 [info ] [MainThread]: 
[0m00:01:57.433146 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:01:57.437771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 111.34763, "process_in_blocks": "0", "process_kernel_time": 1.047678, "process_mem_max_rss": "128116", "process_out_blocks": "0", "process_user_time": 4.178485}
[0m00:01:57.439657 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:57.439430 after 111.35 seconds
[0m00:01:57.440770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93ebda80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93e7f9a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c93ec036570>]}
[0m00:01:57.442104 [debug] [MainThread]: Flushing usage events
[0m00:01:57.554043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:02:03.578193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d97bac680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d985e2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d985e0c20>]}


============================== 00:02:03.596028 | f8ecf115-2e9c-488b-855d-b8400ff47ceb ==============================
[0m00:02:03.596028 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:02:03.597583 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/opt/airflow/dbt/my_dbt/logs', 'use_experimental_parser': 'False', 'empty': 'None', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profiles --select stg_yellow_tripdata+ fct_yellow_trips_enriched', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt_profiles', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:02:03.931832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8ecf115-2e9c-488b-855d-b8400ff47ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d9798e240>]}
[0m00:02:04.044187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8ecf115-2e9c-488b-855d-b8400ff47ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d9787fe90>]}
[0m00:02:04.046294 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:02:04.175811 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:02:04.569426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:02:04.572025 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:02:04.573763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:02:04.651134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8ecf115-2e9c-488b-855d-b8400ff47ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d96951d30>]}
[0m00:02:04.791017 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m00:02:04.799516 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m00:02:04.904514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8ecf115-2e9c-488b-855d-b8400ff47ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d9596f380>]}
[0m00:02:04.907050 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m00:02:04.910998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ecf115-2e9c-488b-855d-b8400ff47ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d96951d90>]}
[0m00:02:04.917175 [info ] [MainThread]: 
[0m00:02:04.919587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:02:04.921786 [info ] [MainThread]: 
[0m00:02:04.924094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:02:04.934982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m00:02:05.012552 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m00:02:05.014738 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:02:05.016826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:05.046463 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.030 seconds
[0m00:02:05.049911 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m00:02:05.053989 [debug] [ThreadPool]: On list_de_db_public: Close
[0m00:02:05.075618 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:05.077749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:02:05.079152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:02:05.104041 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m00:02:05.108145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ecf115-2e9c-488b-855d-b8400ff47ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d9a015520>]}
[0m00:02:05.109802 [debug] [MainThread]: On master: ROLLBACK
[0m00:02:05.112909 [debug] [MainThread]: On master: COMMIT
[0m00:02:05.115424 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:05.117785 [debug] [MainThread]: On master: COMMIT
[0m00:02:05.122426 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m00:02:05.123884 [debug] [MainThread]: On master: Close
[0m00:02:05.133108 [debug] [Thread-1 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m00:02:05.133886 [debug] [Thread-2 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m00:02:05.134698 [debug] [Thread-3 (]: Began running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m00:02:05.136891 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_yellow_tripdata_dropoff_datetime ................ [RUN]
[0m00:02:05.139028 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_yellow_tripdata_pickup_datetime ................. [RUN]
[0m00:02:05.140539 [info ] [Thread-3 (]: 3 of 3 START test not_null_stg_yellow_tripdata_total_amount .................... [RUN]
[0m00:02:05.141801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_public, now test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001)
[0m00:02:05.143282 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m00:02:05.144715 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786'
[0m00:02:05.147561 [debug] [Thread-1 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m00:02:05.149321 [debug] [Thread-2 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m00:02:05.150994 [debug] [Thread-3 (]: Began compiling node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m00:02:05.175899 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m00:02:05.186966 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m00:02:05.194599 [debug] [Thread-3 (]: Writing injected SQL for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m00:02:05.203979 [debug] [Thread-3 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m00:02:05.204973 [debug] [Thread-1 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m00:02:05.205997 [debug] [Thread-2 (]: Began executing node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m00:02:05.237284 [debug] [Thread-3 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m00:02:05.238283 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m00:02:05.242009 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m00:02:05.249522 [debug] [Thread-2 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m00:02:05.250577 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"
[0m00:02:05.252526 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "de_db"."public"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m00:02:05.253715 [debug] [Thread-3 (]: Using postgres connection "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"
[0m00:02:05.255357 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dropoff_datetime
from "de_db"."public"."stg_yellow_tripdata"
where dropoff_datetime is null



  
  
      
    ) dbt_internal_test
[0m00:02:05.257401 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:02:05.260109 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "de_db"."public"."stg_yellow_tripdata"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m00:02:05.261846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:05.266243 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:02:05.642154 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.385 seconds
[0m00:02:05.659411 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m00:02:05.666761 [debug] [Thread-2 (]: On test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m00:02:05.671068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.409 seconds
[0m00:02:05.681175 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_yellow_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.54s]
[0m00:02:05.692596 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: ROLLBACK
[0m00:02:05.699981 [debug] [Thread-2 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m00:02:05.704828 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.438 seconds
[0m00:02:05.705516 [debug] [Thread-1 (]: On test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001: Close
[0m00:02:05.709491 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: ROLLBACK
[0m00:02:05.712713 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_yellow_tripdata_dropoff_datetime ...................... [[32mPASS[0m in 0.57s]
[0m00:02:05.716223 [debug] [Thread-1 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001
[0m00:02:05.717042 [debug] [Thread-3 (]: On test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786: Close
[0m00:02:05.719670 [info ] [Thread-3 (]: 3 of 3 PASS not_null_stg_yellow_tripdata_total_amount .......................... [[32mPASS[0m in 0.57s]
[0m00:02:05.723753 [debug] [Thread-3 (]: Finished running node test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786
[0m00:02:05.727555 [debug] [MainThread]: On master: COMMIT
[0m00:02:05.729386 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:05.730829 [debug] [MainThread]: On master: COMMIT
[0m00:02:05.734359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:02:05.754679 [debug] [MainThread]: SQL status: COMMIT in 0.021 seconds
[0m00:02:05.756624 [debug] [MainThread]: On master: Close
[0m00:02:05.760015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:05.763197 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_dropoff_datetime.94a60d2001' was properly closed.
[0m00:02:05.764654 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' was properly closed.
[0m00:02:05.765903 [debug] [MainThread]: Connection 'test.my_dbt.not_null_stg_yellow_tripdata_total_amount.b93808c786' was properly closed.
[0m00:02:05.767246 [info ] [MainThread]: 
[0m00:02:05.768796 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m00:02:05.773171 [debug] [MainThread]: Command end result
[0m00:02:05.821984 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/my_dbt/target/manifest.json
[0m00:02:05.829142 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/my_dbt/target/semantic_manifest.json
[0m00:02:05.845314 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/my_dbt/target/run_results.json
[0m00:02:05.846997 [info ] [MainThread]: 
[0m00:02:05.850139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:02:05.852407 [info ] [MainThread]: 
[0m00:02:05.854023 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m00:02:05.857294 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.3926947, "process_in_blocks": "0", "process_kernel_time": 0.953489, "process_mem_max_rss": "128848", "process_out_blocks": "0", "process_user_time": 4.280557}
[0m00:02:05.860602 [debug] [MainThread]: Command `dbt test` succeeded at 00:02:05.859655 after 2.40 seconds
[0m00:02:05.864509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d98e99af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d97ba67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7d9872ed50>]}
[0m00:02:05.866412 [debug] [MainThread]: Flushing usage events
[0m00:02:05.925138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:46:20.072588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E2C6A3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E2C92910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E2C92750>]}


============================== 08:46:20.088375 | 1ba0e198-8597-4f25-8153-c6dbdd51f3b6 ==============================
[0m08:46:20.088375 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:46:20.091375 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m08:46:21.069845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E2C68290>]}
[0m08:46:21.335554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DF4C8290>]}
[0m08:46:21.340551 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m08:46:22.542113 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:46:22.689022 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:46:22.690022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E1CBCC50>]}
[0m08:46:26.498686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E42D8DD0>]}
[0m08:46:26.625028 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m08:46:26.685547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m08:46:26.796768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E4727210>]}
[0m08:46:26.797766 [info ] [MainThread]: Found 8 models, 5 data tests, 2 sources, 464 macros
[0m08:46:26.800770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E43E3A90>]}
[0m08:46:26.804768 [info ] [MainThread]: 
[0m08:46:26.806768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:46:26.807769 [info ] [MainThread]: 
[0m08:46:26.808765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:46:26.818768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m08:46:30.398911 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m08:46:30.399912 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m08:46:30.399912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:30.487648 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.087 seconds
[0m08:46:30.490633 [debug] [ThreadPool]: On list_de_db: Close
[0m08:46:30.495663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m08:46:30.505234 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m08:46:30.506234 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:46:30.508232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:30.530716 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.023 seconds
[0m08:46:30.534512 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m08:46:30.536799 [debug] [ThreadPool]: On list_de_db_public: Close
[0m08:46:30.556946 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:30.557944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m08:46:30.558944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:46:30.579968 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m08:46:30.580967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E46F8A10>]}
[0m08:46:30.582972 [debug] [MainThread]: On master: ROLLBACK
[0m08:46:30.584968 [debug] [MainThread]: On master: COMMIT
[0m08:46:30.585966 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:30.585966 [debug] [MainThread]: On master: COMMIT
[0m08:46:30.588969 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m08:46:30.589972 [debug] [MainThread]: On master: Close
[0m08:46:30.597927 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m08:46:30.597927 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_taxi_zones
[0m08:46:30.598924 [debug] [Thread-3 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m08:46:30.598924 [info ] [Thread-1 (]: 1 of 8 START sql table model public.hello ...................................... [RUN]
[0m08:46:30.599925 [info ] [Thread-2 (]: 2 of 8 START sql table model public.stg_taxi_zones ............................. [RUN]
[0m08:46:30.601929 [info ] [Thread-3 (]: 3 of 8 START sql table model public.stg_yellow_tripdata ........................ [RUN]
[0m08:46:30.603327 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m08:46:30.603855 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_taxi_zones'
[0m08:46:30.605428 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m08:46:30.606473 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m08:46:30.606994 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_taxi_zones
[0m08:46:30.607514 [debug] [Thread-3 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m08:46:30.613773 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m08:46:30.618773 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_taxi_zones"
[0m08:46:30.623778 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m08:46:30.625772 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m08:46:30.669905 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m08:46:30.671906 [debug] [Thread-3 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m08:46:30.672909 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_taxi_zones
[0m08:46:30.679740 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m08:46:30.680741 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m08:46:30.690742 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_taxi_zones"
[0m08:46:30.691740 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m08:46:30.692739 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m08:46:30.694021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:46:30.694541 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m08:46:30.695538 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m08:46:30.697541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:46:30.698487 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */

  
    

  create  table "de_db"."public"."stg_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select *
    from "de_db"."public"."taxi_zones_raw"
),

renamed as (
    select
        "LocationID"::int as location_id,
        "Borough"::text   as borough,
        "Zone"::text      as zone,
        "service_zone"::text as service_zone
    from source
)

select * from renamed
  );
  
[0m08:46:30.700289 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:46:30.744716 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.050 seconds
[0m08:46:30.897669 [debug] [Thread-2 (]: SQL status: SELECT 265 in 0.198 seconds
[0m08:46:30.904671 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m08:46:30.910676 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m08:46:30.911876 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m08:46:30.912404 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m08:46:30.916770 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:46:30.917771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:46:30.923771 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m08:46:30.929773 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m08:46:30.930775 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m08:46:30.932770 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m08:46:30.936781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:46:30.937828 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:46:30.959759 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m08:46:30.961714 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m08:46:30.962713 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m08:46:30.963712 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m08:46:30.963712 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m08:46:30.964712 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m08:46:31.011841 [debug] [Thread-2 (]: SQL status: COMMIT in 0.046 seconds
[0m08:46:31.011841 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m08:46:31.020811 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_taxi_zones__dbt_backup"
[0m08:46:31.025803 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m08:46:31.033805 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m08:46:31.034806 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m08:46:31.036416 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
drop table if exists "de_db"."public"."stg_taxi_zones__dbt_backup" cascade
[0m08:46:31.036416 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m08:46:31.067903 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m08:46:31.071906 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m08:46:31.072904 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.035 seconds
[0m08:46:31.077906 [debug] [Thread-2 (]: On model.my_dbt.stg_taxi_zones: Close
[0m08:46:31.079904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E46CFE10>]}
[0m08:46:31.080907 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E43B5390>]}
[0m08:46:31.081903 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.hello ................................. [[32mSELECT 1[0m in 0.47s]
[0m08:46:31.085021 [info ] [Thread-2 (]: 2 of 8 OK created sql table model public.stg_taxi_zones ........................ [[32mSELECT 265[0m in 0.48s]
[0m08:46:31.087146 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m08:46:31.088786 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_taxi_zones
[0m08:46:31.090363 [debug] [Thread-4 (]: Began running node model.my_dbt.dim_taxi_zones
[0m08:46:31.090885 [info ] [Thread-4 (]: 4 of 8 START sql table model public.dim_taxi_zones ............................. [RUN]
[0m08:46:31.091925 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.dim_taxi_zones'
[0m08:46:31.092444 [debug] [Thread-4 (]: Began compiling node model.my_dbt.dim_taxi_zones
[0m08:46:31.097430 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.dim_taxi_zones"
[0m08:46:31.101759 [debug] [Thread-4 (]: Began executing node model.my_dbt.dim_taxi_zones
[0m08:46:31.109386 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.dim_taxi_zones"
[0m08:46:31.111413 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m08:46:31.112417 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */

  
    

  create  table "de_db"."public"."dim_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with zones as (
    select *
    from "de_db"."public"."stg_taxi_zones"
)

select
    location_id,
    borough,
    zone,
    service_zone
from zones
  );
  
[0m08:46:31.112417 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:46:31.152199 [debug] [Thread-4 (]: SQL status: SELECT 265 in 0.039 seconds
[0m08:46:31.158203 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m08:46:31.159199 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones" rename to "dim_taxi_zones__dbt_backup"
[0m08:46:31.162200 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:46:31.169715 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m08:46:31.170711 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones__dbt_tmp" rename to "dim_taxi_zones"
[0m08:46:31.174691 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:46:31.177691 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m08:46:31.178693 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m08:46:31.179695 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m08:46:31.224034 [debug] [Thread-4 (]: SQL status: COMMIT in 0.043 seconds
[0m08:46:31.228797 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."dim_taxi_zones__dbt_backup"
[0m08:46:31.230370 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m08:46:31.230886 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
drop table if exists "de_db"."public"."dim_taxi_zones__dbt_backup" cascade
[0m08:46:31.245468 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.014 seconds
[0m08:46:31.247905 [debug] [Thread-4 (]: On model.my_dbt.dim_taxi_zones: Close
[0m08:46:31.250184 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E416EED0>]}
[0m08:46:31.252447 [info ] [Thread-4 (]: 4 of 8 OK created sql table model public.dim_taxi_zones ........................ [[32mSELECT 265[0m in 0.16s]
[0m08:46:31.254143 [debug] [Thread-4 (]: Finished running node model.my_dbt.dim_taxi_zones
[0m08:46:39.908781 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 9.212 seconds
[0m08:46:39.913780 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m08:46:39.914780 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m08:46:39.917780 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:46:39.920779 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m08:46:39.921780 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m08:46:39.923781 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:46:39.925780 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m08:46:39.926782 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m08:46:39.927786 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m08:46:39.987319 [debug] [Thread-3 (]: SQL status: COMMIT in 0.058 seconds
[0m08:46:39.992044 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m08:46:39.993079 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m08:46:39.993592 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m08:46:40.001999 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m08:46:40.003718 [debug] [Thread-3 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m08:46:40.005741 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E40E0690>]}
[0m08:46:40.007513 [info ] [Thread-3 (]: 3 of 8 OK created sql table model public.stg_yellow_tripdata ................... [[32mSELECT 3475226[0m in 9.40s]
[0m08:46:40.009103 [debug] [Thread-3 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m08:46:40.010699 [debug] [Thread-2 (]: Began running node model.my_dbt.fct_yellow_trips
[0m08:46:40.011743 [info ] [Thread-2 (]: 5 of 8 START sql table model public.fct_yellow_trips ........................... [RUN]
[0m08:46:40.012833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_taxi_zones, now model.my_dbt.fct_yellow_trips)
[0m08:46:40.013399 [debug] [Thread-2 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m08:46:40.016985 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m08:46:40.024984 [debug] [Thread-2 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m08:46:40.030509 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m08:46:40.032513 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m08:46:40.033511 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m08:46:40.035306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:47:02.315885 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 22.280 seconds
[0m08:47:02.322039 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m08:47:02.323129 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m08:47:02.325937 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:47:02.331260 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m08:47:02.331859 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m08:47:02.334863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:47:02.336494 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m08:47:02.337494 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m08:47:02.338495 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m08:47:02.461357 [debug] [Thread-2 (]: SQL status: COMMIT in 0.121 seconds
[0m08:47:02.464685 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m08:47:02.465804 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m08:47:02.467324 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m08:47:02.693285 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.225 seconds
[0m08:47:02.696283 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: Close
[0m08:47:02.698424 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E43E1790>]}
[0m08:47:02.700033 [info ] [Thread-2 (]: 5 of 8 OK created sql table model public.fct_yellow_trips ...................... [[32mSELECT 3475226[0m in 22.68s]
[0m08:47:02.701661 [debug] [Thread-2 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m08:47:02.702770 [debug] [Thread-4 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m08:47:02.703868 [debug] [Thread-3 (]: Began running node model.my_dbt.mart_daily_revenue
[0m08:47:02.703868 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_payment_type
[0m08:47:02.705884 [info ] [Thread-4 (]: 6 of 8 START sql table model public.fct_yellow_trips_enriched .................. [RUN]
[0m08:47:02.706870 [info ] [Thread-3 (]: 7 of 8 START sql table model public.mart_daily_revenue ......................... [RUN]
[0m08:47:02.707868 [info ] [Thread-1 (]: 8 of 8 START sql table model public.mart_payment_type .......................... [RUN]
[0m08:47:02.708866 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt.dim_taxi_zones, now model.my_dbt.fct_yellow_trips_enriched)
[0m08:47:02.708866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_daily_revenue)
[0m08:47:02.709868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.hello, now model.my_dbt.mart_payment_type)
[0m08:47:02.710868 [debug] [Thread-4 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m08:47:02.711871 [debug] [Thread-3 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m08:47:02.712867 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_payment_type
[0m08:47:02.718867 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m08:47:02.722870 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m08:47:02.726868 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m08:47:02.776026 [debug] [Thread-4 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m08:47:02.782023 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m08:47:02.844663 [debug] [Thread-3 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m08:47:02.845662 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m08:47:02.845662 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_payment_type
[0m08:47:02.852492 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m08:47:02.853488 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m08:47:02.861489 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m08:47:02.862489 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:47:02.929143 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m08:47:02.930140 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m08:47:02.930140 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m08:47:02.931145 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m08:47:02.931145 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:47:02.933149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:04.104564 [debug] [Thread-1 (]: SQL status: SELECT 6 in 1.171 seconds
[0m08:47:04.111052 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m08:47:04.112602 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m08:47:04.115113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:47:04.120115 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m08:47:04.120115 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m08:47:04.123654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:47:04.126363 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m08:47:04.127578 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m08:47:04.128176 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m08:47:04.153489 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m08:47:04.158383 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m08:47:04.160425 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m08:47:04.162422 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m08:47:04.169060 [debug] [Thread-3 (]: SQL status: SELECT 33 in 1.237 seconds
[0m08:47:04.175195 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m08:47:04.176226 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m08:47:04.178947 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:47:04.186389 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m08:47:04.186903 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.023 seconds
[0m08:47:04.187953 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m08:47:04.190208 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: Close
[0m08:47:04.192485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E3D58C50>]}
[0m08:47:04.195743 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:47:04.194747 [info ] [Thread-1 (]: 8 of 8 OK created sql table model public.mart_payment_type ..................... [[32mSELECT 6[0m in 1.48s]
[0m08:47:04.198744 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m08:47:04.200507 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_payment_type
[0m08:47:04.201698 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m08:47:04.202695 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m08:47:04.245927 [debug] [Thread-3 (]: SQL status: COMMIT in 0.043 seconds
[0m08:47:04.250085 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m08:47:04.251102 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m08:47:04.252093 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m08:47:04.307669 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.055 seconds
[0m08:47:04.309955 [debug] [Thread-3 (]: On model.my_dbt.mart_daily_revenue: Close
[0m08:47:04.311554 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E4375C90>]}
[0m08:47:04.313168 [info ] [Thread-3 (]: 7 of 8 OK created sql table model public.mart_daily_revenue .................... [[32mSELECT 33[0m in 1.60s]
[0m08:47:04.314872 [debug] [Thread-3 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m08:47:56.189007 [debug] [Thread-4 (]: SQL status: SELECT 3475226 in 53.326 seconds
[0m08:47:56.196456 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m08:47:56.197457 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched" rename to "fct_yellow_trips_enriched__dbt_backup"
[0m08:47:56.201456 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:47:56.206455 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m08:47:56.207456 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m08:47:56.210457 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:47:56.213459 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m08:47:56.214455 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m08:47:56.215457 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m08:47:56.286304 [debug] [Thread-4 (]: SQL status: COMMIT in 0.070 seconds
[0m08:47:56.291107 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m08:47:56.292138 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m08:47:56.293216 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m08:47:56.385399 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.092 seconds
[0m08:47:56.387399 [debug] [Thread-4 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m08:47:56.389406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba0e198-8597-4f25-8153-c6dbdd51f3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E4489850>]}
[0m08:47:56.391399 [info ] [Thread-4 (]: 6 of 8 OK created sql table model public.fct_yellow_trips_enriched ............. [[32mSELECT 3475226[0m in 53.68s]
[0m08:47:56.392398 [debug] [Thread-4 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m08:47:56.395402 [debug] [MainThread]: On master: COMMIT
[0m08:47:56.396402 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:56.397399 [debug] [MainThread]: On master: COMMIT
[0m08:47:56.397399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:47:56.418730 [debug] [MainThread]: SQL status: COMMIT in 0.021 seconds
[0m08:47:56.419729 [debug] [MainThread]: On master: Close
[0m08:47:56.419729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:56.421731 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m08:47:56.422732 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m08:47:56.422732 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m08:47:56.423730 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m08:47:56.424595 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m08:47:56.425116 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m08:47:56.426113 [info ] [MainThread]: 
[0m08:47:56.428117 [info ] [MainThread]: Finished running 8 table models in 0 hours 1 minutes and 29.62 seconds (89.62s).
[0m08:47:56.431111 [debug] [MainThread]: Command end result
[0m08:47:56.462132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m08:47:56.465128 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m08:47:56.473834 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m08:47:56.474832 [info ] [MainThread]: 
[0m08:47:56.475834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:47:56.477836 [info ] [MainThread]: 
[0m08:47:56.478837 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m08:47:56.480833 [debug] [MainThread]: Command `dbt run` succeeded at 08:47:56.480833 after 96.79 seconds
[0m08:47:56.481833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DBE18C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285E1DEA8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DC1208D0>]}
[0m08:47:56.482836 [debug] [MainThread]: Flushing usage events
[0m08:47:57.039575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:10.289300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265D9412810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265D9419ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265D943A790>]}


============================== 09:52:10.292892 | dfec45a0-009c-4842-8765-cdec4fec4969 ==============================
[0m09:52:10.292892 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:52:10.293863 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_green_test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m09:52:10.482505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfec45a0-009c-4842-8765-cdec4fec4969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265D9418250>]}
[0m09:52:10.571898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfec45a0-009c-4842-8765-cdec4fec4969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265D5C68410>]}
[0m09:52:10.573442 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:52:10.803373 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:52:10.943449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m09:52:10.945226 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\stg_green_test.sql
[0m09:52:10.945226 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\dim_green_test.sql
[0m09:52:11.135555 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt.stg_green_test' (models\staging\stg_green_test.sql) depends on a source named 'raw.green_tripdata_test' which was not found
[0m09:52:11.136856 [debug] [MainThread]: Command `dbt run` failed at 09:52:11.136318 after 0.93 seconds
[0m09:52:11.137374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265D946B990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265D8547D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265D911B190>]}
[0m09:52:11.137914 [debug] [MainThread]: Flushing usage events
[0m09:52:11.524509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:01.167613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520F5FAD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520F5A27D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520F5A3250>]}


============================== 09:53:01.171563 | b7213c4a-47a7-46a8-be9b-a5b7b656de18 ==============================
[0m09:53:01.171563 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:53:01.172131 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_green_test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m09:53:01.346649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7213c4a-47a7-46a8-be9b-a5b7b656de18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520F6DCD90>]}
[0m09:53:01.402266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7213c4a-47a7-46a8-be9b-a5b7b656de18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520BE082D0>]}
[0m09:53:01.403266 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:53:01.630530 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:53:01.746772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m09:53:01.747771 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\dim_green_test.sql
[0m09:53:01.747771 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\stg_green_test.sql
[0m09:53:01.917008 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt.stg_green_test' (models\staging\stg_green_test.sql) depends on a source named 'raw.green_tripdata_test' which was not found
[0m09:53:01.919003 [debug] [MainThread]: Command `dbt run` failed at 09:53:01.918003 after 0.82 seconds
[0m09:53:01.919003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520F604550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520F605D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520F5B3090>]}
[0m09:53:01.919003 [debug] [MainThread]: Flushing usage events
[0m09:53:02.205241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:34.364596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257632EA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002576333ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257632EA210>]}


============================== 09:54:34.368161 | 39dbebfd-b840-470a-b34f-74b46905f042 ==============================
[0m09:54:34.368161 [info ] [MainThread]: Running with dbt=1.11.2
[0m09:54:34.368161 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_green_test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m09:54:34.537718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39dbebfd-b840-470a-b34f-74b46905f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025764501590>]}
[0m09:54:34.593348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39dbebfd-b840-470a-b34f-74b46905f042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002575FB38510>]}
[0m09:54:34.594323 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m09:54:34.817687 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m09:54:34.941379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m09:54:34.942443 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\stg_green_test.sql
[0m09:54:34.942443 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\dim_green_test.sql
[0m09:54:35.108053 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt.stg_green_test' (models\staging\stg_green_test.sql) depends on a source named 'raw.green_tripdata_test' which was not found
[0m09:54:35.109049 [debug] [MainThread]: Command `dbt run` failed at 09:54:35.109049 after 0.81 seconds
[0m09:54:35.110022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002575C4B8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002576333AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002576479FF50>]}
[0m09:54:35.110593 [debug] [MainThread]: Flushing usage events
[0m09:54:35.453253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:26.490931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E66DA150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E66D2AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E66D3B90>]}


============================== 10:26:26.495044 | 4b6ef25e-d25a-45d2-98e3-e3d147557357 ==============================
[0m10:26:26.495044 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:26:26.495044 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run --select stg_green_test', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m10:26:26.666685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6ef25e-d25a-45d2-98e3-e3d147557357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E6737150>]}
[0m10:26:26.721796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b6ef25e-d25a-45d2-98e3-e3d147557357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E2F38590>]}
[0m10:26:26.723109 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:26:26.948609 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:26:27.077475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m10:26:27.077475 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\stg_green_test.sql
[0m10:26:27.078473 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\dim_green_test.sql
[0m10:26:27.078473 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\schema.yml
[0m10:26:27.307856 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'green_tripdata_test' in the 'models' section of file 'models\staging\schema.yml'
[0m10:26:27.309856 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt.stg_green_test' (models\staging\stg_green_test.sql) depends on a source named 'raw.green_tripdata_test' which was not found
[0m10:26:27.310831 [debug] [MainThread]: Command `dbt run` failed at 10:26:27.309856 after 0.88 seconds
[0m10:26:27.310831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E6735150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E6736ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E795E650>]}
[0m10:26:27.310831 [debug] [MainThread]: Flushing usage events
[0m10:26:27.733530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:56.118557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7CB3A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7CB39F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7CB3A650>]}


============================== 10:27:56.129524 | 41371cab-f18a-433b-af2d-b7911304acf2 ==============================
[0m10:27:56.129524 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:27:56.130425 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_green_test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m10:27:56.359288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41371cab-f18a-433b-af2d-b7911304acf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7CBD6B90>]}
[0m10:27:56.415627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41371cab-f18a-433b-af2d-b7911304acf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7CC5FC50>]}
[0m10:27:56.416794 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:27:56.651239 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:27:56.785486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m10:27:56.786486 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\dim_green_test.sql
[0m10:27:56.786486 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\stg_green_test.sql
[0m10:27:56.787487 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\sources.yml
[0m10:27:56.788486 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\staging\schema.yml
[0m10:27:57.079503 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'green_tripdata_test' in the 'models' section of file 'models\staging\schema.yml'
[0m10:27:57.310946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41371cab-f18a-433b-af2d-b7911304acf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7C388090>]}
[0m10:27:57.381058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:27:57.383058 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:27:57.407891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41371cab-f18a-433b-af2d-b7911304acf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7DDD0F90>]}
[0m10:27:57.408324 [info ] [MainThread]: Found 10 models, 5 data tests, 3 sources, 464 macros
[0m10:27:57.408324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41371cab-f18a-433b-af2d-b7911304acf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7C2FD4D0>]}
[0m10:27:57.410351 [info ] [MainThread]: 
[0m10:27:57.410351 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:27:57.411349 [info ] [MainThread]: 
[0m10:27:57.412349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:57.413351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m10:27:57.478527 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m10:27:57.478527 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m10:27:57.478527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:57.495027 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m10:27:57.496041 [debug] [ThreadPool]: On list_de_db: Close
[0m10:27:57.500597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m10:27:57.505751 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m10:27:57.506299 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:27:57.506823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:57.535683 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.029 seconds
[0m10:27:57.537242 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m10:27:57.539407 [debug] [ThreadPool]: On list_de_db_public: Close
[0m10:27:57.550139 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:57.550685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:27:57.550974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:57.566320 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m10:27:57.567294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41371cab-f18a-433b-af2d-b7911304acf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7C312410>]}
[0m10:27:57.568320 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:57.569295 [debug] [MainThread]: On master: COMMIT
[0m10:27:57.570293 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:57.570293 [debug] [MainThread]: On master: COMMIT
[0m10:27:57.572293 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:27:57.573089 [debug] [MainThread]: On master: Close
[0m10:27:57.577104 [debug] [Thread-1 (]: Began running node model.my_dbt.stg_green_test
[0m10:27:57.577104 [info ] [Thread-1 (]: 1 of 1 START sql table model public.stg_green_test ............................. [RUN]
[0m10:27:57.578131 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.stg_green_test'
[0m10:27:57.578131 [debug] [Thread-1 (]: Began compiling node model.my_dbt.stg_green_test
[0m10:27:57.585592 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.stg_green_test"
[0m10:27:57.586025 [debug] [Thread-1 (]: Began executing node model.my_dbt.stg_green_test
[0m10:27:57.620505 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.stg_green_test"
[0m10:27:57.621479 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m10:27:57.622479 [debug] [Thread-1 (]: On model.my_dbt.stg_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_green_test"} */

  
    

  create  table "de_db"."public"."stg_green_test__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."green_tripdata_test"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "lpep_pickup_datetime" as pickup_datetime,
        "lpep_dropoff_datetime" as dropoff_datetime,
        "RatecodeID" as rate_code_id,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id
    from source

)

select * from renamed
  );
  
[0m10:27:57.622479 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:27:57.712406 [debug] [Thread-1 (]: SQL status: SELECT 48326 in 0.089 seconds
[0m10:27:57.720532 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m10:27:57.720532 [debug] [Thread-1 (]: On model.my_dbt.stg_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_green_test"} */
alter table "de_db"."public"."stg_green_test__dbt_tmp" rename to "stg_green_test"
[0m10:27:57.722491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:27:57.734647 [debug] [Thread-1 (]: On model.my_dbt.stg_green_test: COMMIT
[0m10:27:57.735651 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m10:27:57.736085 [debug] [Thread-1 (]: On model.my_dbt.stg_green_test: COMMIT
[0m10:27:57.767075 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m10:27:57.772612 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."stg_green_test__dbt_backup"
[0m10:27:57.777973 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m10:27:57.778514 [debug] [Thread-1 (]: On model.my_dbt.stg_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_green_test"} */
drop table if exists "de_db"."public"."stg_green_test__dbt_backup" cascade
[0m10:27:57.782577 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:27:57.785151 [debug] [Thread-1 (]: On model.my_dbt.stg_green_test: Close
[0m10:27:57.787160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41371cab-f18a-433b-af2d-b7911304acf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7DDFB350>]}
[0m10:27:57.788568 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.stg_green_test ........................ [[32mSELECT 48326[0m in 0.21s]
[0m10:27:57.789246 [debug] [Thread-1 (]: Finished running node model.my_dbt.stg_green_test
[0m10:27:57.790413 [debug] [MainThread]: On master: COMMIT
[0m10:27:57.790932 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:57.791485 [debug] [MainThread]: On master: COMMIT
[0m10:27:57.792028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:57.805905 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m10:27:57.806446 [debug] [MainThread]: On master: Close
[0m10:27:57.806963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:57.806963 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m10:27:57.807519 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m10:27:57.808204 [debug] [MainThread]: Connection 'model.my_dbt.stg_green_test' was properly closed.
[0m10:27:57.808204 [info ] [MainThread]: 
[0m10:27:57.809121 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m10:27:57.810256 [debug] [MainThread]: Command end result
[0m10:27:57.831810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m10:27:57.833834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m10:27:57.839189 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m10:27:57.839189 [info ] [MainThread]: 
[0m10:27:57.840157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:27:57.840157 [info ] [MainThread]: 
[0m10:27:57.841157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:27:57.842342 [debug] [MainThread]: Command `dbt run` succeeded at 10:27:57.842342 after 1.86 seconds
[0m10:27:57.842342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE75D88D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7C83A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE760A2890>]}
[0m10:27:57.843378 [debug] [MainThread]: Flushing usage events
[0m10:27:58.147167 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:17.134116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEC04A810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EECEF8D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EECF2AB50>]}


============================== 12:28:17.138818 | b787fbd3-f97d-49ec-b579-984ee03d959a ==============================
[0m12:28:17.138818 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:28:17.139463 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_green_test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:28:17.386499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b787fbd3-f97d-49ec-b579-984ee03d959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEDF2F090>]}
[0m12:28:17.441917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b787fbd3-f97d-49ec-b579-984ee03d959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE9728D50>]}
[0m12:28:17.442946 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:28:17.792321 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:28:18.903380 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:28:18.904380 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\fct_green_test.sql
[0m12:28:18.904380 [debug] [MainThread]: Partial parsing: deleted file: my_dbt://models\marts\dim_green_test.sql
[0m12:28:19.134574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b787fbd3-f97d-49ec-b579-984ee03d959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEE636AD0>]}
[0m12:28:19.253209 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:28:19.270555 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:28:19.305736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b787fbd3-f97d-49ec-b579-984ee03d959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEC6DD710>]}
[0m12:28:19.306896 [info ] [MainThread]: Found 10 models, 5 data tests, 3 sources, 464 macros
[0m12:28:19.307542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b787fbd3-f97d-49ec-b579-984ee03d959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE990D010>]}
[0m12:28:19.309147 [info ] [MainThread]: 
[0m12:28:19.310323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:19.310423 [info ] [MainThread]: 
[0m12:28:19.311729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:19.313376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m12:28:21.918719 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m12:28:21.918719 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m12:28:21.918719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:21.936753 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m12:28:21.937814 [debug] [ThreadPool]: On list_de_db: Close
[0m12:28:21.942501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:28:21.948550 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:28:21.948550 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:28:21.949549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:21.975824 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.026 seconds
[0m12:28:21.977494 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:28:21.979181 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:28:21.990037 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:21.990561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:28:21.991111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:22.021963 [debug] [MainThread]: SQL status: SELECT 0 in 0.030 seconds
[0m12:28:22.023012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b787fbd3-f97d-49ec-b579-984ee03d959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEEAC0850>]}
[0m12:28:22.023582 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:22.024813 [debug] [MainThread]: On master: COMMIT
[0m12:28:22.025722 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:22.025722 [debug] [MainThread]: On master: COMMIT
[0m12:28:22.028150 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:28:22.028150 [debug] [MainThread]: On master: Close
[0m12:28:22.033225 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_green_test
[0m12:28:22.034307 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_green_test ............................. [RUN]
[0m12:28:22.034307 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_green_test'
[0m12:28:22.035276 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_green_test
[0m12:28:22.043532 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_green_test"
[0m12:28:22.044570 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_green_test
[0m12:28:22.076253 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_green_test"
[0m12:28:22.077228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:28:22.078226 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */

  
    

  create  table "de_db"."public"."fct_green_test__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."stg_green_test"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        rate_code_id,
        pu_location_id,
        do_location_id,

        count(vendor_id) as total_number_of_trip
        from trips
)

select * from final
  );
  
[0m12:28:22.078226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:28:22.112728 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "trips.vendor_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 19:         vendor_id,
                 ^

[0m12:28:22.113324 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: ROLLBACK
[0m12:28:22.114264 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: Close
[0m12:28:22.242473 [debug] [Thread-1 (]: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  column "trips.vendor_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 19:         vendor_id,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:28:22.244474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b787fbd3-f97d-49ec-b579-984ee03d959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEE6E3A10>]}
[0m12:28:22.245446 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.fct_green_test .................... [[31mERROR[0m in 0.21s]
[0m12:28:22.246445 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_green_test
[0m12:28:22.247446 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.fct_green_test' to be skipped because of status 'error'.  Reason: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  column "trips.vendor_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 19:         vendor_id,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql.
[0m12:28:22.248472 [debug] [MainThread]: On master: COMMIT
[0m12:28:22.249472 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:22.249472 [debug] [MainThread]: On master: COMMIT
[0m12:28:22.249472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:22.284224 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m12:28:22.284765 [debug] [MainThread]: On master: Close
[0m12:28:22.285422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:22.286089 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m12:28:22.286651 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:28:22.287196 [debug] [MainThread]: Connection 'model.my_dbt.fct_green_test' was properly closed.
[0m12:28:22.287987 [info ] [MainThread]: 
[0m12:28:22.288525 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m12:28:22.289715 [debug] [MainThread]: Command end result
[0m12:28:22.311739 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:28:22.314712 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:28:22.319591 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:28:22.320592 [info ] [MainThread]: 
[0m12:28:22.321592 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:28:22.321592 [info ] [MainThread]: 
[0m12:28:22.322591 [error] [MainThread]: [31mFailure in model fct_green_test (models\marts\fct_green_test.sql)[0m
[0m12:28:22.322591 [error] [MainThread]:   Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  column "trips.vendor_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 19:         vendor_id,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:28:22.323591 [info ] [MainThread]: 
[0m12:28:22.323591 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\fct_green_test.sql
[0m12:28:22.324591 [info ] [MainThread]: 
[0m12:28:22.324591 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:28:22.325682 [debug] [MainThread]: Command `dbt run` failed at 12:28:22.325682 after 5.30 seconds
[0m12:28:22.326596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEEF78550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEEF78690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEEF78150>]}
[0m12:28:22.326596 [debug] [MainThread]: Flushing usage events
[0m12:28:22.767074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:08.917674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDEB6A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDE384290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDEB8A8D0>]}


============================== 12:29:08.921674 | 15b41235-5762-4b14-835d-95606c28c03b ==============================
[0m12:29:08.921674 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:29:08.921674 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run --select fct_green_test', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:29:09.087427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b41235-5762-4b14-835d-95606c28c03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDFCFE290>]}
[0m12:29:09.141451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15b41235-5762-4b14-835d-95606c28c03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDB3B8150>]}
[0m12:29:09.142480 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:29:09.364177 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:29:09.503240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:09.504240 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\fct_green_test.sql
[0m12:29:09.733901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15b41235-5762-4b14-835d-95606c28c03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDFE14690>]}
[0m12:29:09.869721 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:29:09.872293 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:29:09.898438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15b41235-5762-4b14-835d-95606c28c03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDFD4A350>]}
[0m12:29:09.899441 [info ] [MainThread]: Found 10 models, 5 data tests, 3 sources, 464 macros
[0m12:29:09.899441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b41235-5762-4b14-835d-95606c28c03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE034A190>]}
[0m12:29:09.902669 [info ] [MainThread]: 
[0m12:29:09.904184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:09.904184 [info ] [MainThread]: 
[0m12:29:09.905183 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:09.906181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m12:29:09.970891 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m12:29:09.970891 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m12:29:09.971890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:09.988508 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m12:29:09.989811 [debug] [ThreadPool]: On list_de_db: Close
[0m12:29:09.994302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:29:09.999188 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:29:09.999784 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:29:10.000352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:10.039829 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.040 seconds
[0m12:29:10.041882 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:29:10.043399 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:29:10.055010 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:10.055010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:29:10.055985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:10.086852 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m12:29:10.087665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b41235-5762-4b14-835d-95606c28c03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDFD820D0>]}
[0m12:29:10.088693 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:10.090237 [debug] [MainThread]: On master: COMMIT
[0m12:29:10.090893 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:10.091475 [debug] [MainThread]: On master: COMMIT
[0m12:29:10.093212 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:29:10.094049 [debug] [MainThread]: On master: Close
[0m12:29:10.098394 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_green_test
[0m12:29:10.098394 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_green_test ............................. [RUN]
[0m12:29:10.099621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_green_test'
[0m12:29:10.100197 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_green_test
[0m12:29:10.107498 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_green_test"
[0m12:29:10.108497 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_green_test
[0m12:29:10.139432 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_green_test"
[0m12:29:10.140431 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:29:10.141406 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */

  
    

  create  table "de_db"."public"."fct_green_test__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."stg_green_test"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        rate_code_id,
        pu_location_id,
        do_location_id,

        count(vendor_id) as total_number_of_trip
        group by 1
        from trips
)

select * from final
  );
  
[0m12:29:10.141406 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:29:10.177188 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 27:         from trips
                 ^

[0m12:29:10.177794 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: ROLLBACK
[0m12:29:10.179569 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: Close
[0m12:29:10.183015 [debug] [Thread-1 (]: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 27:         from trips
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:29:10.185015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b41235-5762-4b14-835d-95606c28c03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDFDB6390>]}
[0m12:29:10.186047 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.fct_green_test .................... [[31mERROR[0m in 0.08s]
[0m12:29:10.187054 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_green_test
[0m12:29:10.188046 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.fct_green_test' to be skipped because of status 'error'.  Reason: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 27:         from trips
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql.
[0m12:29:10.189049 [debug] [MainThread]: On master: COMMIT
[0m12:29:10.190046 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:10.190046 [debug] [MainThread]: On master: COMMIT
[0m12:29:10.190046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:10.224988 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m12:29:10.225899 [debug] [MainThread]: On master: Close
[0m12:29:10.226142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:10.226723 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m12:29:10.227234 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:29:10.227272 [debug] [MainThread]: Connection 'model.my_dbt.fct_green_test' was properly closed.
[0m12:29:10.227815 [info ] [MainThread]: 
[0m12:29:10.228503 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m12:29:10.229333 [debug] [MainThread]: Command end result
[0m12:29:10.251123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:29:10.253096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:29:10.259215 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:29:10.259728 [info ] [MainThread]: 
[0m12:29:10.259728 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:29:10.260727 [info ] [MainThread]: 
[0m12:29:10.261727 [error] [MainThread]: [31mFailure in model fct_green_test (models\marts\fct_green_test.sql)[0m
[0m12:29:10.261941 [error] [MainThread]:   Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 27:         from trips
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:29:10.262975 [info ] [MainThread]: 
[0m12:29:10.262975 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\fct_green_test.sql
[0m12:29:10.263949 [info ] [MainThread]: 
[0m12:29:10.263949 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:29:10.264949 [debug] [MainThread]: Command `dbt run` failed at 12:29:10.264949 after 1.41 seconds
[0m12:29:10.265978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDEB8A7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE039E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CDEBACF50>]}
[0m12:29:10.265978 [debug] [MainThread]: Flushing usage events
[0m12:29:10.573072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:37.635518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2CB6A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2CB63050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2CB62D90>]}


============================== 12:29:37.640571 | 40431ee0-ade8-4a08-91a8-36241be1eb48 ==============================
[0m12:29:37.640571 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:29:37.641612 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fct_green_test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:29:37.812134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40431ee0-ade8-4a08-91a8-36241be1eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2CC9E8D0>]}
[0m12:29:37.867789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40431ee0-ade8-4a08-91a8-36241be1eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC293B88D0>]}
[0m12:29:37.869420 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:29:38.099223 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:29:38.249161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:38.249994 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\fct_green_test.sql
[0m12:29:38.482853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40431ee0-ade8-4a08-91a8-36241be1eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2E3B4210>]}
[0m12:29:38.617666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:29:38.619666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:29:38.646035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40431ee0-ade8-4a08-91a8-36241be1eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2DD29710>]}
[0m12:29:38.647036 [info ] [MainThread]: Found 10 models, 5 data tests, 3 sources, 464 macros
[0m12:29:38.648036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40431ee0-ade8-4a08-91a8-36241be1eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2E18F0D0>]}
[0m12:29:38.650035 [info ] [MainThread]: 
[0m12:29:38.650309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:38.650309 [info ] [MainThread]: 
[0m12:29:38.651316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:38.652997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m12:29:38.720296 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m12:29:38.721295 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m12:29:38.721295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:38.740075 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m12:29:38.741135 [debug] [ThreadPool]: On list_de_db: Close
[0m12:29:38.746240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:29:38.751504 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:29:38.751947 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:29:38.752466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:38.788510 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.036 seconds
[0m12:29:38.789476 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:29:38.792008 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:29:38.802883 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:38.802883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:29:38.803885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:38.835645 [debug] [MainThread]: SQL status: SELECT 0 in 0.031 seconds
[0m12:29:38.836642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40431ee0-ade8-4a08-91a8-36241be1eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2E1918D0>]}
[0m12:29:38.837642 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:38.838905 [debug] [MainThread]: On master: COMMIT
[0m12:29:38.839418 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:38.839418 [debug] [MainThread]: On master: COMMIT
[0m12:29:38.841565 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:29:38.842106 [debug] [MainThread]: On master: Close
[0m12:29:38.846213 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_green_test
[0m12:29:38.847284 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_green_test ............................. [RUN]
[0m12:29:38.848121 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_green_test'
[0m12:29:38.848572 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_green_test
[0m12:29:38.855427 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_green_test"
[0m12:29:38.855427 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_green_test
[0m12:29:38.887242 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_green_test"
[0m12:29:38.888241 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:29:38.889216 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */

  
    

  create  table "de_db"."public"."fct_green_test__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."stg_green_test"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        rate_code_id,
        pu_location_id,
        do_location_id,

        count(vendor_id) as total_number_of_trip
        from trips
        group by 1
)

select * from final
  );
  
[0m12:29:38.889216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:29:38.925939 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "trips.pickup_datetime" must appear in the GROUP BY clause or be used in an aggregate function
LINE 20:         pickup_datetime,
                 ^

[0m12:29:38.926900 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: ROLLBACK
[0m12:29:38.927902 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: Close
[0m12:29:38.932902 [debug] [Thread-1 (]: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  column "trips.pickup_datetime" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 20:         pickup_datetime,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:29:38.934874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40431ee0-ade8-4a08-91a8-36241be1eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2E73D2D0>]}
[0m12:29:38.934874 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.fct_green_test .................... [[31mERROR[0m in 0.09s]
[0m12:29:38.935875 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_green_test
[0m12:29:38.936901 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.fct_green_test' to be skipped because of status 'error'.  Reason: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  column "trips.pickup_datetime" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 20:         pickup_datetime,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql.
[0m12:29:38.938454 [debug] [MainThread]: On master: COMMIT
[0m12:29:38.938454 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:38.939452 [debug] [MainThread]: On master: COMMIT
[0m12:29:38.939452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:38.972013 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m12:29:38.972548 [debug] [MainThread]: On master: Close
[0m12:29:38.972610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:38.972610 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m12:29:38.973549 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:29:38.973549 [debug] [MainThread]: Connection 'model.my_dbt.fct_green_test' was properly closed.
[0m12:29:38.974548 [info ] [MainThread]: 
[0m12:29:38.975548 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m12:29:38.976548 [debug] [MainThread]: Command end result
[0m12:29:38.999414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:29:39.001419 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:29:39.007003 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:29:39.007003 [info ] [MainThread]: 
[0m12:29:39.008002 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:29:39.008002 [info ] [MainThread]: 
[0m12:29:39.009002 [error] [MainThread]: [31mFailure in model fct_green_test (models\marts\fct_green_test.sql)[0m
[0m12:29:39.010027 [error] [MainThread]:   Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  column "trips.pickup_datetime" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 20:         pickup_datetime,
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:29:39.010027 [info ] [MainThread]: 
[0m12:29:39.011029 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\fct_green_test.sql
[0m12:29:39.011029 [info ] [MainThread]: 
[0m12:29:39.012028 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:29:39.013032 [debug] [MainThread]: Command `dbt run` failed at 12:29:39.013032 after 1.45 seconds
[0m12:29:39.014003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2CB927D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2CBBB110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2C86A450>]}
[0m12:29:39.014003 [debug] [MainThread]: Flushing usage events
[0m12:29:39.351649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:30:29.432519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4645CAF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4645F5AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4645F55D0>]}


============================== 12:30:29.437063 | 69e6c53f-fe49-432e-a62b-d028a7fe9f10 ==============================
[0m12:30:29.437063 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:30:29.438063 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_green_test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:30:29.626647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69e6c53f-fe49-432e-a62b-d028a7fe9f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4657D6A90>]}
[0m12:30:29.691599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69e6c53f-fe49-432e-a62b-d028a7fe9f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A460E28390>]}
[0m12:30:29.694295 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:30:29.964782 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:30:30.132991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:30.133990 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\fct_green_test.sql
[0m12:30:30.390628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69e6c53f-fe49-432e-a62b-d028a7fe9f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46584DC90>]}
[0m12:30:30.546020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:30:30.549020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:30:30.570569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69e6c53f-fe49-432e-a62b-d028a7fe9f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4657A8050>]}
[0m12:30:30.571569 [info ] [MainThread]: Found 10 models, 5 data tests, 3 sources, 464 macros
[0m12:30:30.571569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e6c53f-fe49-432e-a62b-d028a7fe9f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A465CE5B50>]}
[0m12:30:30.573569 [info ] [MainThread]: 
[0m12:30:30.573569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:30.574568 [info ] [MainThread]: 
[0m12:30:30.574568 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:30:30.575568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m12:30:30.641648 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m12:30:30.642648 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m12:30:30.642648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:30.658321 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m12:30:30.659868 [debug] [ThreadPool]: On list_de_db: Close
[0m12:30:30.664410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:30:30.669411 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:30:30.669411 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:30:30.670412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:30.683411 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.014 seconds
[0m12:30:30.685411 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:30:30.687408 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:30:30.698525 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:30.699557 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:30:30.699557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:30.741184 [debug] [MainThread]: SQL status: SELECT 0 in 0.041 seconds
[0m12:30:30.743316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e6c53f-fe49-432e-a62b-d028a7fe9f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4657A5B90>]}
[0m12:30:30.744362 [debug] [MainThread]: On master: ROLLBACK
[0m12:30:30.746751 [debug] [MainThread]: On master: COMMIT
[0m12:30:30.747276 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:30.747793 [debug] [MainThread]: On master: COMMIT
[0m12:30:30.749854 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:30:30.750371 [debug] [MainThread]: On master: Close
[0m12:30:30.768461 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_green_test
[0m12:30:30.769462 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_green_test ............................. [RUN]
[0m12:30:30.770462 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_green_test'
[0m12:30:30.771460 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_green_test
[0m12:30:30.778459 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_green_test"
[0m12:30:30.780462 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_green_test
[0m12:30:30.811239 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_green_test"
[0m12:30:30.812238 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:30:30.812238 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */

  
    

  create  table "de_db"."public"."fct_green_test__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."stg_green_test"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        rate_code_id,
        pu_location_id,
        do_location_id,
        from trips
)

select * from final
  );
  
[0m12:30:30.813240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:30:30.826005 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 24:         from trips
                 ^

[0m12:30:30.826518 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: ROLLBACK
[0m12:30:30.827541 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: Close
[0m12:30:30.832593 [debug] [Thread-1 (]: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 24:         from trips
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:30:30.833593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69e6c53f-fe49-432e-a62b-d028a7fe9f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A465834D10>]}
[0m12:30:30.834593 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.fct_green_test .................... [[31mERROR[0m in 0.06s]
[0m12:30:30.835595 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_green_test
[0m12:30:30.836593 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.fct_green_test' to be skipped because of status 'error'.  Reason: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 24:         from trips
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql.
[0m12:30:30.837594 [debug] [MainThread]: On master: COMMIT
[0m12:30:30.838593 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:30.838593 [debug] [MainThread]: On master: COMMIT
[0m12:30:30.838593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:30:30.850593 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m12:30:30.850593 [debug] [MainThread]: On master: Close
[0m12:30:30.851593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:30.852601 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m12:30:30.852601 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:30:30.852601 [debug] [MainThread]: Connection 'model.my_dbt.fct_green_test' was properly closed.
[0m12:30:30.853596 [info ] [MainThread]: 
[0m12:30:30.854595 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:30:30.854595 [debug] [MainThread]: Command end result
[0m12:30:30.880848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:30:30.883770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:30:30.889966 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:30:30.890475 [info ] [MainThread]: 
[0m12:30:30.891528 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:30:30.892043 [info ] [MainThread]: 
[0m12:30:30.892660 [error] [MainThread]: [31mFailure in model fct_green_test (models\marts\fct_green_test.sql)[0m
[0m12:30:30.893181 [error] [MainThread]:   Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 24:         from trips
                   ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:30:30.893697 [info ] [MainThread]: 
[0m12:30:30.894206 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\fct_green_test.sql
[0m12:30:30.894719 [info ] [MainThread]: 
[0m12:30:30.895239 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:30:30.896821 [debug] [MainThread]: Command `dbt run` failed at 12:30:30.896275 after 1.54 seconds
[0m12:30:30.897335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A464624190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A463245290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4645C2490>]}
[0m12:30:30.897848 [debug] [MainThread]: Flushing usage events
[0m12:30:31.225215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:50.133017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709AC0AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709AC5B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709AC32790>]}


============================== 12:31:50.137043 | 7fdcc6e9-de2a-4ddd-bcbd-df6ee89f3b2c ==============================
[0m12:31:50.137043 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:31:50.138042 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run --select fct_green_test', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:31:50.306809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fdcc6e9-de2a-4ddd-bcbd-df6ee89f3b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709BC75390>]}
[0m12:31:50.363824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fdcc6e9-de2a-4ddd-bcbd-df6ee89f3b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709744A790>]}
[0m12:31:50.364799 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:31:50.590971 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:31:50.726736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:50.726736 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\fct_green_test.sql
[0m12:31:50.963581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fdcc6e9-de2a-4ddd-bcbd-df6ee89f3b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709BECDCD0>]}
[0m12:31:51.097090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:31:51.099090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:31:51.121918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fdcc6e9-de2a-4ddd-bcbd-df6ee89f3b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709BDE0290>]}
[0m12:31:51.121918 [info ] [MainThread]: Found 10 models, 5 data tests, 3 sources, 464 macros
[0m12:31:51.122918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fdcc6e9-de2a-4ddd-bcbd-df6ee89f3b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709C2D7B90>]}
[0m12:31:51.123919 [info ] [MainThread]: 
[0m12:31:51.124947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:51.124947 [info ] [MainThread]: 
[0m12:31:51.125918 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:31:51.127195 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m12:31:51.190877 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m12:31:51.190877 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m12:31:51.191764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:51.208011 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m12:31:51.209037 [debug] [ThreadPool]: On list_de_db: Close
[0m12:31:51.214144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:31:51.218142 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:31:51.219141 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:31:51.219141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:51.253388 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.034 seconds
[0m12:31:51.256144 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:31:51.258125 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:31:51.268317 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:51.269273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:31:51.269273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:51.299702 [debug] [MainThread]: SQL status: SELECT 0 in 0.030 seconds
[0m12:31:51.301248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fdcc6e9-de2a-4ddd-bcbd-df6ee89f3b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709BDE3B90>]}
[0m12:31:51.301248 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:51.303244 [debug] [MainThread]: On master: COMMIT
[0m12:31:51.304243 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:51.305244 [debug] [MainThread]: On master: COMMIT
[0m12:31:51.307770 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:31:51.308315 [debug] [MainThread]: On master: Close
[0m12:31:51.312979 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_green_test
[0m12:31:51.313530 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_green_test ............................. [RUN]
[0m12:31:51.314583 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_green_test'
[0m12:31:51.314768 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_green_test
[0m12:31:51.322419 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_green_test"
[0m12:31:51.322998 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_green_test
[0m12:31:51.353960 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_green_test"
[0m12:31:51.354960 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:31:51.355960 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */

  
    

  create  table "de_db"."public"."fct_green_test__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."stg_green_test"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        rate_code_id,
        pu_location_id,
        do_location_id,
    from trips
)

select * from final
  );
  
[0m12:31:51.355960 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:31:51.370137 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 24:     from trips
             ^

[0m12:31:51.370729 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: ROLLBACK
[0m12:31:51.372483 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: Close
[0m12:31:51.376556 [debug] [Thread-1 (]: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 24:     from trips
               ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:31:51.378464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fdcc6e9-de2a-4ddd-bcbd-df6ee89f3b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709C761D50>]}
[0m12:31:51.378975 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.fct_green_test .................... [[31mERROR[0m in 0.06s]
[0m12:31:51.380430 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_green_test
[0m12:31:51.381065 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.fct_green_test' to be skipped because of status 'error'.  Reason: Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 24:     from trips
               ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql.
[0m12:31:51.382700 [debug] [MainThread]: On master: COMMIT
[0m12:31:51.383103 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:51.383169 [debug] [MainThread]: On master: COMMIT
[0m12:31:51.383693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:51.420826 [debug] [MainThread]: SQL status: COMMIT in 0.037 seconds
[0m12:31:51.420826 [debug] [MainThread]: On master: Close
[0m12:31:51.421836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:51.421836 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m12:31:51.422584 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:31:51.422584 [debug] [MainThread]: Connection 'model.my_dbt.fct_green_test' was properly closed.
[0m12:31:51.422584 [info ] [MainThread]: 
[0m12:31:51.424002 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:31:51.425313 [debug] [MainThread]: Command end result
[0m12:31:51.447647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:31:51.450616 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:31:51.456384 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:31:51.456384 [info ] [MainThread]: 
[0m12:31:51.457382 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:31:51.457382 [info ] [MainThread]: 
[0m12:31:51.458383 [error] [MainThread]: [31mFailure in model fct_green_test (models\marts\fct_green_test.sql)[0m
[0m12:31:51.459504 [error] [MainThread]:   Database Error in model fct_green_test (models\marts\fct_green_test.sql)
  syntax error at or near "from"
  LINE 24:     from trips
               ^
  compiled code at target\run\my_dbt\models\marts\fct_green_test.sql
[0m12:31:51.459732 [info ] [MainThread]: 
[0m12:31:51.460611 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\fct_green_test.sql
[0m12:31:51.460869 [info ] [MainThread]: 
[0m12:31:51.461567 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:31:51.462588 [debug] [MainThread]: Command `dbt run` failed at 12:31:51.462460 after 1.39 seconds
[0m12:31:51.462686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709AC327D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709AC311D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002709AC02750>]}
[0m12:31:51.463197 [debug] [MainThread]: Flushing usage events
[0m12:31:51.812130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:10.137755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025475929510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547597B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547597AA50>]}


============================== 12:38:10.141780 | 47ab6874-c431-4c08-973f-d8931137ea6a ==============================
[0m12:38:10.141780 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:38:10.142766 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select fct_green_test', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m12:38:10.317087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47ab6874-c431-4c08-973f-d8931137ea6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025476B7BE50>]}
[0m12:38:10.374516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47ab6874-c431-4c08-973f-d8931137ea6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025476A27C50>]}
[0m12:38:10.376517 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:38:10.602145 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:38:10.739751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:38:10.739751 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\fct_green_test.sql
[0m12:38:10.973382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47ab6874-c431-4c08-973f-d8931137ea6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025476B604D0>]}
[0m12:38:11.094134 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:38:11.097224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:38:11.120388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47ab6874-c431-4c08-973f-d8931137ea6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025476AFEE90>]}
[0m12:38:11.120388 [info ] [MainThread]: Found 10 models, 5 data tests, 3 sources, 464 macros
[0m12:38:11.121420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47ab6874-c431-4c08-973f-d8931137ea6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254770DD1D0>]}
[0m12:38:11.122359 [info ] [MainThread]: 
[0m12:38:11.123385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:11.124358 [info ] [MainThread]: 
[0m12:38:11.124358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:11.125359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m12:38:11.189644 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m12:38:11.189644 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m12:38:11.190676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:11.207721 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m12:38:11.208721 [debug] [ThreadPool]: On list_de_db: Close
[0m12:38:11.213695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m12:38:11.218200 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m12:38:11.219184 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:38:11.219184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:11.251065 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.032 seconds
[0m12:38:11.253804 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m12:38:11.255602 [debug] [ThreadPool]: On list_de_db_public: Close
[0m12:38:11.268538 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:11.269570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:38:11.270117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:11.286341 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m12:38:11.287473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47ab6874-c431-4c08-973f-d8931137ea6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025476F15410>]}
[0m12:38:11.288501 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:11.289550 [debug] [MainThread]: On master: COMMIT
[0m12:38:11.290616 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:11.290655 [debug] [MainThread]: On master: COMMIT
[0m12:38:11.292799 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:38:11.293411 [debug] [MainThread]: On master: Close
[0m12:38:11.300062 [debug] [Thread-1 (]: Began running node model.my_dbt.fct_green_test
[0m12:38:11.300616 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fct_green_test ............................. [RUN]
[0m12:38:11.301801 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.fct_green_test'
[0m12:38:11.301801 [debug] [Thread-1 (]: Began compiling node model.my_dbt.fct_green_test
[0m12:38:11.309575 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.fct_green_test"
[0m12:38:11.310619 [debug] [Thread-1 (]: Began executing node model.my_dbt.fct_green_test
[0m12:38:11.343627 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.fct_green_test"
[0m12:38:11.344602 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:38:11.345630 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */

  
    

  create  table "de_db"."public"."fct_green_test__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."stg_green_test"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        rate_code_id,
        pu_location_id,
        do_location_id
    from trips
)

select * from final
  );
  
[0m12:38:11.345630 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:38:11.384073 [debug] [Thread-1 (]: SQL status: SELECT 48326 in 0.038 seconds
[0m12:38:11.392072 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:38:11.393073 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */
alter table "de_db"."public"."fct_green_test__dbt_tmp" rename to "fct_green_test"
[0m12:38:11.395265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:38:11.406847 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: COMMIT
[0m12:38:11.406847 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:38:11.407844 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: COMMIT
[0m12:38:11.434090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m12:38:11.440373 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."fct_green_test__dbt_backup"
[0m12:38:11.444380 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m12:38:11.444380 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */
drop table if exists "de_db"."public"."fct_green_test__dbt_backup" cascade
[0m12:38:11.446587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:38:11.448612 [debug] [Thread-1 (]: On model.my_dbt.fct_green_test: Close
[0m12:38:11.450609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47ab6874-c431-4c08-973f-d8931137ea6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025476B63890>]}
[0m12:38:11.451922 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fct_green_test ........................ [[32mSELECT 48326[0m in 0.15s]
[0m12:38:11.452780 [debug] [Thread-1 (]: Finished running node model.my_dbt.fct_green_test
[0m12:38:11.453752 [debug] [MainThread]: On master: COMMIT
[0m12:38:11.454521 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:11.454947 [debug] [MainThread]: On master: COMMIT
[0m12:38:11.455343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:11.477872 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m12:38:11.478836 [debug] [MainThread]: On master: Close
[0m12:38:11.479138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:11.479685 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m12:38:11.479685 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m12:38:11.480244 [debug] [MainThread]: Connection 'model.my_dbt.fct_green_test' was properly closed.
[0m12:38:11.480788 [info ] [MainThread]: 
[0m12:38:11.481331 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m12:38:11.482496 [debug] [MainThread]: Command end result
[0m12:38:11.504831 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m12:38:11.508141 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m12:38:11.513970 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m12:38:11.514582 [info ] [MainThread]: 
[0m12:38:11.514582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:11.515609 [info ] [MainThread]: 
[0m12:38:11.516581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:38:11.517583 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:11.517583 after 1.44 seconds
[0m12:38:11.517583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547583D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547584C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547560B750>]}
[0m12:38:11.518580 [debug] [MainThread]: Flushing usage events
[0m12:38:11.811214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:01.635471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9CABAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9CB0AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9CADA850>]}


============================== 15:16:01.642677 | 550fc49b-3777-4e3f-b388-a9c05ff1aa3d ==============================
[0m15:16:01.642677 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:16:01.643674 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select 01_rolling_avg_zone', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:16:01.829225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '550fc49b-3777-4e3f-b388-a9c05ff1aa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9DC9EBD0>]}
[0m15:16:01.888270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '550fc49b-3777-4e3f-b388-a9c05ff1aa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA993181D0>]}
[0m15:16:01.890271 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:16:02.129586 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:16:02.329194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:16:02.330195 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\staging\01_stg_tripdata.sql
[0m15:16:02.589033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '550fc49b-3777-4e3f-b388-a9c05ff1aa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9E220310>]}
[0m15:16:02.727444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:16:02.729998 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:16:02.759809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '550fc49b-3777-4e3f-b388-a9c05ff1aa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9DC8C410>]}
[0m15:16:02.760855 [info ] [MainThread]: Found 11 models, 5 data tests, 3 sources, 464 macros
[0m15:16:02.761367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '550fc49b-3777-4e3f-b388-a9c05ff1aa3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9CBAC650>]}
[0m15:16:02.761367 [warn ] [MainThread]: The selection criterion '01_rolling_avg_zone' does not match any enabled nodes
[0m15:16:02.763367 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:16:02.764397 [debug] [MainThread]: Command end result
[0m15:16:02.787010 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:16:02.789036 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:16:02.791037 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:16:02.792618 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:02.792618 after 1.24 seconds
[0m15:16:02.792618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA95C68C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA9E25FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA95F86810>]}
[0m15:16:02.793617 [debug] [MainThread]: Flushing usage events
[0m15:16:03.173706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:28.108351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273786E3510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027378716E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027378715250>]}


============================== 15:16:28.112351 | f922d310-2c9c-43cc-9ab0-bf82e3f2ec63 ==============================
[0m15:16:28.112351 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:16:28.113351 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run --select 01_rolling_avg_zone', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:16:28.298573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f922d310-2c9c-43cc-9ab0-bf82e3f2ec63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273799394D0>]}
[0m15:16:28.361194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f922d310-2c9c-43cc-9ab0-bf82e3f2ec63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027374F48150>]}
[0m15:16:28.362941 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:16:28.633714 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:16:28.787937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:16:28.788936 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:16:28.788936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:16:28.832968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f922d310-2c9c-43cc-9ab0-bf82e3f2ec63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273799355D0>]}
[0m15:16:28.919390 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:16:28.921363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:16:28.950059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f922d310-2c9c-43cc-9ab0-bf82e3f2ec63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027379E64490>]}
[0m15:16:28.951058 [info ] [MainThread]: Found 11 models, 5 data tests, 3 sources, 464 macros
[0m15:16:28.951058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f922d310-2c9c-43cc-9ab0-bf82e3f2ec63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027379E59190>]}
[0m15:16:28.952065 [warn ] [MainThread]: The selection criterion '01_rolling_avg_zone' does not match any enabled nodes
[0m15:16:28.952992 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:16:28.955001 [debug] [MainThread]: Command end result
[0m15:16:29.035623 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:16:29.037621 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:16:29.040219 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:16:29.041218 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:29.041218 after 1.01 seconds
[0m15:16:29.042217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737786A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027371C36810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027371C20950>]}
[0m15:16:29.042217 [debug] [MainThread]: Flushing usage events
[0m15:16:29.342014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:01.349492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002751E0FA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002751E121D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002751E122310>]}


============================== 15:17:01.353989 | d0cdfae1-a21d-4398-94d2-089f4d1da66e ==============================
[0m15:17:01.353989 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:17:01.354508 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select 01_rolling_avg_zone', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:17:01.552738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0cdfae1-a21d-4398-94d2-089f4d1da66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002751E0F2A10>]}
[0m15:17:01.618453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0cdfae1-a21d-4398-94d2-089f4d1da66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002751F1FFC50>]}
[0m15:17:01.620455 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:17:01.887516 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:17:02.023870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:02.024896 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:17:02.024896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:02.068777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0cdfae1-a21d-4398-94d2-089f4d1da66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002751E1553D0>]}
[0m15:17:02.157968 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:17:02.160939 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:17:02.186146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0cdfae1-a21d-4398-94d2-089f4d1da66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002751F8EFFD0>]}
[0m15:17:02.186146 [info ] [MainThread]: Found 11 models, 5 data tests, 3 sources, 464 macros
[0m15:17:02.187146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0cdfae1-a21d-4398-94d2-089f4d1da66e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002751F6B8390>]}
[0m15:17:02.188146 [warn ] [MainThread]: The selection criterion '01_rolling_avg_zone' does not match any enabled nodes
[0m15:17:02.193146 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:17:02.195144 [debug] [MainThread]: Command end result
[0m15:17:02.278360 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:17:02.280360 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:17:02.283359 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:17:02.283359 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:02.283359 after 1.01 seconds
[0m15:17:02.284460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027517646810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027517630950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027517631AD0>]}
[0m15:17:02.285030 [debug] [MainThread]: Flushing usage events
[0m15:17:02.614270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:37.285624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A56BBB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A5EAA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A5EA9D50>]}


============================== 15:18:37.292269 | fd7d1991-7092-4d2c-8b56-f9a3ee74e0a3 ==============================
[0m15:18:37.292269 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:18:37.298394 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run --select 01_rolling_avg_zone', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:18:37.528419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd7d1991-7092-4d2c-8b56-f9a3ee74e0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A5F25490>]}
[0m15:18:37.609398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd7d1991-7092-4d2c-8b56-f9a3ee74e0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A26D8350>]}
[0m15:18:37.610987 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:18:37.861575 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:18:38.052379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:38.052926 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:18:38.053474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:38.106273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd7d1991-7092-4d2c-8b56-f9a3ee74e0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A7485B10>]}
[0m15:18:38.202671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:18:38.205728 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:18:38.239749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd7d1991-7092-4d2c-8b56-f9a3ee74e0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A767FF10>]}
[0m15:18:38.240749 [info ] [MainThread]: Found 11 models, 5 data tests, 3 sources, 464 macros
[0m15:18:38.241842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd7d1991-7092-4d2c-8b56-f9a3ee74e0a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205A72F6890>]}
[0m15:18:38.242355 [warn ] [MainThread]: The selection criterion '01_rolling_avg_zone' does not match any enabled nodes
[0m15:18:38.243381 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:18:38.245354 [debug] [MainThread]: Command end result
[0m15:18:38.378105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:18:38.380105 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:18:38.390720 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:18:38.391720 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:38.391720 after 1.19 seconds
[0m15:18:38.392720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059F436810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059F420950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002059F421AD0>]}
[0m15:18:38.392720 [debug] [MainThread]: Flushing usage events
[0m15:18:38.861021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:35.810759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC479A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC47BA610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC47EB010>]}


============================== 15:31:35.814759 | afb007f3-e257-49ef-8195-435bc54a2074 ==============================
[0m15:31:35.814759 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:31:35.815760 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:31:36.219743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC47F50D0>]}
[0m15:31:36.355801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC0FF8250>]}
[0m15:31:36.356802 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:31:36.902583 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:31:37.177588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:37.177588 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:31:37.178588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:37.273683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC5A5D8D0>]}
[0m15:31:37.450271 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:31:37.452272 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:31:37.515848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC5F8FB90>]}
[0m15:31:37.516848 [info ] [MainThread]: Found 11 models, 5 data tests, 3 sources, 464 macros
[0m15:31:37.517849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC5C054D0>]}
[0m15:31:37.519849 [info ] [MainThread]: 
[0m15:31:37.520849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:37.520849 [info ] [MainThread]: 
[0m15:31:37.521848 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:37.525850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m15:31:37.796974 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m15:31:37.797978 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m15:31:37.799071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:37.835269 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m15:31:37.841798 [debug] [ThreadPool]: On list_de_db: Close
[0m15:31:37.855687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m15:31:37.861736 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m15:31:37.863758 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:31:37.865352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:37.933853 [debug] [ThreadPool]: SQL status: SELECT 58 in 0.068 seconds
[0m15:31:37.936430 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m15:31:37.941976 [debug] [ThreadPool]: On list_de_db_public: Close
[0m15:31:37.968624 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:37.969624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:31:37.969624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:38.004434 [debug] [MainThread]: SQL status: SELECT 0 in 0.034 seconds
[0m15:31:38.007470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC3F722D0>]}
[0m15:31:38.012441 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:38.025830 [debug] [MainThread]: On master: COMMIT
[0m15:31:38.026867 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:38.026867 [debug] [MainThread]: On master: COMMIT
[0m15:31:38.028417 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:31:38.028932 [debug] [MainThread]: On master: Close
[0m15:31:38.032564 [debug] [Thread-1 (]: Began running node model.my_dbt.hello
[0m15:31:38.033085 [debug] [Thread-2 (]: Began running node model.my_dbt.stg_green_test
[0m15:31:38.033600 [debug] [Thread-3 (]: Began running node model.my_dbt.stg_taxi_zones
[0m15:31:38.034115 [debug] [Thread-4 (]: Began running node model.my_dbt.stg_yellow_tripdata
[0m15:31:38.034627 [info ] [Thread-1 (]: 1 of 10 START sql table model public.hello ..................................... [RUN]
[0m15:31:38.035142 [info ] [Thread-2 (]: 2 of 10 START sql table model public.stg_green_test ............................ [RUN]
[0m15:31:38.035651 [info ] [Thread-3 (]: 3 of 10 START sql table model public.stg_taxi_zones ............................ [RUN]
[0m15:31:38.036166 [info ] [Thread-4 (]: 4 of 10 START sql table model public.stg_yellow_tripdata ....................... [RUN]
[0m15:31:38.037199 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.hello'
[0m15:31:38.037713 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.my_dbt.stg_green_test'
[0m15:31:38.038231 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_dbt.stg_taxi_zones'
[0m15:31:38.038745 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_dbt.stg_yellow_tripdata'
[0m15:31:38.040834 [debug] [Thread-4 (]: Began compiling node model.my_dbt.stg_yellow_tripdata
[0m15:31:38.039788 [debug] [Thread-2 (]: Began compiling node model.my_dbt.stg_green_test
[0m15:31:38.040304 [debug] [Thread-3 (]: Began compiling node model.my_dbt.stg_taxi_zones
[0m15:31:38.039270 [debug] [Thread-1 (]: Began compiling node model.my_dbt.hello
[0m15:31:38.062824 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.stg_yellow_tripdata"
[0m15:31:38.065827 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.stg_green_test"
[0m15:31:38.067826 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.stg_taxi_zones"
[0m15:31:38.069826 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.hello"
[0m15:31:38.070826 [debug] [Thread-4 (]: Began executing node model.my_dbt.stg_yellow_tripdata
[0m15:31:38.071826 [debug] [Thread-2 (]: Began executing node model.my_dbt.stg_green_test
[0m15:31:38.071826 [debug] [Thread-3 (]: Began executing node model.my_dbt.stg_taxi_zones
[0m15:31:38.140992 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.stg_green_test"
[0m15:31:38.161079 [debug] [Thread-1 (]: Began executing node model.my_dbt.hello
[0m15:31:38.163009 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.stg_yellow_tripdata"
[0m15:31:38.166009 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.stg_taxi_zones"
[0m15:31:38.171543 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.hello"
[0m15:31:38.172515 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m15:31:38.172515 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:31:38.173589 [debug] [Thread-2 (]: On model.my_dbt.stg_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_green_test"} */

  
    

  create  table "de_db"."public"."stg_green_test__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."green_tripdata_test"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "lpep_pickup_datetime" as pickup_datetime,
        "lpep_dropoff_datetime" as dropoff_datetime,
        "RatecodeID" as rate_code_id,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id
    from source

)

select * from renamed
  );
  
[0m15:31:38.174102 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:31:38.174102 [debug] [Thread-4 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */

  
    

  create  table "de_db"."public"."stg_yellow_tripdata__dbt_tmp"
  
  
    as
  
  (
    with source as (

    select *
    from "de_db"."public"."yellow_tripdata_raw"

),

renamed as (

    select
        "VendorID" as vendor_id,
        "tpep_pickup_datetime" as pickup_datetime,
        "tpep_dropoff_datetime" as dropoff_datetime,
        "passenger_count" as passenger_count,
        "trip_distance" as trip_distance,
        "RatecodeID" as ratecode_id,
        "store_and_fwd_flag" as store_and_fwd_flag,
        "PULocationID" as pu_location_id,
        "DOLocationID" as do_location_id,
        "payment_type" as payment_type,
        "fare_amount" as fare_amount,
        "extra" as extra,
        "mta_tax" as mta_tax,
        "tip_amount" as tip_amount,
        "tolls_amount" as tolls_amount,
        "improvement_surcharge" as improvement_surcharge,
        "total_amount" as total_amount,
        "congestion_surcharge" as congestion_surcharge,
        "Airport_fee" as airport_fee,
        "cbd_congestion_fee" as cbd_congestion_fee
    from source

)

select * from renamed
  );
  
[0m15:31:38.175100 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:31:38.175100 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:31:38.176102 [debug] [Thread-3 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */

  
    

  create  table "de_db"."public"."stg_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with source as (
    select *
    from "de_db"."public"."taxi_zones_raw"
),

renamed as (
    select
        "LocationID"::int as location_id,
        "Borough"::text   as borough,
        "Zone"::text      as zone,
        "service_zone"::text as service_zone
    from source
)

select * from renamed
  );
  
[0m15:31:38.176102 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:31:38.195722 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */

  
    

  create  table "de_db"."public"."hello__dbt_tmp"
  
  
    as
  
  (
    select
  1 as id,
  current_timestamp as created_at
  );
  
[0m15:31:38.196718 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:31:38.197790 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:31:38.235515 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.039 seconds
[0m15:31:38.257523 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:31:38.260531 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello" rename to "hello__dbt_backup"
[0m15:31:38.268240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:31:38.271874 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:31:38.272407 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
alter table "de_db"."public"."hello__dbt_tmp" rename to "hello"
[0m15:31:38.273443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:38.285130 [debug] [Thread-3 (]: SQL status: SELECT 265 in 0.088 seconds
[0m15:31:38.305121 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m15:31:38.308121 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:31:38.310122 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:31:38.310122 [debug] [Thread-3 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones" rename to "stg_taxi_zones__dbt_backup"
[0m15:31:38.311121 [debug] [Thread-1 (]: On model.my_dbt.hello: COMMIT
[0m15:31:38.313285 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:31:38.331512 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:31:38.335084 [debug] [Thread-3 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
alter table "de_db"."public"."stg_taxi_zones__dbt_tmp" rename to "stg_taxi_zones"
[0m15:31:38.338098 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:31:38.340167 [debug] [Thread-3 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m15:31:38.340681 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:31:38.340681 [debug] [Thread-3 (]: On model.my_dbt.stg_taxi_zones: COMMIT
[0m15:31:38.363410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m15:31:38.371406 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."hello__dbt_backup"
[0m15:31:38.376614 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.hello"
[0m15:31:38.376626 [debug] [Thread-3 (]: SQL status: COMMIT in 0.036 seconds
[0m15:31:38.377151 [debug] [Thread-1 (]: On model.my_dbt.hello: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.hello"} */
drop table if exists "de_db"."public"."hello__dbt_backup" cascade
[0m15:31:38.383262 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."stg_taxi_zones__dbt_backup"
[0m15:31:38.391264 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.stg_taxi_zones"
[0m15:31:38.395267 [debug] [Thread-3 (]: On model.my_dbt.stg_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_taxi_zones"} */
drop table if exists "de_db"."public"."stg_taxi_zones__dbt_backup" cascade
[0m15:31:38.440051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.052 seconds
[0m15:31:38.442656 [debug] [Thread-1 (]: On model.my_dbt.hello: Close
[0m15:31:38.445240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC5F3A490>]}
[0m15:31:38.446274 [info ] [Thread-1 (]: 1 of 10 OK created sql table model public.hello ................................ [[32mSELECT 1[0m in 0.41s]
[0m15:31:38.447936 [debug] [Thread-1 (]: Finished running node model.my_dbt.hello
[0m15:31:38.468257 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.070 seconds
[0m15:31:38.470396 [debug] [Thread-3 (]: On model.my_dbt.stg_taxi_zones: Close
[0m15:31:38.471430 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC61FF110>]}
[0m15:31:38.472987 [info ] [Thread-3 (]: 3 of 10 OK created sql table model public.stg_taxi_zones ....................... [[32mSELECT 265[0m in 0.43s]
[0m15:31:38.473503 [debug] [Thread-3 (]: Finished running node model.my_dbt.stg_taxi_zones
[0m15:31:38.474536 [debug] [Thread-1 (]: Began running node model.my_dbt.dim_taxi_zones
[0m15:31:38.475574 [info ] [Thread-1 (]: 5 of 10 START sql table model public.dim_taxi_zones ............................ [RUN]
[0m15:31:38.476617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.hello, now model.my_dbt.dim_taxi_zones)
[0m15:31:38.477127 [debug] [Thread-1 (]: Began compiling node model.my_dbt.dim_taxi_zones
[0m15:31:38.480218 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.dim_taxi_zones"
[0m15:31:38.481260 [debug] [Thread-1 (]: Began executing node model.my_dbt.dim_taxi_zones
[0m15:31:38.499158 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.dim_taxi_zones"
[0m15:31:38.504459 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:31:38.506194 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */

  
    

  create  table "de_db"."public"."dim_taxi_zones__dbt_tmp"
  
  
    as
  
  (
    with zones as (
    select *
    from "de_db"."public"."stg_taxi_zones"
)

select
    location_id,
    borough,
    zone,
    service_zone
from zones
  );
  
[0m15:31:38.506706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:38.576700 [debug] [Thread-1 (]: SQL status: SELECT 265 in 0.069 seconds
[0m15:31:38.583703 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:31:38.583703 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones" rename to "dim_taxi_zones__dbt_backup"
[0m15:31:38.586702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:38.599650 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:31:38.603170 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
alter table "de_db"."public"."dim_taxi_zones__dbt_tmp" rename to "dim_taxi_zones"
[0m15:31:38.614127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m15:31:38.617249 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m15:31:38.618299 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:31:38.619365 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: COMMIT
[0m15:31:38.676228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.056 seconds
[0m15:31:38.676750 [debug] [Thread-2 (]: SQL status: SELECT 48326 in 0.501 seconds
[0m15:31:38.679339 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."dim_taxi_zones__dbt_backup"
[0m15:31:38.683482 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m15:31:38.684574 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.dim_taxi_zones"
[0m15:31:38.685089 [debug] [Thread-2 (]: On model.my_dbt.stg_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_green_test"} */
alter table "de_db"."public"."stg_green_test" rename to "stg_green_test__dbt_backup"
[0m15:31:38.685609 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.dim_taxi_zones"} */
drop table if exists "de_db"."public"."dim_taxi_zones__dbt_backup" cascade
[0m15:31:38.688921 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:31:38.705467 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m15:31:38.709467 [debug] [Thread-2 (]: On model.my_dbt.stg_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_green_test"} */
alter table "de_db"."public"."stg_green_test__dbt_tmp" rename to "stg_green_test"
[0m15:31:38.712611 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:31:38.715263 [debug] [Thread-2 (]: On model.my_dbt.stg_green_test: COMMIT
[0m15:31:38.715797 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m15:31:38.716313 [debug] [Thread-2 (]: On model.my_dbt.stg_green_test: COMMIT
[0m15:31:38.723693 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.037 seconds
[0m15:31:38.732753 [debug] [Thread-1 (]: On model.my_dbt.dim_taxi_zones: Close
[0m15:31:38.738747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC5F3DFD0>]}
[0m15:31:38.746761 [info ] [Thread-1 (]: 5 of 10 OK created sql table model public.dim_taxi_zones ....................... [[32mSELECT 265[0m in 0.26s]
[0m15:31:38.748906 [debug] [Thread-1 (]: Finished running node model.my_dbt.dim_taxi_zones
[0m15:31:38.751867 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m15:31:38.757123 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."stg_green_test__dbt_backup"
[0m15:31:38.761643 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.stg_green_test"
[0m15:31:38.766648 [debug] [Thread-2 (]: On model.my_dbt.stg_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_green_test"} */
drop table if exists "de_db"."public"."stg_green_test__dbt_backup" cascade
[0m15:31:38.790794 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.021 seconds
[0m15:31:38.794774 [debug] [Thread-2 (]: On model.my_dbt.stg_green_test: Close
[0m15:31:38.799831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC6277D50>]}
[0m15:31:38.805828 [info ] [Thread-2 (]: 2 of 10 OK created sql table model public.stg_green_test ....................... [[32mSELECT 48326[0m in 0.76s]
[0m15:31:38.818332 [debug] [Thread-2 (]: Finished running node model.my_dbt.stg_green_test
[0m15:31:38.821293 [debug] [Thread-3 (]: Began running node model.my_dbt.fct_green_test
[0m15:31:38.822292 [info ] [Thread-3 (]: 6 of 10 START sql table model public.fct_green_test ............................ [RUN]
[0m15:31:38.824070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_taxi_zones, now model.my_dbt.fct_green_test)
[0m15:31:38.825115 [debug] [Thread-3 (]: Began compiling node model.my_dbt.fct_green_test
[0m15:31:38.848536 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.fct_green_test"
[0m15:31:38.850454 [debug] [Thread-3 (]: Began executing node model.my_dbt.fct_green_test
[0m15:31:38.857451 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.fct_green_test"
[0m15:31:38.858454 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m15:31:38.860454 [debug] [Thread-3 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */

  
    

  create  table "de_db"."public"."fct_green_test__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."stg_green_test"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        rate_code_id,
        pu_location_id,
        do_location_id
    from trips
)

select * from final
  );
  
[0m15:31:38.860454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:31:39.121667 [debug] [Thread-3 (]: SQL status: SELECT 48326 in 0.261 seconds
[0m15:31:39.125282 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m15:31:39.126316 [debug] [Thread-3 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */
alter table "de_db"."public"."fct_green_test" rename to "fct_green_test__dbt_backup"
[0m15:31:39.128896 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:39.135844 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m15:31:39.137368 [debug] [Thread-3 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */
alter table "de_db"."public"."fct_green_test__dbt_tmp" rename to "fct_green_test"
[0m15:31:39.152719 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m15:31:39.160700 [debug] [Thread-3 (]: On model.my_dbt.fct_green_test: COMMIT
[0m15:31:39.162286 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m15:31:39.163091 [debug] [Thread-3 (]: On model.my_dbt.fct_green_test: COMMIT
[0m15:31:39.223628 [debug] [Thread-3 (]: SQL status: COMMIT in 0.060 seconds
[0m15:31:39.229851 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."fct_green_test__dbt_backup"
[0m15:31:39.232039 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_green_test"
[0m15:31:39.232563 [debug] [Thread-3 (]: On model.my_dbt.fct_green_test: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_green_test"} */
drop table if exists "de_db"."public"."fct_green_test__dbt_backup" cascade
[0m15:31:39.268311 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.035 seconds
[0m15:31:39.272313 [debug] [Thread-3 (]: On model.my_dbt.fct_green_test: Close
[0m15:31:39.276320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC67DA990>]}
[0m15:31:39.281321 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public.fct_green_test ....................... [[32mSELECT 48326[0m in 0.45s]
[0m15:31:39.294220 [debug] [Thread-3 (]: Finished running node model.my_dbt.fct_green_test
[0m15:31:52.386944 [debug] [Thread-4 (]: SQL status: SELECT 3475226 in 14.210 seconds
[0m15:31:52.390613 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:31:52.391127 [debug] [Thread-4 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata" rename to "stg_yellow_tripdata__dbt_backup"
[0m15:31:52.393203 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:52.396284 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:31:52.396284 [debug] [Thread-4 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
alter table "de_db"."public"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m15:31:52.398343 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:52.399887 [debug] [Thread-4 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m15:31:52.400401 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:31:52.400916 [debug] [Thread-4 (]: On model.my_dbt.stg_yellow_tripdata: COMMIT
[0m15:31:52.465432 [debug] [Thread-4 (]: SQL status: COMMIT in 0.063 seconds
[0m15:31:52.470954 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."stg_yellow_tripdata__dbt_backup"
[0m15:31:52.476954 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.stg_yellow_tripdata"
[0m15:31:52.480956 [debug] [Thread-4 (]: On model.my_dbt.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.stg_yellow_tripdata"} */
drop table if exists "de_db"."public"."stg_yellow_tripdata__dbt_backup" cascade
[0m15:31:52.496205 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:31:52.497206 [debug] [Thread-4 (]: On model.my_dbt.stg_yellow_tripdata: Close
[0m15:31:52.498206 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC6295690>]}
[0m15:31:52.499207 [info ] [Thread-4 (]: 4 of 10 OK created sql table model public.stg_yellow_tripdata .................. [[32mSELECT 3475226[0m in 14.46s]
[0m15:31:52.500206 [debug] [Thread-4 (]: Finished running node model.my_dbt.stg_yellow_tripdata
[0m15:31:52.500206 [debug] [Thread-2 (]: Began running node model.my_dbt.fct_yellow_trips
[0m15:31:52.501206 [info ] [Thread-2 (]: 7 of 10 START sql table model public.fct_yellow_trips .......................... [RUN]
[0m15:31:52.502208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_green_test, now model.my_dbt.fct_yellow_trips)
[0m15:31:52.506219 [debug] [Thread-2 (]: Began compiling node model.my_dbt.fct_yellow_trips
[0m15:31:52.523391 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips"
[0m15:31:52.524427 [debug] [Thread-2 (]: Began executing node model.my_dbt.fct_yellow_trips
[0m15:31:52.528560 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips"
[0m15:31:52.529584 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:31:52.530099 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_yellow_trips.sql

with trips as (
    select *
    from "de_db"."public"."stg_yellow_tripdata"
),

final as (
    select
        vendor_id,
        pickup_datetime,
        dropoff_datetime,
        passenger_count,
        trip_distance,
        ratecode_id,
        store_and_fwd_flag,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee,
        total_amount,

        -- derived metrics
        date_trunc('day', pickup_datetime)::date as pickup_date,
        extract(hour from pickup_datetime)::int as pickup_hour,
        greatest(
          extract(epoch from (dropoff_datetime - pickup_datetime)) / 60.0,
          0
        ) as trip_duration_min
    from trips
)

select * from final
  );
  
[0m15:31:52.530613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:36.008933 [debug] [Thread-2 (]: SQL status: SELECT 3475226 in 43.478 seconds
[0m15:32:36.013922 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:32:36.013922 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips" rename to "fct_yellow_trips__dbt_backup"
[0m15:32:36.016007 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:32:36.019175 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:32:36.020220 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
alter table "de_db"."public"."fct_yellow_trips__dbt_tmp" rename to "fct_yellow_trips"
[0m15:32:36.024013 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:32:36.036019 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m15:32:36.040088 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:32:36.043621 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: COMMIT
[0m15:32:36.190832 [debug] [Thread-2 (]: SQL status: COMMIT in 0.146 seconds
[0m15:32:36.205844 [debug] [Thread-2 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips__dbt_backup"
[0m15:32:36.212672 [debug] [Thread-2 (]: Using postgres connection "model.my_dbt.fct_yellow_trips"
[0m15:32:36.215273 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips"} */
drop table if exists "de_db"."public"."fct_yellow_trips__dbt_backup" cascade
[0m15:32:36.250571 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.034 seconds
[0m15:32:36.252113 [debug] [Thread-2 (]: On model.my_dbt.fct_yellow_trips: Close
[0m15:32:36.252625 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC61F5C90>]}
[0m15:32:36.253729 [info ] [Thread-2 (]: 7 of 10 OK created sql table model public.fct_yellow_trips ..................... [[32mSELECT 3475226[0m in 43.75s]
[0m15:32:36.254764 [debug] [Thread-2 (]: Finished running node model.my_dbt.fct_yellow_trips
[0m15:32:36.255795 [debug] [Thread-3 (]: Began running node model.my_dbt.fct_yellow_trips_enriched
[0m15:32:36.256305 [debug] [Thread-4 (]: Began running node model.my_dbt.mart_daily_revenue
[0m15:32:36.256312 [debug] [Thread-1 (]: Began running node model.my_dbt.mart_payment_type
[0m15:32:36.256826 [info ] [Thread-3 (]: 8 of 10 START sql table model public.fct_yellow_trips_enriched ................. [RUN]
[0m15:32:36.257849 [info ] [Thread-4 (]: 9 of 10 START sql table model public.mart_daily_revenue ........................ [RUN]
[0m15:32:36.258365 [info ] [Thread-1 (]: 10 of 10 START sql table model public.mart_payment_type ........................ [RUN]
[0m15:32:36.258886 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.my_dbt.fct_green_test, now model.my_dbt.fct_yellow_trips_enriched)
[0m15:32:36.259925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.my_dbt.stg_yellow_tripdata, now model.my_dbt.mart_daily_revenue)
[0m15:32:36.280124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt.dim_taxi_zones, now model.my_dbt.mart_payment_type)
[0m15:32:36.281124 [debug] [Thread-3 (]: Began compiling node model.my_dbt.fct_yellow_trips_enriched
[0m15:32:36.282125 [debug] [Thread-4 (]: Began compiling node model.my_dbt.mart_daily_revenue
[0m15:32:36.282125 [debug] [Thread-1 (]: Began compiling node model.my_dbt.mart_payment_type
[0m15:32:36.285125 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_dbt.fct_yellow_trips_enriched"
[0m15:32:36.288123 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_dbt.mart_daily_revenue"
[0m15:32:36.292124 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.mart_payment_type"
[0m15:32:36.294124 [debug] [Thread-3 (]: Began executing node model.my_dbt.fct_yellow_trips_enriched
[0m15:32:36.319364 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_dbt.fct_yellow_trips_enriched"
[0m15:32:36.320368 [debug] [Thread-4 (]: Began executing node model.my_dbt.mart_daily_revenue
[0m15:32:36.320368 [debug] [Thread-1 (]: Began executing node model.my_dbt.mart_payment_type
[0m15:32:36.325776 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_dbt.mart_daily_revenue"
[0m15:32:36.336068 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.mart_payment_type"
[0m15:32:36.350884 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:32:36.352884 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:32:36.353885 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */

  
    

  create  table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp"
  
  
    as
  
  (
    with trips as (
    select *
    from "de_db"."public"."fct_yellow_trips"
),

zones as (
    select *
    from "de_db"."public"."dim_taxi_zones"
),

final as (
    select
        t.*,

        pu.borough as pu_borough,
        pu.zone as pu_zone,
        pu.service_zone as pu_service_zone,

        dz_do.borough as do_borough,
        dz_do.zone as do_zone,
        dz_do.service_zone as do_service_zone

    from trips t
    left join zones pu
        on t.pu_location_id = pu.location_id
    left join zones dz_do
        on t.do_location_id = dz_do.location_id
)

select * from final
  );
  
[0m15:32:36.353885 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:32:36.354885 [debug] [Thread-4 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */

  
    

  create  table "de_db"."public"."mart_daily_revenue__dbt_tmp"
  
  
    as
  
  (
    select
    pickup_date,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(total_amount) as avg_total_amount,
    avg(trip_distance) as avg_trip_distance,
    avg(trip_duration_min) as avg_trip_duration_min
from "de_db"."public"."fct_yellow_trips"
group by 1
order by 1
  );
  
[0m15:32:36.354885 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:36.355885 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */

  
    

  create  table "de_db"."public"."mart_payment_type__dbt_tmp"
  
  
    as
  
  (
    select
    payment_type,
    count(*) as trip_count,
    sum(total_amount) as total_revenue,
    avg(tip_amount) as avg_tip_amount
from "de_db"."public"."fct_yellow_trips"
group by 1
order by trip_count desc
  );
  
[0m15:32:36.355885 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:36.356883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:39.514031 [debug] [Thread-1 (]: SQL status: SELECT 6 in 3.157 seconds
[0m15:32:39.530639 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:32:39.534644 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type" rename to "mart_payment_type__dbt_backup"
[0m15:32:39.572842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m15:32:39.573906 [debug] [Thread-4 (]: SQL status: SELECT 33 in 3.217 seconds
[0m15:32:39.582631 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:32:39.604739 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:32:39.607733 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
alter table "de_db"."public"."mart_payment_type__dbt_tmp" rename to "mart_payment_type"
[0m15:32:39.612744 [debug] [Thread-4 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue" rename to "mart_daily_revenue__dbt_backup"
[0m15:32:39.644757 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m15:32:39.646748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m15:32:39.663023 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:32:39.671875 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m15:32:39.673879 [debug] [Thread-4 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
alter table "de_db"."public"."mart_daily_revenue__dbt_tmp" rename to "mart_daily_revenue"
[0m15:32:39.678969 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:32:39.681958 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: COMMIT
[0m15:32:39.689318 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:32:39.698326 [debug] [Thread-4 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m15:32:39.703322 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:32:39.713328 [debug] [Thread-4 (]: On model.my_dbt.mart_daily_revenue: COMMIT
[0m15:32:39.752585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.069 seconds
[0m15:32:39.766290 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."mart_payment_type__dbt_backup"
[0m15:32:39.771285 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.mart_payment_type"
[0m15:32:39.774302 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_payment_type"} */
drop table if exists "de_db"."public"."mart_payment_type__dbt_backup" cascade
[0m15:32:39.782258 [debug] [Thread-4 (]: SQL status: COMMIT in 0.063 seconds
[0m15:32:39.788426 [debug] [Thread-4 (]: Applying DROP to: "de_db"."public"."mart_daily_revenue__dbt_backup"
[0m15:32:39.793429 [debug] [Thread-4 (]: Using postgres connection "model.my_dbt.mart_daily_revenue"
[0m15:32:39.797426 [debug] [Thread-4 (]: On model.my_dbt.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.mart_daily_revenue"} */
drop table if exists "de_db"."public"."mart_daily_revenue__dbt_backup" cascade
[0m15:32:39.822725 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.045 seconds
[0m15:32:39.829716 [debug] [Thread-1 (]: On model.my_dbt.mart_payment_type: Close
[0m15:32:39.835249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC67EB310>]}
[0m15:32:39.840251 [info ] [Thread-1 (]: 10 of 10 OK created sql table model public.mart_payment_type ................... [[32mSELECT 6[0m in 3.55s]
[0m15:32:39.851185 [debug] [Thread-1 (]: Finished running node model.my_dbt.mart_payment_type
[0m15:32:39.889670 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.089 seconds
[0m15:32:39.900237 [debug] [Thread-4 (]: On model.my_dbt.mart_daily_revenue: Close
[0m15:32:39.905712 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC63F0F50>]}
[0m15:32:39.912710 [info ] [Thread-4 (]: 9 of 10 OK created sql table model public.mart_daily_revenue ................... [[32mSELECT 33[0m in 3.64s]
[0m15:32:39.925719 [debug] [Thread-4 (]: Finished running node model.my_dbt.mart_daily_revenue
[0m15:34:12.374451 [debug] [Thread-3 (]: SQL status: SELECT 3475226 in 96.019 seconds
[0m15:34:12.379250 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:34:12.379938 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched" rename to "fct_yellow_trips_enriched__dbt_backup"
[0m15:34:12.381296 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:12.384143 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:34:12.384143 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
alter table "de_db"."public"."fct_yellow_trips_enriched__dbt_tmp" rename to "fct_yellow_trips_enriched"
[0m15:34:12.385803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:12.386803 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m15:34:12.387829 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:34:12.387829 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips_enriched: COMMIT
[0m15:34:12.485608 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m15:34:12.488363 [debug] [Thread-3 (]: Applying DROP to: "de_db"."public"."fct_yellow_trips_enriched__dbt_backup"
[0m15:34:12.489453 [debug] [Thread-3 (]: Using postgres connection "model.my_dbt.fct_yellow_trips_enriched"
[0m15:34:12.489994 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.fct_yellow_trips_enriched"} */
drop table if exists "de_db"."public"."fct_yellow_trips_enriched__dbt_backup" cascade
[0m15:34:12.495060 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:34:12.496349 [debug] [Thread-3 (]: On model.my_dbt.fct_yellow_trips_enriched: Close
[0m15:34:12.497439 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb007f3-e257-49ef-8195-435bc54a2074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC67BE910>]}
[0m15:34:12.498012 [info ] [Thread-3 (]: 8 of 10 OK created sql table model public.fct_yellow_trips_enriched ............ [[32mSELECT 3475226[0m in 96.24s]
[0m15:34:12.499076 [debug] [Thread-3 (]: Finished running node model.my_dbt.fct_yellow_trips_enriched
[0m15:34:12.500075 [debug] [MainThread]: On master: COMMIT
[0m15:34:12.500075 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:12.501076 [debug] [MainThread]: On master: COMMIT
[0m15:34:12.501076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:34:12.529690 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m15:34:12.530763 [debug] [MainThread]: On master: Close
[0m15:34:12.531276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:12.531821 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m15:34:12.532340 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m15:34:12.533058 [debug] [MainThread]: Connection 'model.my_dbt.mart_payment_type' was properly closed.
[0m15:34:12.533581 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips' was properly closed.
[0m15:34:12.534208 [debug] [MainThread]: Connection 'model.my_dbt.fct_yellow_trips_enriched' was properly closed.
[0m15:34:12.534763 [debug] [MainThread]: Connection 'model.my_dbt.mart_daily_revenue' was properly closed.
[0m15:34:12.535316 [info ] [MainThread]: 
[0m15:34:12.536275 [info ] [MainThread]: Finished running 10 table models in 0 hours 2 minutes and 35.01 seconds (155.01s).
[0m15:34:12.539060 [debug] [MainThread]: Command end result
[0m15:34:12.562093 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:34:12.565123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:34:12.573094 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:34:12.573094 [info ] [MainThread]: 
[0m15:34:12.574093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:12.575093 [info ] [MainThread]: 
[0m15:34:12.575093 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m15:34:12.576753 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:12.576753 after 156.96 seconds
[0m15:34:12.577752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC47F4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABD9B8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABDCF38D0>]}
[0m15:34:12.577752 [debug] [MainThread]: Flushing usage events
[0m15:34:12.907255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:17.216515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEF3AA690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEF3A3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEF3A31D0>]}


============================== 15:55:17.221063 | 2df43a24-0353-47e1-924a-00ff73741b4c ==============================
[0m15:55:17.221063 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:55:17.222516 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run --select 01_rolling_avg_zone', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m15:55:17.395510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2df43a24-0353-47e1-924a-00ff73741b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEF4EF750>]}
[0m15:55:17.450362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2df43a24-0353-47e1-924a-00ff73741b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EEBC083D0>]}
[0m15:55:17.451364 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:55:17.690314 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:55:17.823441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:17.823441 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:55:17.823441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:17.872719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2df43a24-0353-47e1-924a-00ff73741b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF095D490>]}
[0m15:55:17.950737 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:55:17.953711 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:55:17.977863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2df43a24-0353-47e1-924a-00ff73741b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF0B9FF50>]}
[0m15:55:17.978863 [info ] [MainThread]: Found 11 models, 5 data tests, 3 sources, 464 macros
[0m15:55:17.979863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2df43a24-0353-47e1-924a-00ff73741b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EF0ABD910>]}
[0m15:55:17.979863 [warn ] [MainThread]: The selection criterion '01_rolling_avg_zone' does not match any enabled nodes
[0m15:55:17.981867 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:55:17.983888 [debug] [MainThread]: Command end result
[0m15:55:18.070573 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m15:55:18.071220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m15:55:18.075589 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m15:55:18.076695 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:18.076695 after 0.93 seconds
[0m15:55:18.076695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EE8931AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EE8930950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EE8931B50>]}
[0m15:55:18.076695 [debug] [MainThread]: Flushing usage events
[0m15:55:18.406576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:34.927327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121757EABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001217583B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001217583B190>]}


============================== 16:00:34.932329 | 842b1c3d-0cf8-456e-9b84-1d4cc7ef3eab ==============================
[0m16:00:34.932329 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:00:34.933328 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select 01_rolling_avg_zone', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m16:00:35.110609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842b1c3d-0cf8-456e-9b84-1d4cc7ef3eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012176977FD0>]}
[0m16:00:35.158603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '842b1c3d-0cf8-456e-9b84-1d4cc7ef3eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012172038190>]}
[0m16:00:35.168687 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:00:35.396719 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:00:35.520275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:00:35.520275 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\01_rolling_avg_zone.sql
[0m16:00:35.744225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '842b1c3d-0cf8-456e-9b84-1d4cc7ef3eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012176F72F10>]}
[0m16:00:35.855991 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:00:35.866141 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:00:35.886855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '842b1c3d-0cf8-456e-9b84-1d4cc7ef3eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121769D4210>]}
[0m16:00:35.886855 [info ] [MainThread]: Found 12 models, 5 data tests, 3 sources, 464 macros
[0m16:00:35.886855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '842b1c3d-0cf8-456e-9b84-1d4cc7ef3eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012176C95210>]}
[0m16:00:35.886855 [info ] [MainThread]: 
[0m16:00:35.886855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:35.886855 [info ] [MainThread]: 
[0m16:00:35.886855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:35.886855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m16:00:35.948066 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m16:00:35.957606 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m16:00:35.957606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:35.973216 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m16:00:35.973216 [debug] [ThreadPool]: On list_de_db: Close
[0m16:00:35.979296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m16:00:35.984111 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m16:00:35.984652 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:00:35.984652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:36.032544 [debug] [ThreadPool]: SQL status: SELECT 58 in 0.048 seconds
[0m16:00:36.034967 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m16:00:36.036108 [debug] [ThreadPool]: On list_de_db_public: Close
[0m16:00:36.042877 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:36.042877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:00:36.042877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:36.084140 [debug] [MainThread]: SQL status: SELECT 0 in 0.036 seconds
[0m16:00:36.084714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '842b1c3d-0cf8-456e-9b84-1d4cc7ef3eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012176C2D610>]}
[0m16:00:36.085811 [debug] [MainThread]: On master: ROLLBACK
[0m16:00:36.087370 [debug] [MainThread]: On master: COMMIT
[0m16:00:36.087370 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:36.087370 [debug] [MainThread]: On master: COMMIT
[0m16:00:36.087370 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:00:36.090405 [debug] [MainThread]: On master: Close
[0m16:00:36.091864 [debug] [Thread-1 (]: Began running node model.my_dbt.01_rolling_avg_zone
[0m16:00:36.091864 [info ] [Thread-1 (]: 1 of 1 START sql view model public.01_rolling_avg_zone ......................... [RUN]
[0m16:00:36.095981 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.01_rolling_avg_zone'
[0m16:00:36.095981 [debug] [Thread-1 (]: Began compiling node model.my_dbt.01_rolling_avg_zone
[0m16:00:36.102091 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.01_rolling_avg_zone"
[0m16:00:36.102091 [debug] [Thread-1 (]: Began executing node model.my_dbt.01_rolling_avg_zone
[0m16:00:36.122313 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.01_rolling_avg_zone"
[0m16:00:36.132089 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.01_rolling_avg_zone"
[0m16:00:36.132610 [debug] [Thread-1 (]: On model.my_dbt.01_rolling_avg_zone: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.01_rolling_avg_zone"} */

  create view "de_db"."public"."01_rolling_avg_zone__dbt_tmp"
    
    
  as (
    

with daily as (
  select
    pu_location_id,
    date(pickup_datetime) as pickup_date,
    sum(total_amount) as total_revenue
  from public.fct_yellow_trips_enriched
  group by 1,2
)

select
  pu_location_id,
  pickup_date,
  total_revenue,
  avg(total_revenue) over (
    partition by pu_location_id
    order by pickup_date
    rows between 6 preceding and current row
  ) as rolling_7d_avg_revenue
from daily
  );
[0m16:00:36.133126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:00:36.165205 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m16:00:36.170913 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.01_rolling_avg_zone"
[0m16:00:36.171469 [debug] [Thread-1 (]: On model.my_dbt.01_rolling_avg_zone: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.01_rolling_avg_zone"} */
alter table "de_db"."public"."01_rolling_avg_zone__dbt_tmp" rename to "01_rolling_avg_zone"
[0m16:00:36.173193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:00:36.185185 [debug] [Thread-1 (]: On model.my_dbt.01_rolling_avg_zone: COMMIT
[0m16:00:36.185185 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.01_rolling_avg_zone"
[0m16:00:36.185185 [debug] [Thread-1 (]: On model.my_dbt.01_rolling_avg_zone: COMMIT
[0m16:00:36.185185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:00:36.191360 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."01_rolling_avg_zone__dbt_backup"
[0m16:00:36.196478 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.01_rolling_avg_zone"
[0m16:00:36.196478 [debug] [Thread-1 (]: On model.my_dbt.01_rolling_avg_zone: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.01_rolling_avg_zone"} */
drop view if exists "de_db"."public"."01_rolling_avg_zone__dbt_backup" cascade
[0m16:00:36.202441 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:00:36.202973 [debug] [Thread-1 (]: On model.my_dbt.01_rolling_avg_zone: Close
[0m16:00:36.205655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '842b1c3d-0cf8-456e-9b84-1d4cc7ef3eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001217744B190>]}
[0m16:00:36.207308 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.01_rolling_avg_zone .................... [[32mCREATE VIEW[0m in 0.11s]
[0m16:00:36.208099 [debug] [Thread-1 (]: Finished running node model.my_dbt.01_rolling_avg_zone
[0m16:00:36.209461 [debug] [MainThread]: On master: COMMIT
[0m16:00:36.209995 [debug] [MainThread]: Using postgres connection "master"
[0m16:00:36.210303 [debug] [MainThread]: On master: COMMIT
[0m16:00:36.210303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:36.232757 [debug] [MainThread]: SQL status: COMMIT in 0.022 seconds
[0m16:00:36.233353 [debug] [MainThread]: On master: Close
[0m16:00:36.233945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:36.234551 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m16:00:36.234551 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m16:00:36.234551 [debug] [MainThread]: Connection 'model.my_dbt.01_rolling_avg_zone' was properly closed.
[0m16:00:36.235516 [info ] [MainThread]: 
[0m16:00:36.235516 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m16:00:36.236517 [debug] [MainThread]: Command end result
[0m16:00:36.258058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:00:36.258058 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:00:36.258058 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m16:00:36.258058 [info ] [MainThread]: 
[0m16:00:36.258058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:36.258058 [info ] [MainThread]: 
[0m16:00:36.258058 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:00:36.268671 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:36.268671 after 1.41 seconds
[0m16:00:36.268671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001216E9E8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001216EAA3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001216ED06810>]}
[0m16:00:36.268671 [debug] [MainThread]: Flushing usage events
[0m16:00:36.606074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:17.874179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D1269E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D12BBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D12BAAD0>]}


============================== 16:08:17.877875 | cb7ba320-d24c-42b5-a2a6-b5f979f935d0 ==============================
[0m16:08:17.877875 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:08:17.878684 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'invocation_command': 'dbt run --select 02_driver_ranking_by_total_revenue_zone', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m16:08:18.044347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb7ba320-d24c-42b5-a2a6-b5f979f935d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D12C4650>]}
[0m16:08:18.100626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb7ba320-d24c-42b5-a2a6-b5f979f935d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CDAB8110>]}
[0m16:08:18.102229 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:08:18.322379 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:08:18.466203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:08:18.466203 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\02_driver_ranking_by_total_revenue_zone.sql
[0m16:08:18.691634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb7ba320-d24c-42b5-a2a6-b5f979f935d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D24F5E90>]}
[0m16:08:18.823157 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:08:18.826156 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:08:18.855955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb7ba320-d24c-42b5-a2a6-b5f979f935d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D2AE9F10>]}
[0m16:08:18.856489 [info ] [MainThread]: Found 13 models, 5 data tests, 3 sources, 464 macros
[0m16:08:18.857043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb7ba320-d24c-42b5-a2a6-b5f979f935d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CD1FCC10>]}
[0m16:08:18.858639 [info ] [MainThread]: 
[0m16:08:18.859186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:18.859717 [info ] [MainThread]: 
[0m16:08:18.860228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:08:18.861837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m16:08:18.923549 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m16:08:18.924548 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m16:08:18.924548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:18.940459 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m16:08:18.941459 [debug] [ThreadPool]: On list_de_db: Close
[0m16:08:18.946535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m16:08:18.952018 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m16:08:18.952445 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:08:18.952445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:18.980571 [debug] [ThreadPool]: SQL status: SELECT 59 in 0.028 seconds
[0m16:08:18.982736 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m16:08:18.984112 [debug] [ThreadPool]: On list_de_db_public: Close
[0m16:08:18.995589 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:18.996147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:08:18.996658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:19.030544 [debug] [MainThread]: SQL status: SELECT 1 in 0.034 seconds
[0m16:08:19.032262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb7ba320-d24c-42b5-a2a6-b5f979f935d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D2894810>]}
[0m16:08:19.032262 [debug] [MainThread]: On master: ROLLBACK
[0m16:08:19.034162 [debug] [MainThread]: On master: COMMIT
[0m16:08:19.034162 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:19.034858 [debug] [MainThread]: On master: COMMIT
[0m16:08:19.037023 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:08:19.037023 [debug] [MainThread]: On master: Close
[0m16:08:19.041835 [debug] [Thread-1 (]: Began running node model.my_dbt.02_driver_ranking_by_total_revenue_zone
[0m16:08:19.041835 [info ] [Thread-1 (]: 1 of 1 START sql view model public.02_driver_ranking_by_total_revenue_zone ..... [RUN]
[0m16:08:19.044080 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.02_driver_ranking_by_total_revenue_zone'
[0m16:08:19.044080 [debug] [Thread-1 (]: Began compiling node model.my_dbt.02_driver_ranking_by_total_revenue_zone
[0m16:08:19.050721 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:08:19.051751 [debug] [Thread-1 (]: Began executing node model.my_dbt.02_driver_ranking_by_total_revenue_zone
[0m16:08:19.079201 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:08:19.079739 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:08:19.080738 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.02_driver_ranking_by_total_revenue_zone"} */

  create view "de_db"."public"."02_driver_ranking_by_total_revenue_zone__dbt_tmp"
    
    
  as (
    

with agg as (
  select
    pu_location_id as zone_id,
    vendor_id,
    sum(total_amount) as total_revenue
  from "de_db"."public"."stg_yellow_tripdata"
  group by 1, 2
)

select
  zone_id,
  vendor_id,
  total_revenue,
  dense_rank() over (
    partition by zone_id
    order by total_revenue desc
  ) as revenue_rank_in_zone
from agg;
  );
[0m16:08:19.080738 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:19.106231 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: from agg;
                 ^

[0m16:08:19.106460 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: ROLLBACK
[0m16:08:19.108117 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: Close
[0m16:08:19.112298 [debug] [Thread-1 (]: Database Error in model 02_driver_ranking_by_total_revenue_zone (models\marts\02_driver_ranking_by_total_revenue_zone.sql)
  syntax error at or near ";"
  LINE 26: from agg;
                   ^
  compiled code at target\run\my_dbt\models\marts\02_driver_ranking_by_total_revenue_zone.sql
[0m16:08:19.114331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb7ba320-d24c-42b5-a2a6-b5f979f935d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFD22110>]}
[0m16:08:19.115370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.02_driver_ranking_by_total_revenue_zone  [[31mERROR[0m in 0.07s]
[0m16:08:19.115880 [debug] [Thread-1 (]: Finished running node model.my_dbt.02_driver_ranking_by_total_revenue_zone
[0m16:08:19.116907 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.02_driver_ranking_by_total_revenue_zone' to be skipped because of status 'error'.  Reason: Database Error in model 02_driver_ranking_by_total_revenue_zone (models\marts\02_driver_ranking_by_total_revenue_zone.sql)
  syntax error at or near ";"
  LINE 26: from agg;
                   ^
  compiled code at target\run\my_dbt\models\marts\02_driver_ranking_by_total_revenue_zone.sql.
[0m16:08:19.117883 [debug] [MainThread]: On master: COMMIT
[0m16:08:19.118908 [debug] [MainThread]: Using postgres connection "master"
[0m16:08:19.118908 [debug] [MainThread]: On master: COMMIT
[0m16:08:19.118908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:19.154087 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m16:08:19.154597 [debug] [MainThread]: On master: Close
[0m16:08:19.155154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:19.155681 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m16:08:19.156119 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m16:08:19.156691 [debug] [MainThread]: Connection 'model.my_dbt.02_driver_ranking_by_total_revenue_zone' was properly closed.
[0m16:08:19.156861 [info ] [MainThread]: 
[0m16:08:19.157773 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m16:08:19.158802 [debug] [MainThread]: Command end result
[0m16:08:19.180487 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:08:19.182496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:08:19.188225 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m16:08:19.188225 [info ] [MainThread]: 
[0m16:08:19.189442 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:08:19.190091 [info ] [MainThread]: 
[0m16:08:19.191091 [error] [MainThread]: [31mFailure in model 02_driver_ranking_by_total_revenue_zone (models\marts\02_driver_ranking_by_total_revenue_zone.sql)[0m
[0m16:08:19.191091 [error] [MainThread]:   Database Error in model 02_driver_ranking_by_total_revenue_zone (models\marts\02_driver_ranking_by_total_revenue_zone.sql)
  syntax error at or near ";"
  LINE 26: from agg;
                   ^
  compiled code at target\run\my_dbt\models\marts\02_driver_ranking_by_total_revenue_zone.sql
[0m16:08:19.192090 [info ] [MainThread]: 
[0m16:08:19.192090 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\02_driver_ranking_by_total_revenue_zone.sql
[0m16:08:19.193091 [info ] [MainThread]: 
[0m16:08:19.193091 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:08:19.194118 [debug] [MainThread]: Command `dbt run` failed at 16:08:19.194118 after 1.38 seconds
[0m16:08:19.195482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D24B9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CA4F3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CA7BDE90>]}
[0m16:08:19.195510 [debug] [MainThread]: Flushing usage events
[0m16:08:19.549018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:59.693040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA82B9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA5201850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA82DA410>]}


============================== 16:08:59.697041 | ede3bbf9-002c-42e2-b754-a15e60421c43 ==============================
[0m16:08:59.697041 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:08:59.697983 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select 02_driver_ranking_by_total_revenue_zone', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m16:08:59.874008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ede3bbf9-002c-42e2-b754-a15e60421c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA83156D0>]}
[0m16:08:59.934637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ede3bbf9-002c-42e2-b754-a15e60421c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA4B18150>]}
[0m16:08:59.936543 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:09:00.167398 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:09:00.312325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:00.313323 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\02_driver_ranking_by_total_revenue_zone.sql
[0m16:09:00.542541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ede3bbf9-002c-42e2-b754-a15e60421c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA9B0F750>]}
[0m16:09:00.661697 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:09:00.664724 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:09:00.687766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ede3bbf9-002c-42e2-b754-a15e60421c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA9A0B410>]}
[0m16:09:00.688795 [info ] [MainThread]: Found 13 models, 5 data tests, 3 sources, 464 macros
[0m16:09:00.689316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ede3bbf9-002c-42e2-b754-a15e60421c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA9970150>]}
[0m16:09:00.690680 [info ] [MainThread]: 
[0m16:09:00.690680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:00.691697 [info ] [MainThread]: 
[0m16:09:00.692695 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:00.693707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m16:09:00.756664 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m16:09:00.757686 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m16:09:00.757686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:00.774796 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m16:09:00.775804 [debug] [ThreadPool]: On list_de_db: Close
[0m16:09:00.780851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m16:09:00.786043 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m16:09:00.786612 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:09:00.786612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:00.813787 [debug] [ThreadPool]: SQL status: SELECT 59 in 0.027 seconds
[0m16:09:00.815813 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m16:09:00.817517 [debug] [ThreadPool]: On list_de_db_public: Close
[0m16:09:00.828507 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:00.829537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:09:00.829537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:00.857616 [debug] [MainThread]: SQL status: SELECT 1 in 0.028 seconds
[0m16:09:00.858642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ede3bbf9-002c-42e2-b754-a15e60421c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA83E2790>]}
[0m16:09:00.859641 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:00.861377 [debug] [MainThread]: On master: COMMIT
[0m16:09:00.861799 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:00.861799 [debug] [MainThread]: On master: COMMIT
[0m16:09:00.864252 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:09:00.864252 [debug] [MainThread]: On master: Close
[0m16:09:00.868069 [debug] [Thread-1 (]: Began running node model.my_dbt.02_driver_ranking_by_total_revenue_zone
[0m16:09:00.869068 [info ] [Thread-1 (]: 1 of 1 START sql view model public.02_driver_ranking_by_total_revenue_zone ..... [RUN]
[0m16:09:00.871069 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.02_driver_ranking_by_total_revenue_zone'
[0m16:09:00.871069 [debug] [Thread-1 (]: Began compiling node model.my_dbt.02_driver_ranking_by_total_revenue_zone
[0m16:09:00.877629 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:09:00.878627 [debug] [Thread-1 (]: Began executing node model.my_dbt.02_driver_ranking_by_total_revenue_zone
[0m16:09:00.908654 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:09:00.909711 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:09:00.909711 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.02_driver_ranking_by_total_revenue_zone"} */

  create view "de_db"."public"."02_driver_ranking_by_total_revenue_zone__dbt_tmp"
    
    
  as (
    

with agg as (
  select
    pu_location_id as zone_id,
    vendor_id,
    sum(total_amount) as total_revenue
  from "de_db"."public"."stg_yellow_tripdata"
  group by 1, 2
)

select
  zone_id,
  vendor_id,
  total_revenue,
  dense_rank() over (
    partition by zone_id
    order by total_revenue desc
  ) as revenue_rank_in_zone
from agg
  );
[0m16:09:00.910710 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:00.941521 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m16:09:00.947187 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:09:00.947187 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.02_driver_ranking_by_total_revenue_zone"} */
alter table "de_db"."public"."02_driver_ranking_by_total_revenue_zone__dbt_tmp" rename to "02_driver_ranking_by_total_revenue_zone"
[0m16:09:00.949187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:09:00.961132 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: COMMIT
[0m16:09:00.962276 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:09:00.962956 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: COMMIT
[0m16:09:00.968499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:09:00.975180 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."02_driver_ranking_by_total_revenue_zone__dbt_backup"
[0m16:09:00.979970 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.02_driver_ranking_by_total_revenue_zone"
[0m16:09:00.980497 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.02_driver_ranking_by_total_revenue_zone"} */
drop view if exists "de_db"."public"."02_driver_ranking_by_total_revenue_zone__dbt_backup" cascade
[0m16:09:00.982237 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:09:00.984412 [debug] [Thread-1 (]: On model.my_dbt.02_driver_ranking_by_total_revenue_zone: Close
[0m16:09:00.986577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ede3bbf9-002c-42e2-b754-a15e60421c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA9EB11D0>]}
[0m16:09:00.987118 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.02_driver_ranking_by_total_revenue_zone  [[32mCREATE VIEW[0m in 0.11s]
[0m16:09:00.988208 [debug] [Thread-1 (]: Finished running node model.my_dbt.02_driver_ranking_by_total_revenue_zone
[0m16:09:00.989653 [debug] [MainThread]: On master: COMMIT
[0m16:09:00.989653 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:00.990162 [debug] [MainThread]: On master: COMMIT
[0m16:09:00.990898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:01.016917 [debug] [MainThread]: SQL status: COMMIT in 0.026 seconds
[0m16:09:01.017148 [debug] [MainThread]: On master: Close
[0m16:09:01.017741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:01.018284 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m16:09:01.018284 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m16:09:01.018836 [debug] [MainThread]: Connection 'model.my_dbt.02_driver_ranking_by_total_revenue_zone' was properly closed.
[0m16:09:01.018836 [info ] [MainThread]: 
[0m16:09:01.019793 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m16:09:01.020818 [debug] [MainThread]: Command end result
[0m16:09:01.042773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:09:01.045377 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:09:01.050612 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m16:09:01.050612 [info ] [MainThread]: 
[0m16:09:01.051643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:01.051643 [info ] [MainThread]: 
[0m16:09:01.052650 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:09:01.053613 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:01.052650 after 1.43 seconds
[0m16:09:01.053613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA8316FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA1468C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA17EDE90>]}
[0m16:09:01.053613 [debug] [MainThread]: Flushing usage events
[0m16:09:01.347922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:55.775780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B32C3A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B32C8B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B32C32E10>]}


============================== 16:09:55.779236 | 8db4412c-1e65-404c-ae8c-3f9d5b1f6a6e ==============================
[0m16:09:55.779236 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:09:55.780261 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select 03_peak_hour_detection_by_location', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m16:09:55.945853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8db4412c-1e65-404c-ae8c-3f9d5b1f6a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B32C32E10>]}
[0m16:09:56.003610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8db4412c-1e65-404c-ae8c-3f9d5b1f6a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2F488110>]}
[0m16:09:56.004608 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:09:56.242396 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:09:56.380043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:09:56.381043 [debug] [MainThread]: Partial parsing: added file: my_dbt://models\marts\03_peak_hour_detection_by_location.sql
[0m16:09:56.608176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8db4412c-1e65-404c-ae8c-3f9d5b1f6a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B34343D50>]}
[0m16:09:56.728348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:09:56.731372 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:09:56.756008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8db4412c-1e65-404c-ae8c-3f9d5b1f6a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B344B8FD0>]}
[0m16:09:56.757010 [info ] [MainThread]: Found 14 models, 5 data tests, 3 sources, 464 macros
[0m16:09:56.758038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db4412c-1e65-404c-ae8c-3f9d5b1f6a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B33EBE110>]}
[0m16:09:56.759035 [info ] [MainThread]: 
[0m16:09:56.760060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:56.760060 [info ] [MainThread]: 
[0m16:09:56.761423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:56.762425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m16:09:56.824754 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m16:09:56.825762 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m16:09:56.825762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:56.841778 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m16:09:56.843775 [debug] [ThreadPool]: On list_de_db: Close
[0m16:09:56.848493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m16:09:56.853509 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m16:09:56.853509 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:09:56.854483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:56.880552 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.026 seconds
[0m16:09:56.882478 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m16:09:56.883878 [debug] [ThreadPool]: On list_de_db_public: Close
[0m16:09:56.895757 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:56.895757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:09:56.895757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:56.930618 [debug] [MainThread]: SQL status: SELECT 2 in 0.034 seconds
[0m16:09:56.931618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db4412c-1e65-404c-ae8c-3f9d5b1f6a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B34087090>]}
[0m16:09:56.932618 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:56.933618 [debug] [MainThread]: On master: COMMIT
[0m16:09:56.934617 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:56.934617 [debug] [MainThread]: On master: COMMIT
[0m16:09:56.936343 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:09:56.937259 [debug] [MainThread]: On master: Close
[0m16:09:56.941502 [debug] [Thread-1 (]: Began running node model.my_dbt.03_peak_hour_detection_by_location
[0m16:09:56.942535 [info ] [Thread-1 (]: 1 of 1 START sql view model public.03_peak_hour_detection_by_location .......... [RUN]
[0m16:09:56.943536 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.03_peak_hour_detection_by_location'
[0m16:09:56.943536 [debug] [Thread-1 (]: Began compiling node model.my_dbt.03_peak_hour_detection_by_location
[0m16:09:56.950271 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:09:56.951303 [debug] [Thread-1 (]: Began executing node model.my_dbt.03_peak_hour_detection_by_location
[0m16:09:56.979199 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:09:56.980199 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:09:56.980199 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.03_peak_hour_detection_by_location"} */

  create view "de_db"."public"."03_peak_hour_detection_by_location__dbt_tmp"
    
    
  as (
    

with hourly as (
  select
    pu_location_id as zone_id,
    extract(hour from pickup_ts)::int as pickup_hour,
    count(*) as trip_count
  from "de_db"."public"."stg_yellow_tripdata"
  group by 1, 2
),

ranked as (
  select
    *,
    row_number() over (
      partition by zone_id
      order by trip_count desc
    ) as rn
  from hourly
)

select
  zone_id,
  pickup_hour as peak_hour,
  trip_count as peak_hour_trip_count
from ranked
where rn = 1;
  );
[0m16:09:56.981174 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:57.006447 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 33: where rn = 1;
                     ^

[0m16:09:57.006447 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: ROLLBACK
[0m16:09:57.008403 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: Close
[0m16:09:57.013212 [debug] [Thread-1 (]: Database Error in model 03_peak_hour_detection_by_location (models\marts\03_peak_hour_detection_by_location.sql)
  syntax error at or near ";"
  LINE 33: where rn = 1;
                       ^
  compiled code at target\run\my_dbt\models\marts\03_peak_hour_detection_by_location.sql
[0m16:09:57.015210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8db4412c-1e65-404c-ae8c-3f9d5b1f6a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3481C110>]}
[0m16:09:57.016718 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.03_peak_hour_detection_by_location . [[31mERROR[0m in 0.07s]
[0m16:09:57.017662 [debug] [Thread-1 (]: Finished running node model.my_dbt.03_peak_hour_detection_by_location
[0m16:09:57.017662 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.03_peak_hour_detection_by_location' to be skipped because of status 'error'.  Reason: Database Error in model 03_peak_hour_detection_by_location (models\marts\03_peak_hour_detection_by_location.sql)
  syntax error at or near ";"
  LINE 33: where rn = 1;
                       ^
  compiled code at target\run\my_dbt\models\marts\03_peak_hour_detection_by_location.sql.
[0m16:09:57.019668 [debug] [MainThread]: On master: COMMIT
[0m16:09:57.019668 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:57.020695 [debug] [MainThread]: On master: COMMIT
[0m16:09:57.020695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:57.044735 [debug] [MainThread]: SQL status: COMMIT in 0.024 seconds
[0m16:09:57.045464 [debug] [MainThread]: On master: Close
[0m16:09:57.045885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:57.046421 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m16:09:57.046522 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m16:09:57.047108 [debug] [MainThread]: Connection 'model.my_dbt.03_peak_hour_detection_by_location' was properly closed.
[0m16:09:57.047725 [info ] [MainThread]: 
[0m16:09:57.048364 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m16:09:57.049251 [debug] [MainThread]: Command end result
[0m16:09:57.072729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:09:57.074326 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:09:57.079209 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m16:09:57.079209 [info ] [MainThread]: 
[0m16:09:57.080209 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:09:57.081209 [info ] [MainThread]: 
[0m16:09:57.081209 [error] [MainThread]: [31mFailure in model 03_peak_hour_detection_by_location (models\marts\03_peak_hour_detection_by_location.sql)[0m
[0m16:09:57.082184 [error] [MainThread]:   Database Error in model 03_peak_hour_detection_by_location (models\marts\03_peak_hour_detection_by_location.sql)
  syntax error at or near ";"
  LINE 33: where rn = 1;
                       ^
  compiled code at target\run\my_dbt\models\marts\03_peak_hour_detection_by_location.sql
[0m16:09:57.082184 [info ] [MainThread]: 
[0m16:09:57.083809 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\03_peak_hour_detection_by_location.sql
[0m16:09:57.084104 [info ] [MainThread]: 
[0m16:09:57.084104 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:09:57.085142 [debug] [MainThread]: Command `dbt run` failed at 16:09:57.085142 after 1.37 seconds
[0m16:09:57.086149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B32C3A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B32C3AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B32A38E50>]}
[0m16:09:57.086149 [debug] [MainThread]: Flushing usage events
[0m16:09:57.375184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:15.204479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E22DABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E22F9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E22FA990>]}


============================== 16:10:15.207972 | e2ed1dec-d7b4-49fa-8d26-57509d12846b ==============================
[0m16:10:15.207972 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:10:15.208972 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select 03_peak_hour_detection_by_location', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m16:10:15.375617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2ed1dec-d7b4-49fa-8d26-57509d12846b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E232AED0>]}
[0m16:10:15.429582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2ed1dec-d7b4-49fa-8d26-57509d12846b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222DEB282D0>]}
[0m16:10:15.431584 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:10:15.653027 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:10:15.789129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:10:15.789129 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\03_peak_hour_detection_by_location.sql
[0m16:10:16.019114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2ed1dec-d7b4-49fa-8d26-57509d12846b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E39E1050>]}
[0m16:10:16.145701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:10:16.147677 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:10:16.167941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2ed1dec-d7b4-49fa-8d26-57509d12846b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E38D9610>]}
[0m16:10:16.168941 [info ] [MainThread]: Found 14 models, 5 data tests, 3 sources, 464 macros
[0m16:10:16.169966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ed1dec-d7b4-49fa-8d26-57509d12846b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E3511C50>]}
[0m16:10:16.170967 [info ] [MainThread]: 
[0m16:10:16.171976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:16.172331 [info ] [MainThread]: 
[0m16:10:16.172671 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:16.173358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m16:10:16.236430 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m16:10:16.237431 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m16:10:16.237431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:16.253993 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m16:10:16.255846 [debug] [ThreadPool]: On list_de_db: Close
[0m16:10:16.260322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m16:10:16.265599 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m16:10:16.266149 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:10:16.266612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:16.290767 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.025 seconds
[0m16:10:16.292731 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m16:10:16.294779 [debug] [ThreadPool]: On list_de_db_public: Close
[0m16:10:16.305838 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:16.306865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:10:16.306865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:16.335372 [debug] [MainThread]: SQL status: SELECT 2 in 0.029 seconds
[0m16:10:16.337352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ed1dec-d7b4-49fa-8d26-57509d12846b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E3E35490>]}
[0m16:10:16.337948 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:16.339312 [debug] [MainThread]: On master: COMMIT
[0m16:10:16.339312 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:16.340350 [debug] [MainThread]: On master: COMMIT
[0m16:10:16.341884 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:10:16.341884 [debug] [MainThread]: On master: Close
[0m16:10:16.345884 [debug] [Thread-1 (]: Began running node model.my_dbt.03_peak_hour_detection_by_location
[0m16:10:16.347861 [info ] [Thread-1 (]: 1 of 1 START sql view model public.03_peak_hour_detection_by_location .......... [RUN]
[0m16:10:16.348862 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.03_peak_hour_detection_by_location'
[0m16:10:16.348862 [debug] [Thread-1 (]: Began compiling node model.my_dbt.03_peak_hour_detection_by_location
[0m16:10:16.355798 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:10:16.355798 [debug] [Thread-1 (]: Began executing node model.my_dbt.03_peak_hour_detection_by_location
[0m16:10:16.384737 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:10:16.385735 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:10:16.386736 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.03_peak_hour_detection_by_location"} */

  create view "de_db"."public"."03_peak_hour_detection_by_location__dbt_tmp"
    
    
  as (
    

with hourly as (
  select
    pu_location_id as zone_id,
    extract(hour from pickup_ts)::int as pickup_hour,
    count(*) as trip_count
  from "de_db"."public"."stg_yellow_tripdata"
  group by 1, 2
),

ranked as (
  select
    *,
    row_number() over (
      partition by zone_id
      order by trip_count desc
    ) as rn
  from hourly
)

select
  zone_id,
  pickup_hour as peak_hour,
  trip_count as peak_hour_trip_count
from ranked
where rn = 1
  );
[0m16:10:16.386736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:16.417116 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "pickup_ts" does not exist
LINE 12:     extract(hour from pickup_ts)::int as pickup_hour,
                               ^

[0m16:10:16.417637 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: ROLLBACK
[0m16:10:16.418627 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: Close
[0m16:10:16.422680 [debug] [Thread-1 (]: Database Error in model 03_peak_hour_detection_by_location (models\marts\03_peak_hour_detection_by_location.sql)
  column "pickup_ts" does not exist
  LINE 12:     extract(hour from pickup_ts)::int as pickup_hour,
                                 ^
  compiled code at target\run\my_dbt\models\marts\03_peak_hour_detection_by_location.sql
[0m16:10:16.424681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed1dec-d7b4-49fa-8d26-57509d12846b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E3D63910>]}
[0m16:10:16.425708 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.03_peak_hour_detection_by_location . [[31mERROR[0m in 0.07s]
[0m16:10:16.425708 [debug] [Thread-1 (]: Finished running node model.my_dbt.03_peak_hour_detection_by_location
[0m16:10:16.426714 [debug] [Thread-7 (]: Marking all children of 'model.my_dbt.03_peak_hour_detection_by_location' to be skipped because of status 'error'.  Reason: Database Error in model 03_peak_hour_detection_by_location (models\marts\03_peak_hour_detection_by_location.sql)
  column "pickup_ts" does not exist
  LINE 12:     extract(hour from pickup_ts)::int as pickup_hour,
                                 ^
  compiled code at target\run\my_dbt\models\marts\03_peak_hour_detection_by_location.sql.
[0m16:10:16.428052 [debug] [MainThread]: On master: COMMIT
[0m16:10:16.429080 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:16.429080 [debug] [MainThread]: On master: COMMIT
[0m16:10:16.429080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:16.460878 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m16:10:16.461394 [debug] [MainThread]: On master: Close
[0m16:10:16.462931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:16.462931 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m16:10:16.462931 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m16:10:16.463931 [debug] [MainThread]: Connection 'model.my_dbt.03_peak_hour_detection_by_location' was properly closed.
[0m16:10:16.463931 [info ] [MainThread]: 
[0m16:10:16.464959 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m16:10:16.464959 [debug] [MainThread]: Command end result
[0m16:10:16.488786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:10:16.490034 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:10:16.495913 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m16:10:16.495913 [info ] [MainThread]: 
[0m16:10:16.496884 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:10:16.496884 [info ] [MainThread]: 
[0m16:10:16.497918 [error] [MainThread]: [31mFailure in model 03_peak_hour_detection_by_location (models\marts\03_peak_hour_detection_by_location.sql)[0m
[0m16:10:16.498913 [error] [MainThread]:   Database Error in model 03_peak_hour_detection_by_location (models\marts\03_peak_hour_detection_by_location.sql)
  column "pickup_ts" does not exist
  LINE 12:     extract(hour from pickup_ts)::int as pickup_hour,
                                 ^
  compiled code at target\run\my_dbt\models\marts\03_peak_hour_detection_by_location.sql
[0m16:10:16.498913 [info ] [MainThread]: 
[0m16:10:16.500043 [info ] [MainThread]:   compiled code at target\compiled\my_dbt\models\marts\03_peak_hour_detection_by_location.sql
[0m16:10:16.500410 [info ] [MainThread]: 
[0m16:10:16.500884 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:10:16.502028 [debug] [MainThread]: Command `dbt run` failed at 16:10:16.502028 after 1.36 seconds
[0m16:10:16.502028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222DB4C8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222DB84DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222DB583650>]}
[0m16:10:16.502885 [debug] [MainThread]: Flushing usage events
[0m16:10:16.791204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:08.827980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBB8EA450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBB8EA190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBB8EA090>]}


============================== 16:11:08.831633 | 598284bf-bd24-486a-8b21-b5506d6feaac ==============================
[0m16:11:08.831633 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:11:08.833266 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jkimd\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select 03_peak_hour_detection_by_location', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jkimd\\gt\\Workspace\\airflow_dbt_sql\\dbt_project\\my_dbt\\logs'}
[0m16:11:09.014295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '598284bf-bd24-486a-8b21-b5506d6feaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBB93AB90>]}
[0m16:11:09.072621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '598284bf-bd24-486a-8b21-b5506d6feaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BB81480D0>]}
[0m16:11:09.074179 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:11:09.301080 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:11:09.437380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:09.438896 [debug] [MainThread]: Partial parsing: updated file: my_dbt://models\marts\03_peak_hour_detection_by_location.sql
[0m16:11:09.666744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '598284bf-bd24-486a-8b21-b5506d6feaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBD037B90>]}
[0m16:11:09.783282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:11:09.785283 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:11:09.808797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '598284bf-bd24-486a-8b21-b5506d6feaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBD0EF0D0>]}
[0m16:11:09.808797 [info ] [MainThread]: Found 14 models, 5 data tests, 3 sources, 464 macros
[0m16:11:09.809797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598284bf-bd24-486a-8b21-b5506d6feaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBCFF1310>]}
[0m16:11:09.812351 [info ] [MainThread]: 
[0m16:11:09.812907 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:09.813443 [info ] [MainThread]: 
[0m16:11:09.814511 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:09.816119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m16:11:09.878884 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m16:11:09.879881 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m16:11:09.879881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:09.896908 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m16:11:09.897909 [debug] [ThreadPool]: On list_de_db: Close
[0m16:11:09.902001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db_public'
[0m16:11:09.907673 [debug] [ThreadPool]: Using postgres connection "list_de_db_public"
[0m16:11:09.907673 [debug] [ThreadPool]: On list_de_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "list_de_db_public"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:11:09.907673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:09.940526 [debug] [ThreadPool]: SQL status: SELECT 60 in 0.033 seconds
[0m16:11:09.942526 [debug] [ThreadPool]: On list_de_db_public: ROLLBACK
[0m16:11:09.944349 [debug] [ThreadPool]: On list_de_db_public: Close
[0m16:11:09.955555 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:09.956416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:11:09.957196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:09.985846 [debug] [MainThread]: SQL status: SELECT 2 in 0.029 seconds
[0m16:11:09.987387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598284bf-bd24-486a-8b21-b5506d6feaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBD4B5610>]}
[0m16:11:09.988099 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:09.989022 [debug] [MainThread]: On master: COMMIT
[0m16:11:09.989623 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:09.989623 [debug] [MainThread]: On master: COMMIT
[0m16:11:09.991338 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:11:09.992371 [debug] [MainThread]: On master: Close
[0m16:11:09.996664 [debug] [Thread-1 (]: Began running node model.my_dbt.03_peak_hour_detection_by_location
[0m16:11:09.996664 [info ] [Thread-1 (]: 1 of 1 START sql view model public.03_peak_hour_detection_by_location .......... [RUN]
[0m16:11:09.998130 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt.03_peak_hour_detection_by_location'
[0m16:11:09.999156 [debug] [Thread-1 (]: Began compiling node model.my_dbt.03_peak_hour_detection_by_location
[0m16:11:10.005498 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:11:10.006499 [debug] [Thread-1 (]: Began executing node model.my_dbt.03_peak_hour_detection_by_location
[0m16:11:10.034647 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:11:10.035182 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:11:10.036182 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.03_peak_hour_detection_by_location"} */

  create view "de_db"."public"."03_peak_hour_detection_by_location__dbt_tmp"
    
    
  as (
    

with hourly as (
  select
    pu_location_id as zone_id,
    extract(hour from pickup_datetime)::int as pickup_hour,
    count(*) as trip_count
  from "de_db"."public"."stg_yellow_tripdata"
  group by 1, 2
),

ranked as (
  select
    *,
    row_number() over (
      partition by zone_id
      order by trip_count desc
    ) as rn
  from hourly
)

select
  zone_id,
  pickup_hour as peak_hour,
  trip_count as peak_hour_trip_count
from ranked
where rn = 1
  );
[0m16:11:10.036182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:10.062643 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m16:11:10.067863 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:11:10.068860 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.03_peak_hour_detection_by_location"} */
alter table "de_db"."public"."03_peak_hour_detection_by_location__dbt_tmp" rename to "03_peak_hour_detection_by_location"
[0m16:11:10.070420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:10.082107 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: COMMIT
[0m16:11:10.082619 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:11:10.083202 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: COMMIT
[0m16:11:10.089456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:11:10.094557 [debug] [Thread-1 (]: Applying DROP to: "de_db"."public"."03_peak_hour_detection_by_location__dbt_backup"
[0m16:11:10.099583 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt.03_peak_hour_detection_by_location"
[0m16:11:10.100029 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "my_dbt", "target_name": "dev", "node_id": "model.my_dbt.03_peak_hour_detection_by_location"} */
drop view if exists "de_db"."public"."03_peak_hour_detection_by_location__dbt_backup" cascade
[0m16:11:10.101415 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:11:10.103438 [debug] [Thread-1 (]: On model.my_dbt.03_peak_hour_detection_by_location: Close
[0m16:11:10.105678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '598284bf-bd24-486a-8b21-b5506d6feaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBD047350>]}
[0m16:11:10.106270 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.03_peak_hour_detection_by_location ..... [[32mCREATE VIEW[0m in 0.11s]
[0m16:11:10.107361 [debug] [Thread-1 (]: Finished running node model.my_dbt.03_peak_hour_detection_by_location
[0m16:11:10.108725 [debug] [MainThread]: On master: COMMIT
[0m16:11:10.109129 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:10.109517 [debug] [MainThread]: On master: COMMIT
[0m16:11:10.109866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:10.132623 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m16:11:10.133389 [debug] [MainThread]: On master: Close
[0m16:11:10.133389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:10.133389 [debug] [MainThread]: Connection 'list_de_db' was properly closed.
[0m16:11:10.134768 [debug] [MainThread]: Connection 'list_de_db_public' was properly closed.
[0m16:11:10.134768 [debug] [MainThread]: Connection 'model.my_dbt.03_peak_hour_detection_by_location' was properly closed.
[0m16:11:10.134768 [info ] [MainThread]: 
[0m16:11:10.135694 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m16:11:10.136729 [debug] [MainThread]: Command end result
[0m16:11:10.162011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\manifest.json
[0m16:11:10.164729 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\semantic_manifest.json
[0m16:11:10.169634 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jkimd\gt\Workspace\airflow_dbt_sql\dbt_project\my_dbt\target\run_results.json
[0m16:11:10.170609 [info ] [MainThread]: 
[0m16:11:10.170609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:10.171633 [info ] [MainThread]: 
[0m16:11:10.172474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:11:10.173474 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:10.172474 after 1.41 seconds
[0m16:11:10.173474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BB4AF8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BBB5EAFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BB4BB3650>]}
[0m16:11:10.174476 [debug] [MainThread]: Flushing usage events
[0m16:11:10.497299 [debug] [MainThread]: An error was encountered while trying to flush usage events
